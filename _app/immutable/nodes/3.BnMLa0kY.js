var vt=Object.defineProperty;var ut=(t,e,o)=>e in t?vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var Je=(t,e,o)=>ut(t,typeof e!="symbol"?e+"":e,o);import{t as d,a as l,c as xe}from"../chunks/BopGTE8o.js";import{e as Ke,u as _t,p as Ee,i as ft,ai as Z,l as n,aI as re,c as a,r,a as De,f as z,s as i,aL as fe,aK as Oe,t as F,ak as Ae,$ as dt}from"../chunks/Ct7ANt6e.js";import{h as gt}from"../chunks/B2ogVApr.js";import{i as D}from"../chunks/DNpI7BUG.js";import{o as He,a as je}from"../chunks/CvhId5fI.js";import{p as xt}from"../chunks/C_-TgXzk.js";import{w as st}from"../chunks/I4hA5oXT.js";import{R as ve,a as Ie,S as Te,b as ke,c as Ce,d as Le,e as he,D as Ue,f as mt}from"../chunks/C12fYlIf.js";/* empty css                */import{d as ct,s as m}from"../chunks/BnqBNAe_.js";import{e as de,i as ge}from"../chunks/NQz2JwdD.js";import{r as ye,s as le,a as me,b as Ne,c as We}from"../chunks/DZuwPtZB.js";import{s as Pe}from"../chunks/BnwBSpKm.js";import{b as Xe}from"../chunks/Bx59benV.js";import{b as Ze}from"../chunks/CMY0gm4c.js";import{s as Ge}from"../chunks/CZyT7R6R.js";import{b as Ye}from"../chunks/CM92VNCo.js";function $e(t,e,o){Ke(()=>{var u=_t(()=>e(t,o==null?void 0:o())||{});if(u!=null&&u.destroy)return()=>u.destroy()})}class Be{static fromJson(e){return ht(JSON.parse(e),qe("AgentSettings"))}static toJson(e){return JSON.stringify(yt(e,qe("AgentSettings")),null,2)}}function pe(t,e,o,u=""){const G=ze(t),Q=u?` on ${u}`:"",oe=o?` for key "${o}"`:"";throw Error(`Invalid value${oe}${Q}. Expected ${G} but got ${JSON.stringify(e)}`)}function ze(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${ze(t[1])}`:`one of [${t.map(e=>ze(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function bt(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(o=>e[o.json]={key:o.js,typ:o.typ}),t.jsonToJS=e}return t.jsonToJS}function pt(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(o=>e[o.js]={key:o.json,typ:o.typ}),t.jsToJSON=e}return t.jsToJSON}function Se(t,e,o,u="",G=""){function Q(f,O){return typeof f==typeof O?O:pe(f,O,u,G)}function oe(f,O){const M=f.length;for(let g=0;g<M;g++){const b=f[g];try{return Se(O,b,o)}catch{}}return pe(f,O,u,G)}function $(f,O){return f.indexOf(O)!==-1?O:pe(f.map(M=>Fe(M)),O,u,G)}function K(f,O){return Array.isArray(O)?O.map(M=>Se(M,f,o)):pe(Fe("array"),O,u,G)}function h(f){if(f===null)return null;const O=new Date(f);return isNaN(O.valueOf())?pe(Fe("Date"),f,u,G):O}function y(f,O,M){if(M===null||typeof M!="object"||Array.isArray(M))return pe(Fe(q||"object"),M,u,G);const g={};return Object.getOwnPropertyNames(f).forEach(b=>{const T=f[b],H=Object.prototype.hasOwnProperty.call(M,b)?M[b]:void 0;g[T.key]=Se(H,T.typ,o,b,q)}),Object.getOwnPropertyNames(M).forEach(b=>{Object.prototype.hasOwnProperty.call(f,b)||(g[b]=Se(M[b],O,o,b,q))}),g}if(e==="any")return t;if(e===null)return t===null?t:pe(e,t,u,G);if(e===!1)return pe(e,t,u,G);let q;for(;typeof e=="object"&&e.ref!==void 0;)q=e.ref,e=At[e.ref];return Array.isArray(e)?$(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?oe(e.unionMembers,t):e.hasOwnProperty("arrayItems")?K(e.arrayItems,t):e.hasOwnProperty("props")?y(o(e),e.additional,t):pe(e,t,u,G):e===Date&&typeof t!="number"?h(t):Q(e,t)}function ht(t,e){return Se(t,e,bt)}function yt(t,e){return Se(t,e,pt)}function Fe(t){return{literal:t}}function Ve(t,e){return{props:t,additional:e}}function qe(t){return{ref:t}}const At={AgentSettings:Ve([{json:"connection",js:"connection",typ:qe("Connection")},{json:"team",js:"team",typ:""},{json:"display",js:"display",typ:qe("Display")}],!1),Connection:Ve([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1),Display:Ve([{json:"largeScale",js:"largeScale",typ:!0}],!1)},et={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}};function wt(){const t=localStorage.getItem("agent-settings");if(t)try{return Be.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",Be.toJson(et)),et}const be=st(wt());be.subscribe(t=>{localStorage.setItem("agent-settings",Be.toJson(t))});function kt(){const{subscribe:t,update:e}=st({status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let o=null,u=null,G=null,Q=null;be.subscribe(h=>{u=h});function oe(){o&&(o.close(),o=null,e(h=>({...h,status:"disconnected"}))),Q&&(Q.clear(),Q=null)}function $(){if(!u)return;o&&e(y=>({...y,status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]})),e(y=>({...y,status:"connecting"}));const h=new URL(u.connection.url);u.connection.token&&h.searchParams.set("token",u.connection.token),o=new WebSocket(h),o.onopen=()=>{e(y=>({...y,status:"connected"}))},o.onclose=()=>{oe()},o.onerror=()=>{oe()},o.onmessage=y=>{try{const q=Date.now(),f=JSON.parse(y.data);switch(e(O=>{const M=O.entries.slice();M.push(f);const g={...O,entries:M,request:f.request};if(f.info){if(g.info=f.info,f.info.medium_result){const b=f.info.medium_result;g.mediumResults.findIndex(T=>T.day===b.day&&T.agent===b.agent)<0&&g.mediumResults.push(f.info.medium_result)}if(f.info.divine_result){const b=f.info.divine_result;g.divineResults.findIndex(T=>T.day===b.day&&T.agent===b.agent)<0&&g.divineResults.push(f.info.divine_result)}f.info.executed_agent&&g.executedAgents.push(f.info.executed_agent),f.info.attacked_agent&&g.attackedAgents.push(f.info.attacked_agent)}return f.setting&&(g.setting=f.setting,G=f.setting.timeout.action),f.talk_history&&g.talkHistory.push(...f.talk_history),f.whisper_history&&g.whisperHistory.push(...f.whisper_history),f.request===ve.INITIALIZE&&g.info&&(g.agent=g.info.agent,g.role=g.info.role_map[g.info.agent],g.profile=g.info.profile||null),g}),f.request){case ve.NAME:K((u==null?void 0:u.team)||"viewer"+Math.floor(Math.random()*1e3));break;case ve.TALK:case ve.WHISPER:case ve.VOTE:case ve.DIVINE:case ve.GUARD:case ve.ATTACK:Q&&Q.clear(),Q=new It(()=>{K("TIMEOUT")},new Date(q+(G??6e4))),e(O=>({...O,deadline:(Q==null?void 0:Q.deadline())??null}));break;case ve.FINISH:oe();break}}catch(q){console.error("Failed to parse message:",q)}}}function K(h){if(Q&&(Q.clear(),Q=null,e(y=>({...y,deadline:null}))),o&&o.readyState===WebSocket.OPEN)try{o.send(h),e(y=>{const q=y.entries.slice();return q.push(h),{...y,entries:q}})}catch(y){console.error("Failed to send message:",y)}}return{subscribe:t,connect:$,disconnect:oe,send:K}}const Re=kt();class It{constructor(e,o){Je(this,"timeout");Je(this,"_deadline");this.timeout=setTimeout(e,o.getTime()-new Date().getTime()),this._deadline=o}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var tt;(function(t){t[t.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",t[t.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",t[t.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",t[t.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",t[t.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",t[t.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",t[t.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",t[t.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",t[t.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",t[t.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",t[t.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",t[t.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",t[t.TAGS_START=917504]="TAGS_START",t[t.TAGS_END=917631]="TAGS_END",t[t.ZWJ=8205]="ZWJ"})(tt||(tt={}));const Tt=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var rt;function at(t){if(typeof t!="string")throw new TypeError("string cannot be undefined or null");const e=[];let o=0,u=0;for(;o<t.length;)u+=St(o+u,t),Mt(t[o+u])&&u++,Dt(t[o+u])&&u++,Nt(t[o+u])&&u++,Ct(t[o+u])?u++:(e.push(t.substring(o,o+u)),o+=u,u=0);return e}function St(t,e){const o=e[t];if(!Rt(o)||t===e.length-1)return 1;const u=o+e[t+1];let G=e.substring(t+2,t+5);return nt(u)&&nt(G)?4:Ot(u)&&jt(G)?e.slice(t).indexOf(String.fromCodePoint(917631))+2:Et(G)?4:2}function Rt(t){return t&&we(t[0].charCodeAt(0),55296,56319)}function nt(t){return we(Qe(t),127462,127487)}function Ot(t){return we(Qe(t),127988,127988)}function Et(t){return we(Qe(t),127995,127999)}function Dt(t){return typeof t=="string"&&we(t.charCodeAt(0),65024,65039)}function Nt(t){return typeof t=="string"&&we(t.charCodeAt(0),8400,8447)}function jt(t){const e=t.codePointAt(0);return typeof t=="string"&&typeof e=="number"&&we(e,917504,917631)}function Mt(t){return typeof t=="string"&&Tt.includes(t.charCodeAt(0))}function Ct(t){return typeof t=="string"&&t.charCodeAt(0)===8205}function Qe(t){return(t.charCodeAt(0)-55296<<10)+(t.charCodeAt(1)-56320)+65536}function we(t,e,o){return t>=e&&t<=o}(function(t){t[t.unit_1=1]="unit_1",t[t.unit_2=2]="unit_2",t[t.unit_4=4]="unit_4"})(rt||(rt={}));function it(t,e,o){t.key==="Enter"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.onSendMessage(n(o)))}var Lt=d('<span aria-live="polite"> </span>m',1),Pt=(t,e,o)=>e(o()),Ft=d('<button class="btn btn-xl"> </button>'),qt=(t,e)=>e("Skip"),Ht=d('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),Jt=(t,e)=>e("Over"),Gt=d('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),Vt=d("<option></option>"),Kt=d("<option></option>"),Ut=d("<!> <option></option>",1),Wt=d('<pre class="text-2xl"> </pre>'),Zt=d('<pre class="text-2xl bg-error text-error-content"> </pre>'),Bt=(t,e,o)=>e.onSendMessage(n(o)),zt=d('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),Qt=d('<span aria-live="polite"> </span>m',1),Xt=(t,e,o)=>e(o()),Yt=d('<button class="btn"> </button>'),$t=d('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),er=(t,e)=>e("Skip"),tr=d('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),rr=(t,e)=>e("Over"),ar=d('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),nr=d("<option></option>"),ir=d("<option></option>"),or=d("<!> <option></option>",1),lr=d('<pre class="text-md"> </pre>'),sr=d('<pre class="text-md bg-error text-error-content"> </pre>'),cr=(t,e,o)=>e.onSendMessage(n(o)),vr=d('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),ur=d('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function _r(t,e){Ee(e,!0);let o=re(""),u=re(0),G=re(void 0),Q=re(null);const oe=Oe(()=>{var g;return e.remain!==null?e.remain/(((g=e.setting)==null?void 0:g.timeout.action)??6e4)*100:0}),$=Oe(()=>[ve.VOTE,ve.DIVINE,ve.GUARD,ve.ATTACK].includes(e.request));function K(g){var H,k;if(!e.request||!e.setting)return 0;const b=e.request===ve.TALK?e.setting.talk.max_length:e.request===ve.WHISPER?e.setting.whisper.max_length:null;if(!b)return 0;let T=b.base_length??0;if(T+=((H=e.info)==null?void 0:H.remain_length)??0,b.mention_length){for(const C in((k=e.info)==null?void 0:k.status_map)??{})if(g.indexOf("@"+C)!==-1){T+=b.mention_length,T+=at("@"+C).length;break}}return b.per_talk&&(T=Math.min(T,b.per_talk)),T-=at(g).length,T}ft(()=>{Z(u,K(n(o)),!0)}),He(()=>{const g=be.subscribe(b=>{Z(G,b,!0)});return()=>{g()}});function h(g){var b;Z(o,g,!0),(b=n(Q))==null||b.focus()}function y(g){g.focus()}var q=ur(),f=a(q);{var O=g=>{var b=zt(),T=z(b),H=a(T),k=a(H);{var C=s=>{var w=Lt(),_=z(w),p=a(_,!0);r(_),fe(),F((j,B,R)=>{Pe(_,`--value:${j??""};`),me(_,"aria-label",B),m(p,R)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),l(s,w)};D(k,s=>{e.remain&&e.remain>6e4&&s(C)})}var X=i(k,2),ae=a(X,!0);r(X),fe(),r(H);var U=i(H,2),V=a(U,!0);r(U),r(T);var J=i(T,2),W=a(J);{var ee=s=>{var w=xe(),_=z(w);de(_,17,()=>{var p;return Object.entries(((p=e.info)==null?void 0:p.status_map)??{})},ge,(p,j)=>{let B=()=>n(j)[0],R=()=>n(j)[1];var te=xe(),ie=z(te);{var ce=_e=>{var ue=Ft();ue.__click=[Pt,h,B];var Me=a(ue,!0);r(ue),F(()=>m(Me,B())),l(_e,ue)};D(ie,_e=>{var ue;R()===Te.ALIVE&&B()!==((ue=e.info)==null?void 0:ue.agent)&&_e(ce)})}l(p,te)}),l(s,w)},se=s=>{var w=Gt(),_=z(w);{var p=R=>{var te=Ht();te.__click=[qt,h];var ie=a(te);le(ie,"icon","mdi:arrow-u-down-right-bold"),fe(),r(te),l(R,te)};D(_,R=>{var te;(((te=e.info)==null?void 0:te.remain_skip)??0)>0&&R(p)})}var j=i(_,2);j.__click=[Jt,h];var B=a(j);le(B,"icon","mdi:skip-forward"),fe(),r(j),l(s,w)};D(W,s=>{n($)?s(ee):s(se,!1)})}var ne=i(W,2);ye(ne),ne.__keydown=[it,e,o],Ke(()=>Xe(ne,()=>n(o),s=>Z(o,s))),$e(ne,s=>y==null?void 0:y(s)),Ze(ne,s=>Z(Q,s),()=>n(Q));var A=i(ne,2),E=a(A);{var S=s=>{var w=xe(),_=z(w);de(_,17,()=>{var p;return Object.entries(((p=e.info)==null?void 0:p.status_map)??{})},ge,(p,j)=>{let B=()=>n(j)[0],R=()=>n(j)[1];var te=xe(),ie=z(te);{var ce=_e=>{var ue=Vt(),Me={};F(()=>{Me!==(Me=B())&&(ue.value=(ue.__value=B())??"")}),l(_e,ue)};D(ie,_e=>{var ue;R()===Te.ALIVE&&B()!==((ue=e.info)==null?void 0:ue.agent)&&_e(ce)})}l(p,te)}),l(s,w)},L=s=>{var w=Ut(),_=z(w);{var p=B=>{var R=Kt();R.value=R.__value="Skip",l(B,R)};D(_,B=>{var R;(((R=e.info)==null?void 0:R.remain_skip)??0)>0&&B(p)})}var j=i(_,2);j.value=j.__value="Over",l(s,w)};D(E,s=>{n($)?s(S):s(L,!1)})}r(A);var P=i(A,2);{var I=s=>{var w=Wt(),_=a(w);r(w),F(()=>m(_,`残り${n(u)??""}文字`)),l(s,w)},Y=s=>{var w=Zt(),_=a(w);r(w),F(()=>m(_,`${n(u)*-1}文字超過`)),l(s,w)};D(P,s=>{n(u)>=0?s(I):s(Y,!1)})}var N=i(P,2);N.__click=[Bt,e,o];var c=a(N);le(c,"icon","mdi:send"),fe(),r(N),r(J);var v=i(J,2),x=a(v);r(v),F((s,w,_)=>{Pe(X,`--value:${s??""};`),me(X,"aria-label",w),m(ae,_),m(V,n($)?`${Ie[e.request]}対象を選択してください`:`${Ie[e.request??ve.INITIALIZE]}内容を入力してください`),Ne(x,n(oe))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),l(g,b)},M=g=>{var b=vr(),T=z(b),H=a(T),k=a(H);{var C=c=>{var v=Qt(),x=z(v),s=a(x,!0);r(x),fe(),F((w,_,p)=>{Pe(x,`--value:${w??""};`),me(x,"aria-label",_),m(s,p)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),l(c,v)};D(k,c=>{e.remain&&e.remain>6e4&&c(C)})}var X=i(k,2),ae=a(X,!0);r(X),fe(),r(H);var U=i(H,2);{var V=c=>{var v=$t(),x=z(v),s=a(x);r(x);var w=i(x,2);de(w,17,()=>{var _;return Object.entries(((_=e.info)==null?void 0:_.status_map)??{})},ge,(_,p)=>{let j=()=>n(p)[0],B=()=>n(p)[1];var R=xe(),te=z(R);{var ie=ce=>{var _e=Yt();_e.__click=[Xt,h,j];var ue=a(_e,!0);r(_e),F(()=>m(ue,j())),l(ce,_e)};D(te,ce=>{var _e;B()===Te.ALIVE&&j()!==((_e=e.info)==null?void 0:_e.agent)&&ce(ie)})}l(_,R)}),F(()=>m(s,`${Ie[e.request]??""}対象を選択してください`)),l(c,v)},J=c=>{var v=ar(),x=z(v),s=a(x);r(x);var w=i(x,2);{var _=B=>{var R=tr();R.__click=[er,h];var te=a(R);le(te,"icon","mdi:arrow-u-down-right-bold"),fe(),r(R),l(B,R)};D(w,B=>{var R;(((R=e.info)==null?void 0:R.remain_skip)??0)>0&&B(_)})}var p=i(w,2);p.__click=[rr,h];var j=a(p);le(j,"icon","mdi:skip-forward"),fe(),r(p),F(()=>m(s,`${Ie[e.request??ve.INITIALIZE]??""}内容を入力してください`)),l(c,v)};D(U,c=>{n($)?c(V):c(J,!1)})}var W=i(U,2);ye(W),W.__keydown=[it,e,o],Ke(()=>Xe(W,()=>n(o),c=>Z(o,c))),$e(W,c=>y==null?void 0:y(c)),Ze(W,c=>Z(Q,c),()=>n(Q));var ee=i(W,2),se=a(ee);{var ne=c=>{var v=xe(),x=z(v);de(x,17,()=>{var s;return Object.entries(((s=e.info)==null?void 0:s.status_map)??{})},ge,(s,w)=>{let _=()=>n(w)[0],p=()=>n(w)[1];var j=xe(),B=z(j);{var R=te=>{var ie=nr(),ce={};F(()=>{ce!==(ce=_())&&(ie.value=(ie.__value=_())??"")}),l(te,ie)};D(B,te=>{var ie;p()===Te.ALIVE&&_()!==((ie=e.info)==null?void 0:ie.agent)&&te(R)})}l(s,j)}),l(c,v)},A=c=>{var v=or(),x=z(v);{var s=_=>{var p=ir();p.value=p.__value="Skip",l(_,p)};D(x,_=>{var p;(((p=e.info)==null?void 0:p.remain_skip)??0)>0&&_(s)})}var w=i(x,2);w.value=w.__value="Over",l(c,v)};D(se,c=>{n($)?c(ne):c(A,!1)})}r(ee);var E=i(ee,2);{var S=c=>{var v=lr(),x=a(v);r(v),F(()=>m(x,`残り${n(u)??""}文字`)),l(c,v)},L=c=>{var v=sr(),x=a(v);r(v),F(()=>m(x,`${n(u)*-1}文字超過`)),l(c,v)};D(E,c=>{n(u)>=0?c(S):c(L,!1)})}var P=i(E,2);P.__click=[cr,e,o];var I=a(P);le(I,"icon","mdi:send"),fe(),r(P),r(T);var Y=i(T,2),N=a(Y);r(Y),F((c,v,x)=>{Pe(X,`--value:${c??""};`),me(X,"aria-label",v),m(ae,x),Ne(N,n(oe))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),l(g,b)};D(f,g=>{var b;(b=n(G))!=null&&b.display.largeScale?g(O):g(M,!1)})}r(q),l(t,q),De()}ct(["click","keydown"]);var fr=d('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),dr=d('<pre class="text-md text-pretty break-all my-2"> </pre>'),gr=d('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),xr=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),mr=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),br=d('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),pr=d('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),hr=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),yr=d('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ar=d('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),wr=d('<div class="grow overflow-y-auto pr-4"><pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!> <!></div>'),kr=d('<pre class="text-lg text-center"> </pre>'),Ir=d('<h2 class="text-lg font-bold text-center">プロフィール</h2> <pre class="text-md text-pretty break-all"> </pre>',1),Tr=d('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Sr=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Rr=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Or=d('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Er=d('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),Dr=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Nr=d('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),jr=d('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),Mr=d('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">名前</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <!> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),Cr=d('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function Lr(t,e){Ee(e,!0);let o=re(void 0);He(()=>{const K=be.subscribe(h=>{Z(o,h,!0)});je(K)});var u=Cr(),G=a(u),Q=a(G);{var oe=K=>{var h=wr(),y=a(h),q=a(y,!0);r(y);var f=i(y,2),O=a(f,!0);r(f);var M=i(f,2),g=a(M,!0);r(M);var b=i(M,2);{var T=J=>{var W=fr(),ee=a(W,!0);r(W),F(()=>m(ee,Ie[e.request])),l(J,W)};D(b,J=>{e.request&&J(T)})}var H=i(b,2);{var k=J=>{var W=dr(),ee=a(W,!0);r(W),F(()=>m(ee,e.profile)),l(J,W)};D(H,J=>{e.profile&&J(k)})}var C=i(H,2);de(C,17,()=>Object.entries(e.info.status_map??{}),ge,(J,W)=>{let ee=()=>n(W)[0],se=()=>n(W)[1];var ne=xe(),A=z(ne);{var E=L=>{var P=gr(),I=a(P),Y=a(I,!0);r(I);var N=i(I,2),c=a(N,!0);r(N);var v=i(N,2),x=a(v,!0);r(v),r(P),F(()=>{m(Y,ee()),m(c,ke[(e.info.role_map??{})[ee()]]??""),m(x,Ce[se()])}),l(L,P)},S=L=>{var P=xr(),I=a(P),Y=a(I,!0);r(I);var N=i(I,2),c=a(N,!0);r(N);var v=i(N,2),x=a(v);r(v),r(P),F(s=>{m(Y,ee()),m(c,ke[(e.info.role_map??{})[ee()]]??""),m(x,`${Ce[se()]??""}${s??""}`)},[()=>e.executedAgents.includes(ee())?" (追放)":e.attackedAgents.includes(ee())?" (襲撃)":""]),l(L,P)};D(A,L=>{se()===Te.ALIVE?L(E):L(S,!1)})}l(J,ne)});var X=i(C,2);{var ae=J=>{var W=pr(),ee=i(z(W),2);de(ee,17,()=>e.mediumResults,ge,(se,ne)=>{let A=()=>n(ne).day,E=()=>n(ne).target,S=()=>n(ne).result;var L=xe(),P=z(L);{var I=N=>{var c=mr(),v=a(c),x=a(v,!0);r(v);var s=i(v,2),w=a(s);r(s);var _=i(s,2),p=a(_,!0);r(_),r(c),F(()=>{m(x,E()),m(w,`(${A()??""}日目)`),m(p,he[S()])}),l(N,c)},Y=N=>{var c=br(),v=a(c),x=a(v,!0);r(v);var s=i(v,2),w=a(s);r(s);var _=i(s,2),p=a(_,!0);r(_),r(c),F(()=>{m(x,E()),m(w,`(${A()??""}日目)`),m(p,he[S()])}),l(N,c)};D(P,N=>{S()!==Le.HUMAN?N(I):N(Y,!1)})}l(se,L)}),l(J,W)};D(X,J=>{e.mediumResults.length>0&&J(ae)})}var U=i(X,2);{var V=J=>{var W=Ar(),ee=i(z(W),2);de(ee,17,()=>e.divineResults,ge,(se,ne)=>{let A=()=>n(ne).day,E=()=>n(ne).target,S=()=>n(ne).result;var L=xe(),P=z(L);{var I=N=>{var c=hr(),v=a(c),x=a(v,!0);r(v);var s=i(v,2),w=a(s);r(s);var _=i(s,2),p=a(_,!0);r(_),r(c),F(()=>{m(x,E()),m(w,`(${A()??""}日目)`),m(p,he[S()])}),l(N,c)},Y=N=>{var c=yr(),v=a(c),x=a(v,!0);r(v);var s=i(v,2),w=a(s);r(s);var _=i(s,2),p=a(_,!0);r(_),r(c),F(()=>{m(x,E()),m(w,`(${A()??""}日目)`),m(p,he[S()])}),l(N,c)};D(P,N=>{S()!==Le.HUMAN?N(I):N(Y,!1)})}l(se,L)}),l(J,W)};D(U,J=>{e.divineResults.length>0&&J(V)})}r(h),F(()=>{m(q,e.agent?e.agent:"ゲーム外"),m(O,e.role?ke[e.role]:"ゲーム外"),m(g,e.info?e.info.day+"日目":"ゲーム外")}),l(K,h)},$=K=>{var h=Mr(),y=i(z(h),2),q=a(y),f=a(q),O=i(a(f),2),M=a(O,!0);r(O),r(f);var g=i(f,2),b=i(a(g),2),T=a(b,!0);r(b),r(g);var H=i(g,2),k=i(a(H),2),C=a(k,!0);r(k),r(H);var X=i(H,2),ae=i(a(X),2);{var U=E=>{var S=kr(),L=a(S,!0);r(S),F(()=>m(L,Ie[e.request])),l(E,S)};D(ae,E=>{e.request&&E(U)})}r(X),r(q);var V=i(q,2);{var J=E=>{var S=Ir(),L=i(z(S),2),P=a(L,!0);r(L),F(()=>m(P,e.profile)),l(E,S)};D(V,E=>{e.profile&&E(J)})}var W=i(V,4);de(W,17,()=>Object.entries(e.info.status_map??{}),ge,(E,S)=>{let L=()=>n(S)[0],P=()=>n(S)[1];var I=xe(),Y=z(I);{var N=v=>{var x=Tr(),s=a(x),w=a(s,!0);r(s);var _=i(s,2),p=a(_,!0);r(_);var j=i(_,2),B=a(j,!0);r(j),r(x),F(()=>{m(w,L()),m(p,ke[(e.info.role_map??{})[L()]]??""),m(B,Ce[P()])}),l(v,x)},c=v=>{var x=Sr(),s=a(x),w=a(s,!0);r(s);var _=i(s,2),p=a(_,!0);r(_);var j=i(_,2),B=a(j);r(j),r(x),F(R=>{m(w,L()),m(p,ke[(e.info.role_map??{})[L()]]??""),m(B,`${Ce[P()]??""}${R??""}`)},[()=>e.executedAgents.includes(L())?" (追放)":e.attackedAgents.includes(L())?" (襲撃)":""]),l(v,x)};D(Y,v=>{P()===Te.ALIVE?v(N):v(c,!1)})}l(E,I)});var ee=i(W,2);{var se=E=>{var S=Er(),L=i(z(S),2);de(L,17,()=>e.mediumResults,ge,(P,I)=>{let Y=()=>n(I).day,N=()=>n(I).target,c=()=>n(I).result;var v=xe(),x=z(v);{var s=_=>{var p=Rr(),j=a(p),B=a(j,!0);r(j);var R=i(j,2),te=a(R);r(R);var ie=i(R,2),ce=a(ie,!0);r(ie),r(p),F(()=>{m(B,N()),m(te,`(${Y()??""}日目)`),m(ce,he[c()])}),l(_,p)},w=_=>{var p=Or(),j=a(p),B=a(j,!0);r(j);var R=i(j,2),te=a(R);r(R);var ie=i(R,2),ce=a(ie,!0);r(ie),r(p),F(()=>{m(B,N()),m(te,`(${Y()??""}日目)`),m(ce,he[c()])}),l(_,p)};D(x,_=>{c()!==Le.HUMAN?_(s):_(w,!1)})}l(P,v)}),l(E,S)};D(ee,E=>{e.mediumResults.length>0&&E(se)})}var ne=i(ee,2);{var A=E=>{var S=jr(),L=i(z(S),2);de(L,17,()=>e.divineResults,ge,(P,I)=>{let Y=()=>n(I).day,N=()=>n(I).target,c=()=>n(I).result;var v=xe(),x=z(v);{var s=_=>{var p=Dr(),j=a(p),B=a(j,!0);r(j);var R=i(j,2),te=a(R);r(R);var ie=i(R,2),ce=a(ie,!0);r(ie),r(p),F(()=>{m(B,N()),m(te,`(${Y()??""}日目)`),m(ce,he[c()])}),l(_,p)},w=_=>{var p=Nr(),j=a(p),B=a(j,!0);r(j);var R=i(j,2),te=a(R);r(R);var ie=i(R,2),ce=a(ie,!0);r(ie),r(p),F(()=>{m(B,N()),m(te,`(${Y()??""}日目)`),m(ce,he[c()])}),l(_,p)};D(x,_=>{c()!==Le.HUMAN?_(s):_(w,!1)})}l(P,v)}),l(E,S)};D(ne,E=>{e.divineResults.length>0&&E(A)})}r(y),F(()=>{m(M,e.agent?e.agent:"ゲーム外"),m(T,e.role?ke[e.role]:"ゲーム外"),m(C,e.info?e.info.day+"日目":"ゲーム外")}),l(K,h)};D(Q,K=>{var h;(h=n(o))!=null&&h.display.largeScale?K(oe):K($,!1)})}r(G),r(u),l(t,u),De()}function Pr(){Re.connect()}function Fr(){Re.disconnect()}var qr=d('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Hr=d('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),Jr=d('<div class="status status-error"></div>'),Gr=(t,e)=>e("connection.url",t.currentTarget.value),Vr=(t,e)=>e("connection.token",t.currentTarget.value),Kr=(t,e)=>e("team",t.currentTarget.value),Ur=(t,e)=>e("display.largeScale",t.currentTarget.checked),Wr=d('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./">aiwolf-nlp-viewer</a> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="WebSocket URL"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="Authorization Key"> <span class="badge badge-neutral badge-xs">Optional</span></label> <button class="btn btn-info">接続</button> <button class="btn btn-error">切断</button> <button class="btn">設定</button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold">エージェント設定</h3> <h4 class="text-base font-bold mt-2">チーム名</h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <h3 class="text-lg font-bold mt-4">表示設定</h3> <h4 class="text-base font-bold mt-2">大画面向け</h4> <label class="label cursor-pointer my-2"><span class="label-text">有効</span> <input type="checkbox" class="checkbox"></label></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function Zr(t,e){Ee(e,!0);let o=re(void 0),u=re(void 0);const G=be.subscribe(I=>{Z(o,I,!0)}),Q=Re.subscribe(I=>{Z(u,I.status,!0)});je(()=>{G(),Q()});function oe(I,Y){be.update(N=>{const c=I.split("."),v=c.pop();let x=N;for(const s of c)s&&(x=x[s]);return x[v]=Y,{...N}})}let $;var K=Wr(),h=i(a(K),2),y=a(h),q=a(y);{var f=I=>{var Y=qr();fe(2),l(I,Y)},O=(I,Y)=>{{var N=v=>{var x=Hr();fe(2),l(v,x)},c=v=>{var x=Jr();l(v,x)};D(I,v=>{n(u)==="connecting"?v(N):v(c,!1)},Y)}};D(q,I=>{n(u)==="connected"?I(f):I(O,!1)})}r(y),r(h);var M=i(h,2),g=a(M);Ge(g,1,"h-[1em] opacity-50"),le(g,"inline",!0),le(g,"icon","mdi:link");var b=i(g,2);ye(b),b.__input=[Gr,oe],r(M);var T=i(M,2),H=a(T);Ge(H,1,"h-[1em] opacity-50"),le(H,"inline",!0),le(H,"icon","mdi:key");var k=i(H,2);ye(k),k.__input=[Vr,oe],fe(2),r(T);var C=i(T,2);C.__click=[Pr];var X=i(C,2);X.__click=[Fr];var ae=i(X,2);ae.__click=()=>$.showModal();var U=i(ae,2),V=a(U),J=a(V),W=i(a(J),4),ee=a(W);Ge(ee,1,"h-[1em] opacity-50"),le(ee,"inline",!0),le(ee,"icon","mdi:rename");var se=i(ee,2);ye(se),se.__input=[Kr,oe],r(W);var ne=i(W,6),A=i(a(ne),2);ye(A),A.__change=[Ur,oe],r(ne),r(J),r(V),fe(2),r(U),Ze(U,I=>$=I,()=>$);var E=i(U,2),S=a(E);le(S,"inline",!0),le(S,"icon","mdi:white-balance-sunny");var L=i(S,2),P=i(L,2);le(P,"inline",!0),le(P,"icon","mdi:moon-and-stars"),r(E),r(K),F(()=>{var I,Y,N,c;Ne(b,(I=n(o))==null?void 0:I.connection.url),Ne(k,(Y=n(o))==null?void 0:Y.connection.token),C.disabled=n(u)!=="disconnected",X.disabled=n(u)==="disconnected",Ne(se,(N=n(o))==null?void 0:N.team),We(A,(c=n(o))==null?void 0:c.display.largeScale)}),l(t,K),De()}ct(["input","click","change"]);var Br=d("<iconify-icon></iconify-icon>",2),zr=d("<iconify-icon></iconify-icon>",2),Qr=d('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),Xr=d('<div class="chat-image avatar"><div class="w-20 rounded-full"><img></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),Yr=d("<iconify-icon></iconify-icon>",2),$r=d("<iconify-icon></iconify-icon>",2),ea=d('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),ta=d('<div class="chat-image avatar"><div class="w-10 rounded-full"><img></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),ra=d('<div class="chat chat-start"><!></div>');function ot(t,e){Ee(e,!0);let o=re(void 0);He(()=>{const $=be.subscribe(K=>{Z(o,K,!0)});je($)});var u=ra(),G=a(u);{var Q=$=>{var K=Xr(),h=z(K),y=a(h),q=a(y);r(y),r(h);var f=i(h,2),O=a(f,!0);r(f);var M=i(f,2);{var g=k=>{var C=Br();le(C,"inline",!0),le(C,"icon","mdi:skip-forward"),l(k,C)},b=(k,C)=>{{var X=U=>{var V=zr();le(V,"inline",!0),le(V,"icon","mdi:arrow-u-down-right-bold"),l(U,V)},ae=U=>{var V=Qr(),J=a(V,!0);r(V),F(()=>m(J,e.talk.text)),l(U,V)};D(k,U=>{e.talk.skip?U(X):U(ae,!1)},C)}};D(M,k=>{e.talk.over?k(g):k(b,!1)})}var T=i(M,2),H=a(T);r(T),F(()=>{me(q,"src",e.isDefaultProfile?`${Ye}${Ue[e.talk.agent]}`:""),me(q,"alt",e.talk.agent),m(O,e.talk.agent),m(H,`Idx: ${e.talk.idx??""}`)}),l($,K)},oe=$=>{var K=ta(),h=z(K),y=a(h),q=a(y);r(y),r(h);var f=i(h,2),O=a(f,!0);r(f);var M=i(f,2);{var g=k=>{var C=Yr();le(C,"inline",!0),le(C,"icon","mdi:skip-forward"),l(k,C)},b=(k,C)=>{{var X=U=>{var V=$r();le(V,"inline",!0),le(V,"icon","mdi:arrow-u-down-right-bold"),l(U,V)},ae=U=>{var V=ea(),J=a(V,!0);r(V),F(()=>m(J,e.talk.text)),l(U,V)};D(k,U=>{e.talk.skip?U(X):U(ae,!1)},C)}};D(M,k=>{e.talk.over?k(g):k(b,!1)})}var T=i(M,2),H=a(T);r(T),F(()=>{me(q,"src",e.isDefaultProfile?`${Ye}${Ue[e.talk.agent]}`:""),me(q,"alt",e.talk.agent),m(O,e.talk.agent),m(H,`Idx: ${e.talk.idx??""}`)}),l($,K)};D(G,$=>{var K;(K=n(o))!=null&&K.display.largeScale?$(Q):$(oe,!1)})}r(u),l(t,u),De()}var aa=d('<input type="radio" name="talk_days" class="tab text-lg font-bold"> <div class="tab-content my-4"></div>',1),na=d('<div class="tabs tabs-border"></div>'),ia=d('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),oa=d('<input type="radio" name="talk_days" class="tab"> <div class="tab-content my-4"></div>',1),la=d('<div class="tabs tabs-border"></div>'),sa=d('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),ca=d('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function lt(t,e){Ee(e,!0);let o=re(void 0),u=e.agents.every(h=>Object.keys(Ue).includes(h));He(()=>{const h=be.subscribe(y=>{Z(o,y,!0)});je(h)});var G=ca(),Q=a(G),oe=a(Q);{var $=h=>{var y=ia(),q=z(y),f=a(q,!0);r(q);var O=i(q,2),M=a(O);{var g=b=>{var T=na();const H=Oe(()=>[...new Set(e.talks.map(k=>k.day))].sort((k,C)=>C-k));de(T,21,()=>n(H),ge,(k,C)=>{var X=aa(),ae=z(X);ye(ae);var U=i(ae,2);de(U,21,()=>e.talks.filter(V=>V.day===n(C)),ge,(V,J)=>{ot(V,{get talk(){return n(J)},get agents(){return e.agents},isDefaultProfile:u})}),r(U),F(()=>{We(ae,n(C)===n(H)[0]),me(ae,"aria-label",`${n(C)}日目`)}),l(k,X)}),r(T),l(b,T)};D(M,b=>{e.talks.length>0&&b(g)})}r(O),F(()=>m(f,e.header)),l(h,y)},K=h=>{var y=sa(),q=z(y),f=a(q,!0);r(q);var O=i(q,2),M=a(O);{var g=b=>{var T=la();const H=Oe(()=>[...new Set(e.talks.map(k=>k.day))].sort((k,C)=>C-k));de(T,21,()=>n(H),ge,(k,C)=>{var X=oa(),ae=z(X);ye(ae);var U=i(ae,2);de(U,21,()=>e.talks.filter(V=>V.day===n(C)),ge,(V,J)=>{ot(V,{get talk(){return n(J)},get agents(){return e.agents},isDefaultProfile:u})}),r(U),F(()=>{We(ae,n(C)===n(H)[0]),me(ae,"aria-label",`${n(C)}日目`)}),l(k,X)}),r(T),l(b,T)};D(M,b=>{e.talks.length>0&&b(g)})}r(O),F(()=>m(f,e.header)),l(h,y)};D(oe,h=>{var y;(y=n(o))!=null&&y.display.largeScale?h($):h(K,!1)})}r(Q),r(G),l(t,G),De()}var va=d('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),ua=d('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none">未接続</pre></div>'),_a=d('<div role="alert" class="alert m-4"><span class="text-lg font-bold">未接続</span></div>'),fa=d('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Na(t,e){Ee(e,!0);let o=re(void 0),u=re(""),G=re(null),Q=re(Ae([])),oe=re(null),$=re(null),K=re(null),h=re(null),y=re(null),q=re(Ae([])),f=re(Ae([])),O=re(null),M=re(Ae([])),g=re(Ae([])),b=re(Ae([])),T=re(Ae([])),H=re(null),k=re(null),C=be.subscribe(A=>{Z(o,A,!0)}),X=Re.subscribe(A=>{Z(u,A.status,!0),A.deadline?(Z(G,A.deadline.getTime(),!0),U()):(Z(G,null),Z(H,null),n(k)&&(cancelAnimationFrame(n(k)),Z(k,null))),Z(Q,A.entries,!0),Z(oe,A.agent,!0),Z($,A.role,!0),Z(K,A.profile,!0),Z(h,A.request,!0),Z(y,A.info,!0),Z(q,A.mediumResults,!0),Z(f,A.divineResults,!0),Z(O,A.setting,!0),Z(M,A.talkHistory,!0),Z(g,A.whisperHistory,!0),Z(b,A.executedAgents,!0),Z(T,A.attackedAgents,!0)});function ae(){const A=xt.url.searchParams,E=A.get("url"),S=A.get("token");E&&(be.update(L=>({...L,connection:{url:E??"",token:S??""}})),Re.connect())}function U(){if(n(G)===null)return;const A=()=>{if(n(G)===null)return;const E=Date.now(),S=Math.max(0,n(G)-E);Z(H,S,!0),S>0?Z(k,requestAnimationFrame(A),!0):(Z(H,0),Z(k,null))};n(k)&&cancelAnimationFrame(n(k)),Z(k,requestAnimationFrame(A),!0)}function V(A){Re.send(A)}{ae();const A=S=>{n(u)==="connected"&&S.preventDefault()},E=S=>{n(u)==="connected"&&S.preventDefault()};window.addEventListener("beforeunload",A),window.addEventListener("popstate",E),je(()=>{window.removeEventListener("beforeunload",A),window.removeEventListener("popstate",E),n(k)&&cancelAnimationFrame(n(k)),C(),X()})}var J=fa();gt(A=>{dt.title="aiwolf-nlp-viewer"});var W=a(J);Zr(W,{});var ee=i(W,2);{var se=A=>{var E=va(),S=z(E),L=a(S);Lr(L,{get agent(){return n(oe)},get role(){return n($)},get profile(){return n(K)},get request(){return n(h)},get info(){return n(y)},get mediumResults(){return n(q)},get divineResults(){return n(f)},get executedAgents(){return n(b)},get attackedAgents(){return n(T)}});var P=i(L,2);const I=Oe(()=>{var x;return Object.keys(((x=n(y))==null?void 0:x.status_map)??{})});lt(P,{header:"トーク履歴",get talks(){return n(M)},get agents(){return n(I)}});var Y=i(P,2);{var N=x=>{const s=Oe(()=>{var w;return Object.keys(((w=n(y))==null?void 0:w.status_map)??{})});lt(x,{header:"囁き履歴",get talks(){return n(g)},get agents(){return n(s)}})};D(Y,x=>{n($)===mt.WEREWOLF&&x(N)})}r(S);var c=i(S,2);{var v=x=>{_r(x,{get remain(){return n(H)},get setting(){return n(O)},get request(){return n(h)},get info(){return n(y)},onSendMessage:V})};D(c,x=>{n(H)!==null&&x(v)})}l(A,E)},ne=(A,E)=>{{var S=P=>{var I=ua();l(P,I)},L=P=>{var I=_a();l(P,I)};D(A,P=>{var I;(I=n(o))!=null&&I.display.largeScale?P(S):P(L,!1)},E)}};D(ee,A=>{n(y)!==null?A(se):A(ne,!1)})}r(J),l(t,J),De()}export{Na as component};
