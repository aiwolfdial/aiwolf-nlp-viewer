var vt=Object.defineProperty;var ut=(t,e,o)=>e in t?vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var Ke=(t,e,o)=>ut(t,typeof e!="symbol"?e+"":e,o);import{t as d,a as l,c as me}from"../chunks/B-D5q77i.js";import{e as Ue,u as ft,p as Oe,h as _t,ah as q,k as n,aI as ae,c as r,r as a,a as Ne,f as Y,s as i,aL as _e,aK as Ee,t as H,aj as Ie,$ as dt}from"../chunks/D5be4FwA.js";import{h as gt}from"../chunks/CLNIrg_T.js";import{i as N}from"../chunks/CGMfeLRM.js";import{w as st,o as Ve,a as Me}from"../chunks/D_nCM0Fl.js";import{p as mt}from"../chunks/C16OfeMt.js";import{s as Le,a as we,b as Te,c as Ce,S as Fe,d as he,R as xt}from"../chunks/CmKwuTMh.js";/* empty css                */import{d as ct,s as x}from"../chunks/D8xRIYp5.js";import{e as de,i as ge}from"../chunks/B0D59ehn.js";import{r as ye,s as le,a as xe,b as De,c as We}from"../chunks/By1HukFy.js";import{b as Qe}from"../chunks/D3GeXUhi.js";import{b as Ze}from"../chunks/Cu74johM.js";import{s as Ge}from"../chunks/U-bwNbA3.js";import{b as Xe}from"../chunks/Ce36bXlc.js";function $e(t,e,o){Ue(()=>{var u=ft(()=>e(t,o==null?void 0:o())||{});if(u!=null&&u.destroy)return()=>u.destroy()})}class qe{static fromJson(e){return ht(JSON.parse(e),Pe("AgentSettings"))}static toJson(e){return JSON.stringify(yt(e,Pe("AgentSettings")),null,2)}}function pe(t,e,o,u=""){const G=Be(t),z=u?` on ${u}`:"",oe=o?` for key "${o}"`:"";throw Error(`Invalid value${oe}${z}. Expected ${G} but got ${JSON.stringify(e)}`)}function Be(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${Be(t[1])}`:`one of [${t.map(e=>Be(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function bt(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(o=>e[o.json]={key:o.js,typ:o.typ}),t.jsonToJS=e}return t.jsonToJS}function pt(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(o=>e[o.js]={key:o.json,typ:o.typ}),t.jsToJSON=e}return t.jsToJSON}function ke(t,e,o,u="",G=""){function z(_,E){return typeof _==typeof E?E:pe(_,E,u,G)}function oe(_,E){const j=_.length;for(let g=0;g<j;g++){const b=_[g];try{return ke(E,b,o)}catch{}}return pe(_,E,u,G)}function $(_,E){return _.indexOf(E)!==-1?E:pe(_.map(j=>He(j)),E,u,G)}function U(_,E){return Array.isArray(E)?E.map(j=>ke(j,_,o)):pe(He("array"),E,u,G)}function h(_){if(_===null)return null;const E=new Date(_);return isNaN(E.valueOf())?pe(He("Date"),_,u,G):E}function y(_,E,j){if(j===null||typeof j!="object"||Array.isArray(j))return pe(He(P||"object"),j,u,G);const g={};return Object.getOwnPropertyNames(_).forEach(b=>{const k=_[b],V=Object.prototype.hasOwnProperty.call(j,b)?j[b]:void 0;g[k.key]=ke(V,k.typ,o,b,P)}),Object.getOwnPropertyNames(j).forEach(b=>{Object.prototype.hasOwnProperty.call(_,b)||(g[b]=ke(j[b],E,o,b,P))}),g}if(e==="any")return t;if(e===null)return t===null?t:pe(e,t,u,G);if(e===!1)return pe(e,t,u,G);let P;for(;typeof e=="object"&&e.ref!==void 0;)P=e.ref,e=It[e.ref];return Array.isArray(e)?$(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?oe(e.unionMembers,t):e.hasOwnProperty("arrayItems")?U(e.arrayItems,t):e.hasOwnProperty("props")?y(o(e),e.additional,t):pe(e,t,u,G):e===Date&&typeof t!="number"?h(t):z(e,t)}function ht(t,e){return ke(t,e,bt)}function yt(t,e){return ke(t,e,pt)}function He(t){return{literal:t}}function Je(t,e){return{props:t,additional:e}}function Pe(t){return{ref:t}}const It={AgentSettings:Je([{json:"connection",js:"connection",typ:Pe("Connection")},{json:"team",js:"team",typ:""},{json:"display",js:"display",typ:Pe("Display")}],!1),Connection:Je([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1),Display:Je([{json:"largeScale",js:"largeScale",typ:!0}],!1)},et={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}};function At(){const t=localStorage.getItem("agent-settings");if(t)try{return qe.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",qe.toJson(et)),et}const be=st(At());be.subscribe(t=>{localStorage.setItem("agent-settings",qe.toJson(t))});var ve=(t=>(t.NAME="NAME",t.TALK="TALK",t.WHISPER="WHISPER",t.VOTE="VOTE",t.DIVINE="DIVINE",t.GUARD="GUARD",t.ATTACK="ATTACK",t.INITIALIZE="INITIALIZE",t.DAILY_INITIALIZE="DAILY_INITIALIZE",t.DAILY_FINISH="DAILY_FINISH",t.FINISH="FINISH",t))(ve||{});const Se={NAME:"名前",TALK:"トーク",WHISPER:"囁き",VOTE:"投票",DIVINE:"占い",GUARD:"護衛",ATTACK:"襲撃",INITIALIZE:"ゲーム開始",DAILY_INITIALIZE:"昼開始",DAILY_FINISH:"昼終了",FINISH:"ゲーム終了"},Ye={ミナト:"/images/male/01.png",タクミ:"/images/male/02.png",ケンジ:"/images/male/03.png",リュウジ:"/images/male/04.png",ダイスケ:"/images/male/05.png",シオン:"/images/male/06.png",ベンジャミン:"/images/male/07.png",トシオ:"/images/male/08.png",ジョナサン:"/images/male/09.png",シュンイチ:"/images/male/10.png",ジョージ:"/images/male/11.png",セルヴァス:"/images/male/12.png",サクラ:"/images/female/01.png",リン:"/images/female/02.png",ユミ:"/images/female/03.png",メイ:"/images/female/04.png",ミサキ:"/images/female/05.png",ミオ:"/images/female/06.png",ミヅキ:"/images/female/07.png",ミナコ:"/images/female/08.png",アスカ:"/images/female/09.png",ミドリ:"/images/female/10.png",ヴィクトリア:"/images/female/11.png",シズエ:"/images/female/12.png"};function Tt(){const{subscribe:t,update:e}=st({status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let o=null,u=null,G=null,z=null;be.subscribe(h=>{u=h});function oe(){o&&(o.close(),o=null,e(h=>({...h,status:"disconnected"}))),z&&(z.clear(),z=null)}function $(){if(!u)return;o&&e(y=>({...y,status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]})),e(y=>({...y,status:"connecting"}));const h=new URL(u.connection.url);u.connection.token&&h.searchParams.set("token",u.connection.token),o=new WebSocket(h),o.onopen=()=>{e(y=>({...y,status:"connected"}))},o.onclose=()=>{oe()},o.onerror=()=>{oe()},o.onmessage=y=>{try{const P=Date.now(),_=JSON.parse(y.data);switch(e(E=>{const j=E.entries.slice();j.push(_);const g={...E,entries:j,request:_.request};if(_.info){if(g.info=_.info,_.info.medium_result){const b=_.info.medium_result;g.mediumResults.findIndex(k=>k.day===b.day&&k.agent===b.agent)<0&&g.mediumResults.push(_.info.medium_result)}if(_.info.divine_result){const b=_.info.divine_result;g.divineResults.findIndex(k=>k.day===b.day&&k.agent===b.agent)<0&&g.divineResults.push(_.info.divine_result)}_.info.executed_agent&&g.executedAgents.push(_.info.executed_agent),_.info.attacked_agent&&g.attackedAgents.push(_.info.attacked_agent)}return _.setting&&(g.setting=_.setting,G=_.setting.timeout.action),_.talk_history&&g.talkHistory.push(..._.talk_history),_.whisper_history&&g.whisperHistory.push(..._.whisper_history),_.request===ve.INITIALIZE&&g.info&&(g.agent=g.info.agent,g.role=g.info.role_map[g.info.agent],g.profile=g.info.profile||null),g}),_.request){case ve.NAME:U((u==null?void 0:u.team)||"viewer"+Math.floor(Math.random()*1e3));break;case ve.TALK:case ve.WHISPER:case ve.VOTE:case ve.DIVINE:case ve.GUARD:case ve.ATTACK:z&&z.clear(),z=new wt(()=>{U("TIMEOUT")},new Date(P+(G??6e4))),e(E=>({...E,deadline:(z==null?void 0:z.deadline())??null}));break;case ve.FINISH:oe();break}}catch(P){console.error("Failed to parse message:",P)}}}function U(h){if(z&&(z.clear(),z=null,e(y=>({...y,deadline:null}))),o&&o.readyState===WebSocket.OPEN)try{o.send(h),e(y=>{const P=y.entries.slice();return P.push(h),{...y,entries:P}})}catch(y){console.error("Failed to send message:",y)}}return{subscribe:t,connect:$,disconnect:oe,send:U}}const Re=Tt();class wt{constructor(e,o){Ke(this,"timeout");Ke(this,"_deadline");this.timeout=setTimeout(e,o.getTime()-new Date().getTime()),this._deadline=o}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var tt;(function(t){t[t.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",t[t.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",t[t.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",t[t.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",t[t.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",t[t.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",t[t.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",t[t.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",t[t.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",t[t.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",t[t.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",t[t.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",t[t.TAGS_START=917504]="TAGS_START",t[t.TAGS_END=917631]="TAGS_END",t[t.ZWJ=8205]="ZWJ"})(tt||(tt={}));const kt=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var at;function rt(t){if(typeof t!="string")throw new TypeError("string cannot be undefined or null");const e=[];let o=0,u=0;for(;o<t.length;)u+=St(o+u,t),jt(t[o+u])&&u++,Nt(t[o+u])&&u++,Dt(t[o+u])&&u++,Lt(t[o+u])?u++:(e.push(t.substring(o,o+u)),o+=u,u=0);return e}function St(t,e){const o=e[t];if(!Rt(o)||t===e.length-1)return 1;const u=o+e[t+1];let G=e.substring(t+2,t+5);return nt(u)&&nt(G)?4:Et(u)&&Mt(G)?e.slice(t).indexOf(String.fromCodePoint(917631))+2:Ot(G)?4:2}function Rt(t){return t&&Ae(t[0].charCodeAt(0),55296,56319)}function nt(t){return Ae(ze(t),127462,127487)}function Et(t){return Ae(ze(t),127988,127988)}function Ot(t){return Ae(ze(t),127995,127999)}function Nt(t){return typeof t=="string"&&Ae(t.charCodeAt(0),65024,65039)}function Dt(t){return typeof t=="string"&&Ae(t.charCodeAt(0),8400,8447)}function Mt(t){const e=t.codePointAt(0);return typeof t=="string"&&typeof e=="number"&&Ae(e,917504,917631)}function jt(t){return typeof t=="string"&&kt.includes(t.charCodeAt(0))}function Lt(t){return typeof t=="string"&&t.charCodeAt(0)===8205}function ze(t){return(t.charCodeAt(0)-55296<<10)+(t.charCodeAt(1)-56320)+65536}function Ae(t,e,o){return t>=e&&t<=o}(function(t){t[t.unit_1=1]="unit_1",t[t.unit_2=2]="unit_2",t[t.unit_4=4]="unit_4"})(at||(at={}));function it(t,e,o){t.key==="Enter"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.onSendMessage(n(o)))}var Ct=d('<span aria-live="polite"> </span>m',1),Ft=(t,e,o)=>e(o()),Ht=d('<button class="btn btn-xl"> </button>'),Pt=(t,e)=>e("Skip"),Vt=d('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),Kt=(t,e)=>e("Over"),Gt=d('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),Jt=d("<option></option>"),Ut=d("<option></option>"),Wt=d("<!> <option></option>",1),Zt=d('<pre class="text-2xl"> </pre>'),qt=d('<pre class="text-2xl bg-error text-error-content"> </pre>'),Bt=(t,e,o)=>e.onSendMessage(n(o)),Yt=d('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),zt=d('<span aria-live="polite"> </span>m',1),Qt=(t,e,o)=>e(o()),Xt=d('<button class="btn"> </button>'),$t=d('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),ea=(t,e)=>e("Skip"),ta=d('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),aa=(t,e)=>e("Over"),ra=d('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),na=d("<option></option>"),ia=d("<option></option>"),oa=d("<!> <option></option>",1),la=d('<pre class="text-md"> </pre>'),sa=d('<pre class="text-md bg-error text-error-content"> </pre>'),ca=(t,e,o)=>e.onSendMessage(n(o)),va=d('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),ua=d('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function fa(t,e){Oe(e,!0);let o=ae(""),u=ae(0),G=ae(void 0),z=ae(null);const oe=Ee(()=>{var g;return e.remain!==null?e.remain/(((g=e.setting)==null?void 0:g.timeout.action)??6e4)*100:0}),$=Ee(()=>[ve.VOTE,ve.DIVINE,ve.GUARD,ve.ATTACK].includes(e.request));function U(g){var V,T;if(!e.request||!e.setting)return 0;const b=e.request===ve.TALK?e.setting.talk.max_length:e.request===ve.WHISPER?e.setting.whisper.max_length:null;if(!b)return 0;let k=b.base_length??0;if(k+=((V=e.info)==null?void 0:V.remain_length)??0,b.mention_length){for(const L in((T=e.info)==null?void 0:T.status_map)??{})if(g.indexOf("@"+L)!==-1){k+=b.mention_length,k+=rt("@"+L).length;break}}return b.per_talk&&(k=Math.min(k,b.per_talk)),k-=rt(g).length,k}_t(()=>{q(u,U(n(o)),!0)}),Ve(()=>{const g=be.subscribe(b=>{q(G,b,!0)});return()=>{g()}});function h(g){var b;q(o,g,!0),(b=n(z))==null||b.focus()}function y(g){g.focus()}var P=ua(),_=r(P);{var E=g=>{var b=Yt(),k=Y(b),V=r(k),T=r(V);{var L=s=>{var A=Ct(),f=Y(A),p=r(f,!0);a(f),_e(),H((M,B,R)=>{Le(f,`--value:${M??""};`),xe(f,"aria-label",B),x(p,R)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),l(s,A)};N(T,s=>{e.remain&&e.remain>6e4&&s(L)})}var Q=i(T,2),re=r(Q,!0);a(Q),_e(),a(V);var W=i(V,2),J=r(W,!0);a(W),a(k);var K=i(k,2),Z=r(K);{var ee=s=>{var A=me(),f=Y(A);de(f,17,()=>{var p;return Object.entries(((p=e.info)==null?void 0:p.status_map)??{})},ge,(p,M)=>{let B=()=>n(M)[0],R=()=>n(M)[1];var te=me(),ie=Y(te);{var ce=fe=>{var ue=Ht();ue.__click=[Ft,h,B];var je=r(ue,!0);a(ue),H(()=>x(je,B())),l(fe,ue)};N(ie,fe=>{var ue;R()===we.ALIVE&&B()!==((ue=e.info)==null?void 0:ue.agent)&&fe(ce)})}l(p,te)}),l(s,A)},se=s=>{var A=Gt(),f=Y(A);{var p=R=>{var te=Vt();te.__click=[Pt,h];var ie=r(te);le(ie,"icon","mdi:arrow-u-down-right-bold"),_e(),a(te),l(R,te)};N(f,R=>{var te;(((te=e.info)==null?void 0:te.remain_skip)??0)>0&&R(p)})}var M=i(f,2);M.__click=[Kt,h];var B=r(M);le(B,"icon","mdi:skip-forward"),_e(),a(M),l(s,A)};N(Z,s=>{n($)?s(ee):s(se,!1)})}var ne=i(Z,2);ye(ne),ne.__keydown=[it,e,o],Ue(()=>Qe(ne,()=>n(o),s=>q(o,s))),$e(ne,s=>y==null?void 0:y(s)),Ze(ne,s=>q(z,s),()=>n(z));var I=i(ne,2),O=r(I);{var S=s=>{var A=me(),f=Y(A);de(f,17,()=>{var p;return Object.entries(((p=e.info)==null?void 0:p.status_map)??{})},ge,(p,M)=>{let B=()=>n(M)[0],R=()=>n(M)[1];var te=me(),ie=Y(te);{var ce=fe=>{var ue=Jt(),je={};H(()=>{je!==(je=B())&&(ue.value=(ue.__value=B())??"")}),l(fe,ue)};N(ie,fe=>{var ue;R()===we.ALIVE&&B()!==((ue=e.info)==null?void 0:ue.agent)&&fe(ce)})}l(p,te)}),l(s,A)},C=s=>{var A=Wt(),f=Y(A);{var p=B=>{var R=Ut();R.value=R.__value="Skip",l(B,R)};N(f,B=>{var R;(((R=e.info)==null?void 0:R.remain_skip)??0)>0&&B(p)})}var M=i(f,2);M.value=M.__value="Over",l(s,A)};N(O,s=>{n($)?s(S):s(C,!1)})}a(I);var F=i(I,2);{var w=s=>{var A=Zt(),f=r(A);a(A),H(()=>x(f,`残り${n(u)??""}文字`)),l(s,A)},X=s=>{var A=qt(),f=r(A);a(A),H(()=>x(f,`${n(u)*-1}文字超過`)),l(s,A)};N(F,s=>{n(u)>=0?s(w):s(X,!1)})}var D=i(F,2);D.__click=[Bt,e,o];var c=r(D);le(c,"icon","mdi:send"),_e(),a(D),a(K);var v=i(K,2),m=r(v);a(v),H((s,A,f)=>{Le(Q,`--value:${s??""};`),xe(Q,"aria-label",A),x(re,f),x(J,n($)?`${Se[e.request]}対象を選択してください`:`${Se[e.request??ve.INITIALIZE]}内容を入力してください`),De(m,n(oe))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),l(g,b)},j=g=>{var b=va(),k=Y(b),V=r(k),T=r(V);{var L=c=>{var v=zt(),m=Y(v),s=r(m,!0);a(m),_e(),H((A,f,p)=>{Le(m,`--value:${A??""};`),xe(m,"aria-label",f),x(s,p)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),l(c,v)};N(T,c=>{e.remain&&e.remain>6e4&&c(L)})}var Q=i(T,2),re=r(Q,!0);a(Q),_e(),a(V);var W=i(V,2);{var J=c=>{var v=$t(),m=Y(v),s=r(m);a(m);var A=i(m,2);de(A,17,()=>{var f;return Object.entries(((f=e.info)==null?void 0:f.status_map)??{})},ge,(f,p)=>{let M=()=>n(p)[0],B=()=>n(p)[1];var R=me(),te=Y(R);{var ie=ce=>{var fe=Xt();fe.__click=[Qt,h,M];var ue=r(fe,!0);a(fe),H(()=>x(ue,M())),l(ce,fe)};N(te,ce=>{var fe;B()===we.ALIVE&&M()!==((fe=e.info)==null?void 0:fe.agent)&&ce(ie)})}l(f,R)}),H(()=>x(s,`${Se[e.request]??""}対象を選択してください`)),l(c,v)},K=c=>{var v=ra(),m=Y(v),s=r(m);a(m);var A=i(m,2);{var f=B=>{var R=ta();R.__click=[ea,h];var te=r(R);le(te,"icon","mdi:arrow-u-down-right-bold"),_e(),a(R),l(B,R)};N(A,B=>{var R;(((R=e.info)==null?void 0:R.remain_skip)??0)>0&&B(f)})}var p=i(A,2);p.__click=[aa,h];var M=r(p);le(M,"icon","mdi:skip-forward"),_e(),a(p),H(()=>x(s,`${Se[e.request??ve.INITIALIZE]??""}内容を入力してください`)),l(c,v)};N(W,c=>{n($)?c(J):c(K,!1)})}var Z=i(W,2);ye(Z),Z.__keydown=[it,e,o],Ue(()=>Qe(Z,()=>n(o),c=>q(o,c))),$e(Z,c=>y==null?void 0:y(c)),Ze(Z,c=>q(z,c),()=>n(z));var ee=i(Z,2),se=r(ee);{var ne=c=>{var v=me(),m=Y(v);de(m,17,()=>{var s;return Object.entries(((s=e.info)==null?void 0:s.status_map)??{})},ge,(s,A)=>{let f=()=>n(A)[0],p=()=>n(A)[1];var M=me(),B=Y(M);{var R=te=>{var ie=na(),ce={};H(()=>{ce!==(ce=f())&&(ie.value=(ie.__value=f())??"")}),l(te,ie)};N(B,te=>{var ie;p()===we.ALIVE&&f()!==((ie=e.info)==null?void 0:ie.agent)&&te(R)})}l(s,M)}),l(c,v)},I=c=>{var v=oa(),m=Y(v);{var s=f=>{var p=ia();p.value=p.__value="Skip",l(f,p)};N(m,f=>{var p;(((p=e.info)==null?void 0:p.remain_skip)??0)>0&&f(s)})}var A=i(m,2);A.value=A.__value="Over",l(c,v)};N(se,c=>{n($)?c(ne):c(I,!1)})}a(ee);var O=i(ee,2);{var S=c=>{var v=la(),m=r(v);a(v),H(()=>x(m,`残り${n(u)??""}文字`)),l(c,v)},C=c=>{var v=sa(),m=r(v);a(v),H(()=>x(m,`${n(u)*-1}文字超過`)),l(c,v)};N(O,c=>{n(u)>=0?c(S):c(C,!1)})}var F=i(O,2);F.__click=[ca,e,o];var w=r(F);le(w,"icon","mdi:send"),_e(),a(F),a(k);var X=i(k,2),D=r(X);a(X),H((c,v,m)=>{Le(Q,`--value:${c??""};`),xe(Q,"aria-label",v),x(re,m),De(D,n(oe))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),l(g,b)};N(_,g=>{var b;(b=n(G))!=null&&b.display.largeScale?g(E):g(j,!1)})}a(P),l(t,P),Ne()}ct(["click","keydown"]);var _a=d('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),da=d('<pre class="text-md text-pretty break-all my-2"> </pre>'),ga=d('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),ma=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),xa=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),ba=d('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),pa=d('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),ha=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),ya=d('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ia=d('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),Aa=d('<div class="grow overflow-y-auto pr-4"><pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!> <!></div>'),Ta=d('<pre class="text-lg text-center"> </pre>'),wa=d('<h2 class="text-lg font-bold text-center">プロフィール</h2> <pre class="text-md text-pretty break-all"> </pre>',1),ka=d('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Sa=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ra=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ea=d('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Oa=d('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),Na=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Da=d('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ma=d('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),ja=d('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">名前</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <!> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),La=d('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function Ca(t,e){Oe(e,!0);let o=ae(void 0);Ve(()=>{const U=be.subscribe(h=>{q(o,h,!0)});Me(U)});var u=La(),G=r(u),z=r(G);{var oe=U=>{var h=Aa(),y=r(h),P=r(y,!0);a(y);var _=i(y,2),E=r(_,!0);a(_);var j=i(_,2),g=r(j,!0);a(j);var b=i(j,2);{var k=K=>{var Z=_a(),ee=r(Z,!0);a(Z),H(()=>x(ee,Se[e.request])),l(K,Z)};N(b,K=>{e.request&&K(k)})}var V=i(b,2);{var T=K=>{var Z=da(),ee=r(Z,!0);a(Z),H(()=>x(ee,e.profile)),l(K,Z)};N(V,K=>{e.profile&&K(T)})}var L=i(V,2);de(L,17,()=>Object.entries(e.info.status_map??{}),ge,(K,Z)=>{let ee=()=>n(Z)[0],se=()=>n(Z)[1];var ne=me(),I=Y(ne);{var O=C=>{var F=ga(),w=r(F),X=r(w,!0);a(w);var D=i(w,2),c=r(D,!0);a(D);var v=i(D,2),m=r(v,!0);a(v),a(F),H(()=>{x(X,ee()),x(c,Te[(e.info.role_map??{})[ee()]]??""),x(m,Ce[se()])}),l(C,F)},S=C=>{var F=ma(),w=r(F),X=r(w,!0);a(w);var D=i(w,2),c=r(D,!0);a(D);var v=i(D,2),m=r(v);a(v),a(F),H(s=>{x(X,ee()),x(c,Te[(e.info.role_map??{})[ee()]]??""),x(m,`${Ce[se()]??""}${s??""}`)},[()=>e.executedAgents.includes(ee())?" (追放)":e.attackedAgents.includes(ee())?" (襲撃)":""]),l(C,F)};N(I,C=>{se()===we.ALIVE?C(O):C(S,!1)})}l(K,ne)});var Q=i(L,2);{var re=K=>{var Z=pa(),ee=i(Y(Z),2);de(ee,17,()=>e.mediumResults,ge,(se,ne)=>{let I=()=>n(ne).day,O=()=>n(ne).target,S=()=>n(ne).result;var C=me(),F=Y(C);{var w=D=>{var c=xa(),v=r(c),m=r(v,!0);a(v);var s=i(v,2),A=r(s);a(s);var f=i(s,2),p=r(f,!0);a(f),a(c),H(()=>{x(m,O()),x(A,`(${I()??""}日目)`),x(p,he[S()])}),l(D,c)},X=D=>{var c=ba(),v=r(c),m=r(v,!0);a(v);var s=i(v,2),A=r(s);a(s);var f=i(s,2),p=r(f,!0);a(f),a(c),H(()=>{x(m,O()),x(A,`(${I()??""}日目)`),x(p,he[S()])}),l(D,c)};N(F,D=>{S()!==Fe.HUMAN?D(w):D(X,!1)})}l(se,C)}),l(K,Z)};N(Q,K=>{e.mediumResults.length>0&&K(re)})}var W=i(Q,2);{var J=K=>{var Z=Ia(),ee=i(Y(Z),2);de(ee,17,()=>e.divineResults,ge,(se,ne)=>{let I=()=>n(ne).day,O=()=>n(ne).target,S=()=>n(ne).result;var C=me(),F=Y(C);{var w=D=>{var c=ha(),v=r(c),m=r(v,!0);a(v);var s=i(v,2),A=r(s);a(s);var f=i(s,2),p=r(f,!0);a(f),a(c),H(()=>{x(m,O()),x(A,`(${I()??""}日目)`),x(p,he[S()])}),l(D,c)},X=D=>{var c=ya(),v=r(c),m=r(v,!0);a(v);var s=i(v,2),A=r(s);a(s);var f=i(s,2),p=r(f,!0);a(f),a(c),H(()=>{x(m,O()),x(A,`(${I()??""}日目)`),x(p,he[S()])}),l(D,c)};N(F,D=>{S()!==Fe.HUMAN?D(w):D(X,!1)})}l(se,C)}),l(K,Z)};N(W,K=>{e.divineResults.length>0&&K(J)})}a(h),H(()=>{x(P,e.agent?e.agent:"ゲーム外"),x(E,e.role?Te[e.role]:"ゲーム外"),x(g,e.info?e.info.day+"日目":"ゲーム外")}),l(U,h)},$=U=>{var h=ja(),y=i(Y(h),2),P=r(y),_=r(P),E=i(r(_),2),j=r(E,!0);a(E),a(_);var g=i(_,2),b=i(r(g),2),k=r(b,!0);a(b),a(g);var V=i(g,2),T=i(r(V),2),L=r(T,!0);a(T),a(V);var Q=i(V,2),re=i(r(Q),2);{var W=O=>{var S=Ta(),C=r(S,!0);a(S),H(()=>x(C,Se[e.request])),l(O,S)};N(re,O=>{e.request&&O(W)})}a(Q),a(P);var J=i(P,2);{var K=O=>{var S=wa(),C=i(Y(S),2),F=r(C,!0);a(C),H(()=>x(F,e.profile)),l(O,S)};N(J,O=>{e.profile&&O(K)})}var Z=i(J,4);de(Z,17,()=>Object.entries(e.info.status_map??{}),ge,(O,S)=>{let C=()=>n(S)[0],F=()=>n(S)[1];var w=me(),X=Y(w);{var D=v=>{var m=ka(),s=r(m),A=r(s,!0);a(s);var f=i(s,2),p=r(f,!0);a(f);var M=i(f,2),B=r(M,!0);a(M),a(m),H(()=>{x(A,C()),x(p,Te[(e.info.role_map??{})[C()]]??""),x(B,Ce[F()])}),l(v,m)},c=v=>{var m=Sa(),s=r(m),A=r(s,!0);a(s);var f=i(s,2),p=r(f,!0);a(f);var M=i(f,2),B=r(M);a(M),a(m),H(R=>{x(A,C()),x(p,Te[(e.info.role_map??{})[C()]]??""),x(B,`${Ce[F()]??""}${R??""}`)},[()=>e.executedAgents.includes(C())?" (追放)":e.attackedAgents.includes(C())?" (襲撃)":""]),l(v,m)};N(X,v=>{F()===we.ALIVE?v(D):v(c,!1)})}l(O,w)});var ee=i(Z,2);{var se=O=>{var S=Oa(),C=i(Y(S),2);de(C,17,()=>e.mediumResults,ge,(F,w)=>{let X=()=>n(w).day,D=()=>n(w).target,c=()=>n(w).result;var v=me(),m=Y(v);{var s=f=>{var p=Ra(),M=r(p),B=r(M,!0);a(M);var R=i(M,2),te=r(R);a(R);var ie=i(R,2),ce=r(ie,!0);a(ie),a(p),H(()=>{x(B,D()),x(te,`(${X()??""}日目)`),x(ce,he[c()])}),l(f,p)},A=f=>{var p=Ea(),M=r(p),B=r(M,!0);a(M);var R=i(M,2),te=r(R);a(R);var ie=i(R,2),ce=r(ie,!0);a(ie),a(p),H(()=>{x(B,D()),x(te,`(${X()??""}日目)`),x(ce,he[c()])}),l(f,p)};N(m,f=>{c()!==Fe.HUMAN?f(s):f(A,!1)})}l(F,v)}),l(O,S)};N(ee,O=>{e.mediumResults.length>0&&O(se)})}var ne=i(ee,2);{var I=O=>{var S=Ma(),C=i(Y(S),2);de(C,17,()=>e.divineResults,ge,(F,w)=>{let X=()=>n(w).day,D=()=>n(w).target,c=()=>n(w).result;var v=me(),m=Y(v);{var s=f=>{var p=Na(),M=r(p),B=r(M,!0);a(M);var R=i(M,2),te=r(R);a(R);var ie=i(R,2),ce=r(ie,!0);a(ie),a(p),H(()=>{x(B,D()),x(te,`(${X()??""}日目)`),x(ce,he[c()])}),l(f,p)},A=f=>{var p=Da(),M=r(p),B=r(M,!0);a(M);var R=i(M,2),te=r(R);a(R);var ie=i(R,2),ce=r(ie,!0);a(ie),a(p),H(()=>{x(B,D()),x(te,`(${X()??""}日目)`),x(ce,he[c()])}),l(f,p)};N(m,f=>{c()!==Fe.HUMAN?f(s):f(A,!1)})}l(F,v)}),l(O,S)};N(ne,O=>{e.divineResults.length>0&&O(I)})}a(y),H(()=>{x(j,e.agent?e.agent:"ゲーム外"),x(k,e.role?Te[e.role]:"ゲーム外"),x(L,e.info?e.info.day+"日目":"ゲーム外")}),l(U,h)};N(z,U=>{var h;(h=n(o))!=null&&h.display.largeScale?U(oe):U($,!1)})}a(G),a(u),l(t,u),Ne()}function Fa(){Re.connect()}function Ha(){Re.disconnect()}var Pa=d('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Va=d('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),Ka=d('<div class="status status-error"></div>'),Ga=(t,e)=>e("connection.url",t.currentTarget.value),Ja=(t,e)=>e("connection.token",t.currentTarget.value),Ua=(t,e)=>e("team",t.currentTarget.value),Wa=(t,e)=>e("display.largeScale",t.currentTarget.checked),Za=d('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./">aiwolf-nlp-viewer</a> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="WebSocket URL"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="Authorization Key"> <span class="badge badge-neutral badge-xs">Optional</span></label> <button class="btn btn-info">接続</button> <button class="btn btn-error">切断</button> <button class="btn">設定</button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold">エージェント設定</h3> <h4 class="text-base font-bold mt-2">チーム名</h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <h3 class="text-lg font-bold mt-4">表示設定</h3> <h4 class="text-base font-bold mt-2">大画面向け</h4> <label class="label cursor-pointer my-2"><span class="label-text">有効</span> <input type="checkbox" class="checkbox"></label></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function qa(t,e){Oe(e,!0);let o=ae(void 0),u=ae(void 0);const G=be.subscribe(w=>{q(o,w,!0)}),z=Re.subscribe(w=>{q(u,w.status,!0)});Me(()=>{G(),z()});function oe(w,X){be.update(D=>{const c=w.split("."),v=c.pop();let m=D;for(const s of c)s&&(m=m[s]);return m[v]=X,{...D}})}let $;var U=Za(),h=i(r(U),2),y=r(h),P=r(y);{var _=w=>{var X=Pa();_e(2),l(w,X)},E=(w,X)=>{{var D=v=>{var m=Va();_e(2),l(v,m)},c=v=>{var m=Ka();l(v,m)};N(w,v=>{n(u)==="connecting"?v(D):v(c,!1)},X)}};N(P,w=>{n(u)==="connected"?w(_):w(E,!1)})}a(y),a(h);var j=i(h,2),g=r(j);Ge(g,1,"h-[1em] opacity-50"),le(g,"inline",!0),le(g,"icon","mdi:link");var b=i(g,2);ye(b),b.__input=[Ga,oe],a(j);var k=i(j,2),V=r(k);Ge(V,1,"h-[1em] opacity-50"),le(V,"inline",!0),le(V,"icon","mdi:key");var T=i(V,2);ye(T),T.__input=[Ja,oe],_e(2),a(k);var L=i(k,2);L.__click=[Fa];var Q=i(L,2);Q.__click=[Ha];var re=i(Q,2);re.__click=()=>$.showModal();var W=i(re,2),J=r(W),K=r(J),Z=i(r(K),4),ee=r(Z);Ge(ee,1,"h-[1em] opacity-50"),le(ee,"inline",!0),le(ee,"icon","mdi:rename");var se=i(ee,2);ye(se),se.__input=[Ua,oe],a(Z);var ne=i(Z,6),I=i(r(ne),2);ye(I),I.__change=[Wa,oe],a(ne),a(K),a(J),_e(2),a(W),Ze(W,w=>$=w,()=>$);var O=i(W,2),S=r(O);le(S,"inline",!0),le(S,"icon","mdi:white-balance-sunny");var C=i(S,2),F=i(C,2);le(F,"inline",!0),le(F,"icon","mdi:moon-and-stars"),a(O),a(U),H(()=>{var w,X,D,c;De(b,(w=n(o))==null?void 0:w.connection.url),De(T,(X=n(o))==null?void 0:X.connection.token),L.disabled=n(u)!=="disconnected",Q.disabled=n(u)==="disconnected",De(se,(D=n(o))==null?void 0:D.team),We(I,(c=n(o))==null?void 0:c.display.largeScale)}),l(t,U),Ne()}ct(["input","click","change"]);var Ba=d("<iconify-icon></iconify-icon>",2),Ya=d("<iconify-icon></iconify-icon>",2),za=d('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),Qa=d('<div class="chat-image avatar"><div class="w-20 rounded-full"><img></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),Xa=d("<iconify-icon></iconify-icon>",2),$a=d("<iconify-icon></iconify-icon>",2),er=d('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),tr=d('<div class="chat-image avatar"><div class="w-10 rounded-full"><img></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),ar=d('<div class="chat chat-start"><!></div>');function ot(t,e){Oe(e,!0);let o=ae(void 0);Ve(()=>{const $=be.subscribe(U=>{q(o,U,!0)});Me($)});var u=ar(),G=r(u);{var z=$=>{var U=Qa(),h=Y(U),y=r(h),P=r(y);a(y),a(h);var _=i(h,2),E=r(_,!0);a(_);var j=i(_,2);{var g=T=>{var L=Ba();le(L,"inline",!0),le(L,"icon","mdi:skip-forward"),l(T,L)},b=(T,L)=>{{var Q=W=>{var J=Ya();le(J,"inline",!0),le(J,"icon","mdi:arrow-u-down-right-bold"),l(W,J)},re=W=>{var J=za(),K=r(J,!0);a(J),H(()=>x(K,e.talk.text)),l(W,J)};N(T,W=>{e.talk.skip?W(Q):W(re,!1)},L)}};N(j,T=>{e.talk.over?T(g):T(b,!1)})}var k=i(j,2),V=r(k);a(k),H(()=>{xe(P,"src",e.isDefaultProfile?`${Xe}${Ye[e.talk.agent]}`:""),xe(P,"alt",e.talk.agent),x(E,e.talk.agent),x(V,`Idx: ${e.talk.idx??""}`)}),l($,U)},oe=$=>{var U=tr(),h=Y(U),y=r(h),P=r(y);a(y),a(h);var _=i(h,2),E=r(_,!0);a(_);var j=i(_,2);{var g=T=>{var L=Xa();le(L,"inline",!0),le(L,"icon","mdi:skip-forward"),l(T,L)},b=(T,L)=>{{var Q=W=>{var J=$a();le(J,"inline",!0),le(J,"icon","mdi:arrow-u-down-right-bold"),l(W,J)},re=W=>{var J=er(),K=r(J,!0);a(J),H(()=>x(K,e.talk.text)),l(W,J)};N(T,W=>{e.talk.skip?W(Q):W(re,!1)},L)}};N(j,T=>{e.talk.over?T(g):T(b,!1)})}var k=i(j,2),V=r(k);a(k),H(()=>{xe(P,"src",e.isDefaultProfile?`${Xe}${Ye[e.talk.agent]}`:""),xe(P,"alt",e.talk.agent),x(E,e.talk.agent),x(V,`Idx: ${e.talk.idx??""}`)}),l($,U)};N(G,$=>{var U;(U=n(o))!=null&&U.display.largeScale?$(z):$(oe,!1)})}a(u),l(t,u),Ne()}var rr=d('<input type="radio" name="talk_days" class="tab text-lg font-bold"> <div class="tab-content my-4"></div>',1),nr=d('<div class="tabs tabs-border"></div>'),ir=d('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),or=d('<input type="radio" name="talk_days" class="tab"> <div class="tab-content my-4"></div>',1),lr=d('<div class="tabs tabs-border"></div>'),sr=d('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),cr=d('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function lt(t,e){Oe(e,!0);let o=ae(void 0),u=e.agents.every(h=>Object.keys(Ye).includes(h));Ve(()=>{const h=be.subscribe(y=>{q(o,y,!0)});Me(h)});var G=cr(),z=r(G),oe=r(z);{var $=h=>{var y=ir(),P=Y(y),_=r(P,!0);a(P);var E=i(P,2),j=r(E);{var g=b=>{var k=nr();const V=Ee(()=>[...new Set(e.talks.map(T=>T.day))].sort((T,L)=>L-T));de(k,21,()=>n(V),ge,(T,L)=>{var Q=rr(),re=Y(Q);ye(re);var W=i(re,2);de(W,21,()=>e.talks.filter(J=>J.day===n(L)),ge,(J,K)=>{ot(J,{get talk(){return n(K)},get agents(){return e.agents},isDefaultProfile:u})}),a(W),H(()=>{We(re,n(L)===n(V)[0]),xe(re,"aria-label",`${n(L)}日目`)}),l(T,Q)}),a(k),l(b,k)};N(j,b=>{e.talks.length>0&&b(g)})}a(E),H(()=>x(_,e.header)),l(h,y)},U=h=>{var y=sr(),P=Y(y),_=r(P,!0);a(P);var E=i(P,2),j=r(E);{var g=b=>{var k=lr();const V=Ee(()=>[...new Set(e.talks.map(T=>T.day))].sort((T,L)=>L-T));de(k,21,()=>n(V),ge,(T,L)=>{var Q=or(),re=Y(Q);ye(re);var W=i(re,2);de(W,21,()=>e.talks.filter(J=>J.day===n(L)),ge,(J,K)=>{ot(J,{get talk(){return n(K)},get agents(){return e.agents},isDefaultProfile:u})}),a(W),H(()=>{We(re,n(L)===n(V)[0]),xe(re,"aria-label",`${n(L)}日目`)}),l(T,Q)}),a(k),l(b,k)};N(j,b=>{e.talks.length>0&&b(g)})}a(E),H(()=>x(_,e.header)),l(h,y)};N(oe,h=>{var y;(y=n(o))!=null&&y.display.largeScale?h($):h(U,!1)})}a(z),a(G),l(t,G),Ne()}var vr=d('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),ur=d('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none">未接続</pre></div>'),fr=d('<div role="alert" class="alert m-4"><span class="text-lg font-bold">未接続</span></div>'),_r=d('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Or(t,e){Oe(e,!0);let o=ae(void 0),u=ae(""),G=ae(null),z=ae(Ie([])),oe=ae(null),$=ae(null),U=ae(null),h=ae(null),y=ae(null),P=ae(Ie([])),_=ae(Ie([])),E=ae(null),j=ae(Ie([])),g=ae(Ie([])),b=ae(Ie([])),k=ae(Ie([])),V=ae(null),T=ae(null),L=be.subscribe(I=>{q(o,I,!0)}),Q=Re.subscribe(I=>{q(u,I.status,!0),I.deadline?(q(G,I.deadline.getTime(),!0),W()):(q(G,null),q(V,null),n(T)&&(cancelAnimationFrame(n(T)),q(T,null))),q(z,I.entries,!0),q(oe,I.agent,!0),q($,I.role,!0),q(U,I.profile,!0),q(h,I.request,!0),q(y,I.info,!0),q(P,I.mediumResults,!0),q(_,I.divineResults,!0),q(E,I.setting,!0),q(j,I.talkHistory,!0),q(g,I.whisperHistory,!0),q(b,I.executedAgents,!0),q(k,I.attackedAgents,!0)});function re(){const I=mt.url.searchParams,O=I.get("url"),S=I.get("token");O&&(be.update(C=>({...C,connection:{url:O??"",token:S??""}})),Re.connect())}function W(){if(n(G)===null)return;const I=()=>{if(n(G)===null)return;const O=Date.now(),S=Math.max(0,n(G)-O);q(V,S,!0),S>0?q(T,requestAnimationFrame(I),!0):(q(V,0),q(T,null))};n(T)&&cancelAnimationFrame(n(T)),q(T,requestAnimationFrame(I),!0)}function J(I){Re.send(I)}{re();const I=S=>{n(u)==="connected"&&S.preventDefault()},O=S=>{n(u)==="connected"&&S.preventDefault()};window.addEventListener("beforeunload",I),window.addEventListener("popstate",O),Me(()=>{window.removeEventListener("beforeunload",I),window.removeEventListener("popstate",O),n(T)&&cancelAnimationFrame(n(T)),L(),Q()})}var K=_r();gt(I=>{dt.title="aiwolf-nlp-viewer"});var Z=r(K);qa(Z,{});var ee=i(Z,2);{var se=I=>{var O=vr(),S=Y(O),C=r(S);Ca(C,{get agent(){return n(oe)},get role(){return n($)},get profile(){return n(U)},get request(){return n(h)},get info(){return n(y)},get mediumResults(){return n(P)},get divineResults(){return n(_)},get executedAgents(){return n(b)},get attackedAgents(){return n(k)}});var F=i(C,2);const w=Ee(()=>{var m;return Object.keys(((m=n(y))==null?void 0:m.status_map)??{})});lt(F,{header:"トーク履歴",get talks(){return n(j)},get agents(){return n(w)}});var X=i(F,2);{var D=m=>{const s=Ee(()=>{var A;return Object.keys(((A=n(y))==null?void 0:A.status_map)??{})});lt(m,{header:"囁き履歴",get talks(){return n(g)},get agents(){return n(s)}})};N(X,m=>{n($)===xt.WEREWOLF&&m(D)})}a(S);var c=i(S,2);{var v=m=>{fa(m,{get remain(){return n(V)},get setting(){return n(E)},get request(){return n(h)},get info(){return n(y)},onSendMessage:J})};N(c,m=>{n(V)!==null&&m(v)})}l(I,O)},ne=(I,O)=>{{var S=F=>{var w=ur();l(F,w)},C=F=>{var w=fr();l(F,w)};N(I,F=>{var w;(w=n(o))!=null&&w.display.largeScale?F(S):F(C,!1)},O)}};N(ee,I=>{n(y)!==null?I(se):I(ne,!1)})}a(K),l(t,K),Ne()}export{Or as component};
