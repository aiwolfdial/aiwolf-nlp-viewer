import{t as u,a as v,c as gt,d as Et}from"../chunks/BmtqTvJI.js";import{p as tt,c,r as n,t as D,a as et,f as lt,g as h,aG as ft,s as i,aH as rt,ae as mt,aE as wt,d as Y,$ as Ot}from"../chunks/BIOpa1Bb.js";import{s as F,d as pt}from"../chunks/Cnt0q032.js";import{i as T}from"../chunks/Cjw-WK3l.js";import{e as G,i as H}from"../chunks/DFUuc1kT.js";import{h as Nt}from"../chunks/DE0Q-wPF.js";import{s as O}from"../chunks/B45DtwWp.js";import{s as ct}from"../chunks/BK_dRbxW.js";import{I as Tt,R as At,S as Ct,a as Vt,T as Ut}from"../chunks/Dz1Iufi4.js";/* empty css                */import{s as Z}from"../chunks/C9_fMXGy.js";import{p as B}from"../chunks/B7VD14qR.js";import{_ as S}from"../chunks/C1FmrZbK.js";import{b as Dt}from"../chunks/dKdZw_CZ.js";function st(f){const s=f.split(/\r?\n/).filter(t=>t.trim()),p={};return s.forEach(t=>{const[g,o,..._]=t.split(",");p[g]||(p[g]=Mt()),Rt(p[g],o,_)}),p}function Mt(){return{agents:{},talks:[],votes:[],execution:null,divine:null,attackVotes:[],attack:null,result:null}}function Rt(f,s,p){const g={status:([o,_,d,L,b])=>{f.agents[o]={role:_,status:d,originalName:L,gameName:b||Tt(o)}},talk:([o,_,d,L])=>{f.talks.push({talkIdx:o,turnIdx:_,agentIdx:d,text:L})},vote:([o,_])=>{f.votes.push({agentIdx:o,targetIdx:_})},execute:([o,_])=>{f.execution={agentIdx:o,role:_}},divine:([o,_,d])=>{f.divine={agentIdx:o,targetIdx:_,result:d}},attackVote:([o,_])=>{f.attackVotes.push({agentIdx:o,targetIdx:_})},attack:([o,_])=>{f.attack={targetIdx:o,isSuccessful:_==="true"}},result:([o,_,d])=>{f.result={villagers:o,werewolves:_,winSide:d}}}[s];g&&g(p)}function $(f){let s=0;for(let o=0;o<f.length;o++)s=f.charCodeAt(o)+((s<<5)-s);const p=Math.abs(s)%360,t=85+s%10,g=60+s%10;return`hsla(${p}, ${t}%, ${g}%, 0.7)`}var St=u("<strong> </strong>");function z(f,s){tt(s,!0);let p=B(s,"highlight",3,!1),t=B(s,"text",3,""),g=B(s,"key",3,void 0);var o=St(),_=c(o,!0);n(o),D(d=>{Z(o,d),F(_,t())},[()=>p()?`background: linear-gradient(transparent 60%, ${$(g()??t())} 60%)`:""]),v(f,o),et()}function zt(f,s){tt(s,!0);let p=B(s,"text",3,""),t=B(s,"names",19,()=>[]);function g(d){const L=[];let b=0;for(;b<d.length;){let C=!1,N=d.length,V="",m="";for(const r of t()){const x=d.indexOf("@"+r,b);x!==-1&&x<N&&(N=x,V="@"+r,m=r,C=!0);const y=d.indexOf(">>"+r,b);y!==-1&&y<N&&(N=y,V=">>"+r,m=r,C=!0);const w=d.indexOf(r,b);w!==-1&&w<N&&(w===0||d[w-1]!=="@"&&d[w-1]!==">")&&(N=w,V=r,m=r,C=!0)}if(C)N>b&&L.push({text:d.slice(b,N),key:void 0,tag:!1}),L.push({text:V,key:m,tag:!0}),b=N+V.length;else{L.push({text:d.slice(b),key:void 0,tag:!1});break}}return{parts:L}}var o=gt(),_=lt(o);G(_,17,()=>g(p()).parts,H,(d,L)=>{var b=gt(),C=lt(b);{var N=m=>{const r=ft(()=>h(L).text??"");z(m,{get text(){return h(r)},get key(){return h(L).key},highlight:!0})},V=m=>{var r=Et();D(()=>F(r,h(L).text)),v(m,r)};T(C,m=>{h(L).tag?m(N):m(V,!1)})}v(d,b)}),v(f,o),et()}var Pt=u("<iconify-icon></iconify-icon>",2),jt=u("<iconify-icon></iconify-icon>",2),Ft=u("<iconify-icon></iconify-icon>",2),Kt=u("<iconify-icon></iconify-icon>",2),qt=u("<iconify-icon></iconify-icon>",2),Gt=u("<iconify-icon></iconify-icon>",2),Ht=u("<iconify-icon></iconify-icon>",2),Bt=u("<li><!> </li>"),Jt=u('<div><h3 class="text-lg font-bold my-2">エージェント</h3> <ul></ul></div>'),Qt=u("<li><!> <!></li>"),Wt=u('<div><h3 class="text-lg font-bold my-2">会話</h3> <ul></ul></div>'),Xt=u('<li class="p-2 my-2 border-4 rounded-md"><!> が <!> に投票</li>'),Yt=u('<div><h3 class="text-lg font-bold my-2">投票</h3> <ul></ul></div>'),Zt=u('<div><h3 class="text-lg font-bold my-2">追放</h3> <p><!> を追放</p></div>'),$t=u('<li class="p-2 my-2 border-4 rounded-md"><!> が <!> に投票</li>'),te=u('<div><h3 class="text-lg font-bold my-2">襲撃投票</h3> <ul></ul></div>'),ee=u("<p><!> を襲撃: <strong> </strong></p>"),ae=u("<p>襲撃対象なし</p>"),re=u('<div><h3 class="text-lg font-bold my-2">襲撃</h3> <!></div>'),oe=u('<div><h3 class="text-lg font-bold my-2">占い</h3> <p><!> が <!> を占い: <strong> </strong></p></div>'),ie=u('<div><h3 class="text-lg font-bold my-2">結果</h3> <p><strong> </strong> が勝利</p></div>'),ne=u('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><h2 class="text-xl font-bold pb-2"> <!> <!> <!> <!> <!> <!> <!></h2> <div class="grow overflow-y-auto pr-4"><!> <!> <!> <!> <!> <!> <!> <!></div></div></div>');function se(f,s){tt(s,!0);let p=B(s,"dayIdx",3,""),t=B(s,"dayStatus",19,()=>({}));var g=ne(),o=c(g),_=c(o),d=c(_),L=i(d);{var b=e=>{var a=Pt();O(a,"inline",!0),O(a,"icon","mdi:conversation"),v(e,a)};T(L,e=>{t().talks.length>0&&e(b)})}var C=i(L,2);{var N=e=>{var a=jt();O(a,"inline",!0),O(a,"icon","mdi:vote"),v(e,a)};T(C,e=>{t().votes.length>0&&e(N)})}var V=i(C,2);{var m=e=>{var a=Ft();O(a,"inline",!0),O(a,"icon","mdi:account-remove"),v(e,a)};T(V,e=>{t().execution&&e(m)})}var r=i(V,2);{var x=e=>{var a=Kt();O(a,"inline",!0),O(a,"icon","mdi:vote"),v(e,a)};T(r,e=>{t().attackVotes.length>0&&e(x)})}var y=i(r,2);{var w=e=>{var a=qt();O(a,"inline",!0),O(a,"icon","mdi:sword"),v(e,a)};T(y,e=>{t().attack&&e(w)})}var M=i(y,2);{var K=e=>{var a=Gt();O(a,"inline",!0),O(a,"icon","mdi:account-eye"),v(e,a)};T(M,e=>{t().divine&&e(K)})}var P=i(M,2);{var j=e=>{var a=Ht();O(a,"inline",!0),O(a,"icon","mdi:trophy"),v(e,a)};T(P,e=>{t().result&&e(j)})}n(_);var q=i(_,2),Q=c(q);{var ot=e=>{var a=Jt(),k=i(c(a),2);G(k,21,()=>Object.entries(t().agents),H,(A,E)=>{let l=()=>h(E)[1];var I=Bt();let U;var R=c(I);z(R,{get text(){return`${l().gameName??""} (${l().originalName??""})`},get key(){return l().gameName}});var W=i(R);n(I),D((X,nt)=>{U=ct(I,1,"p-2 my-2 border-4 rounded-md",null,U,X),Z(I,nt),F(W,` ${At[l().role]??""??""} -
                ${Ct[l().status]??""??""}`)},[()=>({"opacity-25":l().status!=="ALIVE"}),()=>`border-color: ${$(l().gameName)}`]),v(A,I)}),n(k),n(a),v(e,a)};T(Q,e=>{Object.keys(t().agents).length>0&&e(ot)})}var J=i(Q,2);{var it=e=>{var a=Wt(),k=i(c(a),2);G(k,21,()=>t().talks,H,(A,E)=>{var l=Qt();let I;var U=c(l);z(U,{get text(){return t().agents[h(E).agentIdx].gameName}});var R=i(U,2);const W=ft(()=>Object.values(t().agents).map(X=>X.gameName));zt(R,{get text(){return h(E).text},get names(){return h(W)}}),n(l),D((X,nt)=>{Z(l,X),I=ct(l,1,"p-2 my-2 border-4 rounded-md",null,I,nt)},[()=>`border-color: ${$(t().agents[h(E).agentIdx].gameName)}`,()=>({"opacity-25":h(E).text==="Over"})]),v(A,l)}),n(k),n(a),v(e,a)};T(J,e=>{t().talks.length>0&&e(it)})}var at=i(J,2);{var xt=e=>{var a=Yt(),k=i(c(a),2);G(k,21,()=>t().votes,H,(A,E)=>{var l=Xt(),I=c(l);z(I,{get text(){return t().agents[h(E).agentIdx].gameName}});var U=i(I,2);z(U,{get text(){return t().agents[h(E).targetIdx].gameName},highlight:!0}),rt(),n(l),D(R=>Z(l,R),[()=>`border-color: ${$(t().agents[h(E).agentIdx].gameName)}`]),v(A,l)}),n(k),n(a),v(e,a)};T(at,e=>{t().votes.length>0&&e(xt)})}var _t=i(at,2);{var ht=e=>{var a=Zt(),k=i(c(a),2),A=c(k);z(A,{get text(){return t().agents[t().execution.agentIdx].gameName},highlight:!0}),rt(),n(k),n(a),v(e,a)};T(_t,e=>{t().execution&&e(ht)})}var vt=i(_t,2);{var bt=e=>{var a=te(),k=i(c(a),2);G(k,21,()=>t().attackVotes,H,(A,E)=>{var l=$t(),I=c(l);z(I,{get text(){return t().agents[h(E).agentIdx].gameName}});var U=i(I,2);z(U,{get text(){return t().agents[h(E).targetIdx].gameName},highlight:!0}),rt(),n(l),D(R=>Z(l,R),[()=>`border-color: ${$(t().agents[h(E).agentIdx].gameName)}`]),v(A,l)}),n(k),n(a),v(e,a)};T(vt,e=>{t().attackVotes.length>0&&e(bt)})}var dt=i(vt,2);{var yt=e=>{var a=re(),k=i(c(a),2);{var A=l=>{var I=ee(),U=c(I);z(U,{get text(){return t().agents[t().attack.targetIdx].gameName},highlight:!0});var R=i(U,2),W=c(R,!0);n(R),n(I),D(()=>F(W,t().attack.isSuccessful?"成功":"失敗")),v(l,I)},E=l=>{var I=ae();v(l,I)};T(k,l=>{t().attack.targetIdx!=="-1"?l(A):l(E,!1)})}n(a),v(e,a)};T(dt,e=>{t().attack&&e(yt)})}var ut=i(dt,2);{var kt=e=>{var a=oe(),k=i(c(a),2),A=c(k);z(A,{get text(){return t().agents[t().divine.agentIdx].gameName}});var E=i(A,2);z(E,{get text(){return t().agents[t().divine.targetIdx].gameName},highlight:!0});var l=i(E,2),I=c(l,!0);n(l),n(k),n(a),D(()=>F(I,Vt[t().divine.result]??"")),v(e,a)};T(ut,e=>{t().divine&&e(kt)})}var It=i(ut,2);{var Lt=e=>{var a=ie(),k=i(c(a),2),A=c(k),E=c(A,!0);n(A),rt(),n(k),n(a),D(()=>F(E,Ut[t().result.winSide])),v(e,a)};T(It,e=>{t().result&&e(Lt)})}n(q),n(o),n(g),D(()=>F(d,`Day ${p()??""} `)),v(f,g),et()}var le=u("<option> </option>"),ce=u('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./">aiwolf-nlp-viewer</a> <button class="btn ml-auto">クリップボードから貼り付け</button> <select class="select min-w-3xs w-3xs"><option>サンプルログを選択</option><!></select> <input class="file-input min-w-3xs w-3xs" type="file" accept=".log" multiple> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function _e(f,s){tt(s,!0);const p=Object.entries(Object.assign({"/static/assets/1734125235_kanolab_Mille_UEC-IL_sUper_IL_satozaki.log":()=>S(()=>import("../chunks/uLwNvvUb.js"),[],import.meta.url),"/static/assets/1734126573_Mille_kanolab_sUper_IL_satozaki_UEC-IL.log":()=>S(()=>import("../chunks/cHV5Ilpp.js"),[],import.meta.url),"/static/assets/1734322165_satozaki_Mille_sUper_IL_kanolab_barneko.log":()=>S(()=>import("../chunks/KsaoEMQt.js"),[],import.meta.url),"/static/assets/1734322532_barneko_Mille_satozaki_kanolab_sUper_IL.log":()=>S(()=>import("../chunks/Cu7J-Cma.js"),[],import.meta.url),"/static/assets/1734328995_CanisLupus_barneko_Mille_satozaki_sUper_IL.log":()=>S(()=>import("../chunks/JpfJ7G0g.js"),[],import.meta.url),"/static/assets/1734329414_Mille_UEC-IL_kanolab_CanisLupus_satozaki.log":()=>S(()=>import("../chunks/CH1amTOw.js"),[],import.meta.url),"/static/assets/1734329757_UEC-IL_sUper_IL_barneko_CanisLupus_satozaki.log":()=>S(()=>import("../chunks/BCiIyikN.js"),[],import.meta.url),"/static/assets/1734335625_satozaki_CanisLupus_UEC-IL_sUper_IL_barneko.log":()=>S(()=>import("../chunks/Cx4MDn7u.js"),[],import.meta.url),"/static/assets/1734336483_Mille_barneko_sUper_IL_satozaki_UEC-IL.log":()=>S(()=>import("../chunks/F010eNko.js"),[],import.meta.url),"/static/assets/1734336998_sUper_IL_satozaki_CanisLupus_kanolab_Mille.log":()=>S(()=>import("../chunks/BrcFOvsV.js"),[],import.meta.url),"/static/assets/1734339025_Mille_kanolab_CanisLupus_sUper_IL_satozaki.log":()=>S(()=>import("../chunks/CbqCXvao.js"),[],import.meta.url)})).reduce((m,[r,x])=>{const y=r.split("/").pop()||"";return{...m,[y]:`${Dt}${r.replace("/static","")}`}},{});var t=ce(),g=i(c(t),2);g.__click=function(...m){var r;(r=s.loadClipboardLog)==null||r.apply(this,m)};var o=i(g,2);o.__change=m=>{const r=m.currentTarget.value;r&&(s.loadAssetLog(p[r],r),m.currentTarget.value="")};var _=c(o);_.value=_.__value="";var d=i(_);G(d,17,()=>Object.entries(p),H,(m,r)=>{let x=()=>h(r)[0];var y=le(),w={},M=c(y,!0);n(y),D(()=>{w!==(w=x())&&(y.value=(y.__value=x())??""),F(M,x())}),v(m,y)}),n(o);var L=i(o,2);L.__change=function(...m){var r;(r=s.handleFileSelect)==null||r.apply(this,m)};var b=i(L,2),C=c(b);O(C,"inline",!0),O(C,"icon","mdi:white-balance-sunny");var N=i(C,2),V=i(N,2);O(V,"inline",!0),O(V,"icon","mdi:moon-and-stars"),n(b),n(t),v(f,t),et()}pt(["click","change"]);var ve=(f,s,p)=>Y(s,p(),!0),de=(f,s,p)=>s(p()),ue=u('<div class="w-fit shrink-0 flex gap-0"><button> </button> <button class="btn btn-error btn-square" aria-label="Close tab"><iconify-icon></iconify-icon></button></div>',2),ge=u('<div class="w-full shrink-0 overflow-x-auto flex gap-4 m-4"></div> <div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"></div>',1),me=u('<main class="h-screen flex flex-col"><!> <div class="w-full h-full flex flex-col overflow-hidden bg-base-300"><!></div></main>');function Ae(f,s){tt(s,!0);let p={records:{},selectedKey:""},t=mt(p.records),g=wt(mt(p.selectedKey));function o(r){const x=r.target;Array.from(x.files||[]).forEach(w=>{const M=new FileReader;M.onload=K=>{var j;const P=((j=K.target)==null?void 0:j.result)??"";t[w.name]=st(P),Y(g,w.name,!0)},M.readAsText(w)}),x&&(x.value="")}function _(){navigator.clipboard.readText().then(r=>{const x="Clipboard"+new Date().toISOString();t[x]=st(r),Y(g,x)}).catch(r=>{console.error("Error reading clipboard:",r)})}function d(r){delete t[r],Y(g,Object.keys(t)[0]||"",!0)}async function L(r,x){try{const w=await(await fetch(r)).text();t[x]=st(w),Y(g,x,!0)}catch(y){console.error("Error loading asset log:",y)}}var b=me();Nt(r=>{Ot.title="aiwolf-nlp-viewer"});var C=c(b);_e(C,{loadAssetLog:L,loadClipboardLog:_,handleFileSelect:o});var N=i(C,2),V=c(N);{var m=r=>{var x=ge(),y=lt(x);G(y,21,()=>Object.entries(t),H,(M,K)=>{let P=()=>h(K)[0];var j=ue(),q=c(j);let Q;q.__click=[ve,g,P];var ot=c(q,!0);n(q);var J=i(q,2);J.__click=[de,d,P];var it=c(J);O(it,"icon","mdi:close"),n(J),n(j),D(at=>{Q=ct(q,1,"btn",null,Q,at),F(ot,P())},[()=>({"btn-active":h(g)===P()})]),v(M,j)}),n(y);var w=i(y,2);G(w,21,()=>Object.entries(t[h(g)]),H,(M,K)=>{let P=()=>h(K)[0],j=()=>h(K)[1];se(M,{get dayIdx(){return P()},get dayStatus(){return j()}})}),n(w),v(r,x)};T(V,r=>{Object.keys(t).length>0&&r(m)})}n(N),n(b),v(f,b),et()}pt(["click"]);export{Ae as component};
