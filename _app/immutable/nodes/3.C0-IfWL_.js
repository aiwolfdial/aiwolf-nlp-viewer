import"../chunks/DsnmJJEf.js";import{d as mt,a as Je,s as o,o as je}from"../chunks/BDXqH1NL.js";import{y as Xe,u as kt,a$ as wt,p as Ke,ax as Tt,j,e as n,b0 as ae,f as u,d as a,r as t,b as s,c as Ue,a as K,s as i,b1 as Se,b2 as be,t as E,au as de,b4 as He,i as Ne}from"../chunks/C_pIWTxR.js";import{i as R}from"../chunks/BncJs1YA.js";import{s as Be,a as ze}from"../chunks/Crytf8dL.js";import{p as St}from"../chunks/BaegVUAO.js";import{s as We,a as Pe,S as Ze,R as Rt}from"../chunks/CWhXLAHA.js";import{c as Et,r as De,a as ve,s as Te,b as qe,L as Ot,d as $e}from"../chunks/CJIgwCpJ.js";import{$ as Ye}from"../chunks/DCOaxCy4.js";import{e as he,i as Ae}from"../chunks/Cw3zlzy0.js";import{b as nt}from"../chunks/W96oxdJN.js";import{b as et}from"../chunks/EjTXjlS-.js";import{s as Qe}from"../chunks/7fu37Iyk.js";import{b as it}from"../chunks/DyEBYryk.js";function lt(r,e,g){Xe(()=>{var C=kt(()=>e(r,g?.())||{});if(C?.destroy)return()=>C.destroy()})}class st{static fromJson(e){return JSON.parse(e)}static toJson(e){return JSON.stringify(e,null,2)}}const Dt={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}},Re=Et({storageKey:"agent-settings",defaultValue:Dt,serialize:st.toJson,deserialize:st.fromJson});var xe=(r=>(r.NAME="NAME",r.TALK="TALK",r.WHISPER="WHISPER",r.VOTE="VOTE",r.DIVINE="DIVINE",r.GUARD="GUARD",r.ATTACK="ATTACK",r.INITIALIZE="INITIALIZE",r.DAILY_INITIALIZE="DAILY_INITIALIZE",r.DAILY_FINISH="DAILY_FINISH",r.FINISH="FINISH",r))(xe||{});const tt={ミナト:"/images/male/01.png",タクミ:"/images/male/02.png",ケンジ:"/images/male/03.png",リュウジ:"/images/male/04.png",ダイスケ:"/images/male/05.png",シオン:"/images/male/06.png",ベンジャミン:"/images/male/07.png",トシオ:"/images/male/08.png",ジョナサン:"/images/male/09.png",シュンイチ:"/images/male/10.png",ジョージ:"/images/male/11.png",セルヴァス:"/images/male/12.png",サクラ:"/images/female/01.png",リン:"/images/female/02.png",ユミ:"/images/female/03.png",メイ:"/images/female/04.png",ミサキ:"/images/female/05.png",ミオ:"/images/female/06.png",ミヅキ:"/images/female/07.png",ミナコ:"/images/female/08.png",アスカ:"/images/female/09.png",ミドリ:"/images/female/10.png",ヴィクトリア:"/images/female/11.png",シズエ:"/images/female/12.png"},ot=()=>({status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});function Nt(){const{subscribe:r,update:e}=wt(ot());let g=null,C=null,_=null,U=null;Re.subscribe(w=>{C=w});function ee(){g&&(g.close(),g=null,e(w=>({...w,status:"disconnected"}))),U&&(U.clear(),U=null)}function re(){if(!C)return;g&&e(()=>ot()),e(v=>({...v,status:"connecting"}));const w=new URL(C.connection.url);C.connection.token&&w.searchParams.set("token",C.connection.token),g=new WebSocket(w),g.onopen=()=>{e(v=>({...v,status:"connected"}))},g.onclose=()=>{ee()},g.onerror=()=>{ee()},g.onmessage=v=>{try{const m=Date.now(),L=JSON.parse(v.data);e(Y=>J(Y,L)),te(L,m)}catch(m){console.error("Failed to parse message:",m)}}}function ne(w){if(U&&(U.clear(),U=null,e(v=>({...v,deadline:null}))),g&&g.readyState===WebSocket.OPEN)try{g.send(w),e(v=>{const m=v.entries.slice();return m.push(w),{...v,entries:m}})}catch(v){console.error("Failed to send message:",v)}}function J(w,v){const m={...w,entries:[...w.entries,v],request:v.request};if(v.info){if(m.info=v.info,v.info.medium_result){const L=v.info.medium_result;m.mediumResults.some(Y=>Y.day===L.day&&Y.agent===L.agent)||m.mediumResults.push(L)}if(v.info.divine_result){const L=v.info.divine_result;m.divineResults.some(Y=>Y.day===L.day&&Y.agent===L.agent)||m.divineResults.push(L)}v.info.executed_agent&&m.executedAgents.push(v.info.executed_agent),v.info.attacked_agent&&m.attackedAgents.push(v.info.attacked_agent)}return v.setting&&(m.setting=v.setting,_=v.setting.timeout.action),v.talk_history&&m.talkHistory.push(...v.talk_history),v.whisper_history&&m.whisperHistory.push(...v.whisper_history),v.request===xe.INITIALIZE&&m.info&&(m.agent=m.info.agent,m.role=m.info.role_map[m.info.agent],m.profile=m.info.profile||null),m}function te(w,v){switch(w.request){case xe.NAME:ne(C?.team||"viewer"+Math.floor(Math.random()*1e3));break;case xe.TALK:case xe.WHISPER:case xe.VOTE:case xe.DIVINE:case xe.GUARD:case xe.ATTACK:U&&U.clear(),U=new Ct(()=>{ne("TIMEOUT")},new Date(v+(_??6e4))),e(m=>({...m,deadline:U?.deadline()??null}));break;case xe.FINISH:ee();break}}return{subscribe:r,connect:re,disconnect:ee,send:ne}}const Ve=Nt();class Ct{timeout;_deadline;constructor(e,g){this.timeout=setTimeout(e,g.getTime()-new Date().getTime()),this._deadline=g}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var vt;(function(r){r[r.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",r[r.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",r[r.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",r[r.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",r[r.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",r[r.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",r[r.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",r[r.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",r[r.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",r[r.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",r[r.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",r[r.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",r[r.TAGS_START=917504]="TAGS_START",r[r.TAGS_END=917631]="TAGS_END",r[r.ZWJ=8205]="ZWJ"})(vt||(vt={}));const Mt=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var ct;function ut(r){if(typeof r!="string")throw new TypeError("string cannot be undefined or null");const e=[];let g=0,C=0;for(;g<r.length;)C+=Lt(g+C,r),Gt(r[g+C])&&C++,Vt(r[g+C])&&C++,Kt(r[g+C])&&C++,qt(r[g+C])?C++:(e.push(r.substring(g,g+C)),g+=C,C=0);return e}function Lt(r,e){const g=e[r];if(!Ft(g)||r===e.length-1)return 1;const C=g+e[r+1];let _=e.substring(r+2,r+5);return _t(C)&&_t(_)?4:Ht(C)&&Ut(_)?e.slice(r).indexOf(String.fromCodePoint(917631))+2:Pt(_)?4:2}function Ft(r){return r&&Ce(r[0].charCodeAt(0),55296,56319)}function _t(r){return Ce(at(r),127462,127487)}function Ht(r){return Ce(at(r),127988,127988)}function Pt(r){return Ce(at(r),127995,127999)}function Vt(r){return typeof r=="string"&&Ce(r.charCodeAt(0),65024,65039)}function Kt(r){return typeof r=="string"&&Ce(r.charCodeAt(0),8400,8447)}function Ut(r){const e=r.codePointAt(0);return typeof r=="string"&&typeof e=="number"&&Ce(e,917504,917631)}function Gt(r){return typeof r=="string"&&Mt.includes(r.charCodeAt(0))}function qt(r){return typeof r=="string"&&r.charCodeAt(0)===8205}function at(r){return(r.charCodeAt(0)-55296<<10)+(r.charCodeAt(1)-56320)+65536}function Ce(r,e,g){return r>=e&&r<=g}(function(r){r[r.unit_1=1]="unit_1",r[r.unit_2=2]="unit_2",r[r.unit_4=4]="unit_4"})(ct||(ct={}));function dt(r,e,g){r.key==="Enter"&&(r.ctrlKey||r.metaKey)&&(r.preventDefault(),e.onSendMessage(n(g)))}var jt=u('<span aria-live="polite"> </span>m',1),Wt=(r,e,g)=>e(g()),Zt=u('<button class="btn btn-xl"> </button>'),Jt=(r,e)=>e("Skip"),Bt=u('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),zt=(r,e)=>e("Over"),Yt=u('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),Qt=u("<option></option>"),Xt=u("<option></option>"),$t=u("<!> <option></option>",1),ea=u('<pre class="text-2xl"> </pre>'),ta=u('<pre class="text-2xl bg-error text-error-content"> </pre>'),aa=(r,e,g)=>e.onSendMessage(n(g)),ra=u('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"/> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> </button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),na=u('<span aria-live="polite"> </span>m',1),ia=(r,e,g)=>e(g()),la=u('<button class="btn"> </button>'),sa=u('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),oa=(r,e)=>e("Skip"),va=u('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),ca=(r,e)=>e("Over"),ua=u('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),_a=u("<option></option>"),da=u("<option></option>"),fa=u("<!> <option></option>",1),ga=u('<pre class="text-md"> </pre>'),ma=u('<pre class="text-md bg-error text-error-content"> </pre>'),xa=(r,e,g)=>e.onSendMessage(n(g)),ba=u('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"/> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> </button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),pa=u('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function ya(r,e){Ke(e,!0);const[g,C]=Be(),_=()=>ze(Ye,"$_",g);let U=ae(""),ee=ae(0),re=ae(void 0),ne=ae(null);const J=be(()=>e.remain!==null?e.remain/(e.setting?.timeout.action??6e4)*100:0),te=be(()=>e.remain!==null?Math.floor(e.remain/6e4):0),w=be(()=>e.remain!==null?Math.floor(e.remain%6e4/1e3):0),v=be(()=>[xe.VOTE,xe.DIVINE,xe.GUARD,xe.ATTACK].includes(e.request));function m(h){if(!e.request||!e.setting)return 0;const O=e.request===xe.TALK?e.setting.talk.max_length:e.request===xe.WHISPER?e.setting.whisper.max_length:null;if(!O)return 0;let k=O.base_length??0;if(k+=e.info?.remain_length??0,O.mention_length){for(const Q in e.info?.status_map??{})if(h.indexOf("@"+Q)!==-1){k+=O.mention_length,k+=ut("@"+Q).length;break}}return O.per_talk&&(k=Math.min(k,O.per_talk)),k-=ut(h).length,k}Tt(()=>{j(ee,m(n(U)),!0)}),Je(()=>{const h=Re.subscribe(O=>{j(re,O,!0)});return()=>{h()}});function L(h){j(U,h,!0),n(ne)?.focus()}function Y(h){h.focus()}var ie=pa(),se=a(ie);{var oe=h=>{var O=ra(),k=K(O),Q=a(k),M=a(Q);{var X=l=>{var d=jt(),I=K(d),p=a(I,!0);t(I),Se(),E(Z=>{We(I,`--value:${n(te)??""};`),Te(I,"aria-label",Z),o(p,n(te))},[()=>n(te).toString()]),s(l,d)};R(M,l=>{e.remain&&e.remain>6e4&&l(X)})}var _e=i(M,2),fe=a(_e,!0);t(_e),Se(),t(Q);var B=i(Q,2),$=a(B,!0);t(B),t(k);var ce=i(k,2),z=a(ce);{var ue=l=>{var d=de(),I=K(d);he(I,17,()=>Object.entries(e.info?.status_map??{}),Ae,(p,Z)=>{var N=be(()=>He(n(Z),2));let V=()=>n(N)[0],le=()=>n(N)[1];var ge=de(),Ie=K(ge);{var ke=pe=>{var ye=Zt();ye.__click=[Wt,L,V];var Me=a(ye,!0);t(ye),E(()=>o(Me,V())),s(pe,ye)};R(Ie,pe=>{le()===Pe.ALIVE&&V()!==e.info?.agent&&pe(ke)})}s(p,ge)}),s(l,d)},x=l=>{var d=Yt(),I=K(d);{var p=V=>{var le=Bt();le.__click=[Jt,L];var ge=a(le);ve(ge,"icon","mdi:arrow-u-down-right-bold"),Se(),t(le),s(V,le)};R(I,V=>{(e.info?.remain_skip??0)>0&&V(p)})}var Z=i(I,2);Z.__click=[zt,L];var N=a(Z);ve(N,"icon","mdi:skip-forward"),Se(),t(Z),s(l,d)};R(z,l=>{n(v)?l(ue):l(x,!1)})}var y=i(z,2);De(y),y.__keydown=[dt,e,U],Xe(()=>nt(y,()=>n(U),l=>j(U,l))),lt(y,l=>Y?.(l)),et(y,l=>j(ne,l),()=>n(ne));var T=i(y,2),W=a(T);{var G=l=>{var d=de(),I=K(d);he(I,17,()=>Object.entries(e.info?.status_map??{}),Ae,(p,Z)=>{var N=be(()=>He(n(Z),2));let V=()=>n(N)[0],le=()=>n(N)[1];var ge=de(),Ie=K(ge);{var ke=pe=>{var ye=Qt(),Me={};E(()=>{Me!==(Me=V())&&(ye.value=(ye.__value=V())??"")}),s(pe,ye)};R(Ie,pe=>{le()===Pe.ALIVE&&V()!==e.info?.agent&&pe(ke)})}s(p,ge)}),s(l,d)},H=l=>{var d=$t(),I=K(d);{var p=N=>{var V=Xt();V.value=V.__value="Skip",s(N,V)};R(I,N=>{(e.info?.remain_skip??0)>0&&N(p)})}var Z=i(I,2);Z.value=Z.__value="Over",s(l,d)};R(W,l=>{n(v)?l(G):l(H,!1)})}t(T);var P=i(T,2);{var D=l=>{var d=ea(),I=a(d,!0);t(d),E(p=>o(I,p),[()=>_()("agent.remainingChars",{values:{count:n(ee)}})]),s(l,d)},S=l=>{var d=ta(),I=a(d,!0);t(d),E(p=>o(I,p),[()=>_()("agent.exceededChars",{values:{count:n(ee)*-1}})]),s(l,d)};R(P,l=>{n(ee)>=0?l(D):l(S,!1)})}var A=i(P,2);A.__click=[aa,e,U];var q=a(A);ve(q,"icon","mdi:send");var c=i(q);t(A),t(ce);var b=i(ce,2),f=a(b);t(b),E((l,d,I)=>{We(_e,`--value:${n(w)??""};`),Te(_e,"aria-label",l),o(fe,n(w)),o($,d),o(c,` ${I??""}`),qe(f,n(J))},[()=>n(w).toString(),()=>n(v)?`${_()(`game.request.${e.request}`)}${_()("agent.selectTarget")}`:`${_()(`game.request.${e.request}`)}${_()("agent.enterContent")}`,()=>_()("agent.send")]),s(h,O)},F=h=>{var O=ba(),k=K(O),Q=a(k),M=a(Q);{var X=c=>{var b=na(),f=K(b),l=a(f,!0);t(f),Se(),E((d,I,p)=>{We(f,`--value:${d??""};`),Te(f,"aria-label",I),o(l,p)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),s(c,b)};R(M,c=>{e.remain&&e.remain>6e4&&c(X)})}var _e=i(M,2),fe=a(_e,!0);t(_e),Se(),t(Q);var B=i(Q,2);{var $=c=>{var b=sa(),f=K(b),l=a(f);t(f);var d=i(f,2);he(d,17,()=>Object.entries(e.info?.status_map??{}),Ae,(I,p)=>{var Z=be(()=>He(n(p),2));let N=()=>n(Z)[0],V=()=>n(Z)[1];var le=de(),ge=K(le);{var Ie=ke=>{var pe=la();pe.__click=[ia,L,N];var ye=a(pe,!0);t(pe),E(()=>o(ye,N())),s(ke,pe)};R(ge,ke=>{V()===Pe.ALIVE&&N()!==e.info?.agent&&ke(Ie)})}s(I,le)}),E((I,p)=>o(l,`${I??""}${p??""}`),[()=>_()(`game.request.${e.request}`),()=>_()("agent.selectTarget")]),s(c,b)},ce=c=>{var b=ua(),f=K(b),l=a(f);t(f);var d=i(f,2);{var I=N=>{var V=va();V.__click=[oa,L];var le=a(V);ve(le,"icon","mdi:arrow-u-down-right-bold"),Se(),t(V),s(N,V)};R(d,N=>{(e.info?.remain_skip??0)>0&&N(I)})}var p=i(d,2);p.__click=[ca,L];var Z=a(p);ve(Z,"icon","mdi:skip-forward"),Se(),t(p),E((N,V)=>o(l,`${N??""}${V??""}`),[()=>_()(`game.request.${e.request}`),()=>_()("agent.enterContent")]),s(c,b)};R(B,c=>{n(v)?c($):c(ce,!1)})}var z=i(B,2);De(z),z.__keydown=[dt,e,U],Xe(()=>nt(z,()=>n(U),c=>j(U,c))),lt(z,c=>Y?.(c)),et(z,c=>j(ne,c),()=>n(ne));var ue=i(z,2),x=a(ue);{var y=c=>{var b=de(),f=K(b);he(f,17,()=>Object.entries(e.info?.status_map??{}),Ae,(l,d)=>{var I=be(()=>He(n(d),2));let p=()=>n(I)[0],Z=()=>n(I)[1];var N=de(),V=K(N);{var le=ge=>{var Ie=_a(),ke={};E(()=>{ke!==(ke=p())&&(Ie.value=(Ie.__value=p())??"")}),s(ge,Ie)};R(V,ge=>{Z()===Pe.ALIVE&&p()!==e.info?.agent&&ge(le)})}s(l,N)}),s(c,b)},T=c=>{var b=fa(),f=K(b);{var l=I=>{var p=da();p.value=p.__value="Skip",s(I,p)};R(f,I=>{(e.info?.remain_skip??0)>0&&I(l)})}var d=i(f,2);d.value=d.__value="Over",s(c,b)};R(x,c=>{n(v)?c(y):c(T,!1)})}t(ue);var W=i(ue,2);{var G=c=>{var b=ga(),f=a(b,!0);t(b),E(l=>o(f,l),[()=>_()("agent.remainingChars",{values:{count:n(ee)}})]),s(c,b)},H=c=>{var b=ma(),f=a(b,!0);t(b),E(l=>o(f,l),[()=>_()("agent.exceededChars",{values:{count:n(ee)*-1}})]),s(c,b)};R(W,c=>{n(ee)>=0?c(G):c(H,!1)})}var P=i(W,2);P.__click=[xa,e,U];var D=a(P);ve(D,"icon","mdi:send");var S=i(D);t(P),t(k);var A=i(k,2),q=a(A);t(A),E((c,b,f,l)=>{We(_e,`--value:${c??""};`),Te(_e,"aria-label",b),o(fe,f),o(S,` ${l??""}`),qe(q,n(J))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>_()("agent.send")]),s(h,O)};R(se,h=>{n(re)?.display.largeScale?h(oe):h(F,!1)})}t(ie),s(r,ie),Ue(),C()}mt(["click","keydown"]);var ha=u('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),Aa=u('<pre class="text-md text-pretty break-all my-2"> </pre>'),Ia=u('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),ka=u('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),wa=u('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ta=u('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Sa=u('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),Ra=u('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ea=u('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Oa=u('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),Da=u('<div class="grow overflow-y-auto pr-4"><pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!> <!></div>'),Na=u('<pre class="text-lg text-center"> </pre>'),Ca=u('<h2 class="text-lg font-bold text-center">プロフィール</h2> <pre class="text-md text-pretty break-all"> </pre>',1),Ma=u('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),La=u('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Fa=u('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ha=u('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Pa=u('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),Va=u('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ka=u('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ua=u('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),Ga=u('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">名前</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <!> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),qa=u('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function ja(r,e){Ke(e,!0);const[g,C]=Be(),_=()=>ze(Ye,"$_",g);let U=ae(void 0);Je(()=>{const w=Re.subscribe(v=>{j(U,v,!0)});je(w)});var ee=qa(),re=a(ee),ne=a(re);{var J=w=>{var v=Da(),m=a(v),L=a(m,!0);t(m);var Y=i(m,2),ie=a(Y,!0);t(Y);var se=i(Y,2),oe=a(se,!0);t(se);var F=i(se,2);{var h=B=>{var $=ha(),ce=a($,!0);t($),E(z=>o(ce,z),[()=>_()(`game.request.${e.request}`)]),s(B,$)};R(F,B=>{e.request&&B(h)})}var O=i(F,2);{var k=B=>{var $=Aa(),ce=a($,!0);t($),E(()=>o(ce,e.profile)),s(B,$)};R(O,B=>{e.profile&&B(k)})}var Q=i(O,2);he(Q,17,()=>Object.entries(e.info.status_map??{}),Ae,(B,$)=>{var ce=be(()=>He(n($),2));let z=()=>n(ce)[0],ue=()=>n(ce)[1];var x=de(),y=K(x);{var T=G=>{var H=Ia(),P=a(H),D=a(P,!0);t(P);var S=i(P,2),A=a(S,!0);t(S);var q=i(S,2),c=a(q,!0);t(q),t(H),E((b,f)=>{o(D,z()),o(A,b),o(c,f)},[()=>(e.info.role_map??{})[z()]?_()(`game.role.${(e.info.role_map??{})[z()]}`):"",()=>_()(`game.status.${ue()}`)]),s(G,H)},W=G=>{var H=ka(),P=a(H),D=a(P,!0);t(P);var S=i(P,2),A=a(S,!0);t(S);var q=i(S,2),c=a(q);t(q),t(H),E((b,f,l)=>{o(D,z()),o(A,b),o(c,`${f??""}${l??""}`)},[()=>(e.info.role_map??{})[z()]?_()(`game.role.${(e.info.role_map??{})[z()]}`):"",()=>_()(`game.status.${ue()}`),()=>e.executedAgents.includes(z())?" (追放)":e.attackedAgents.includes(z())?" (襲撃)":""]),s(G,H)};R(y,G=>{ue()===Pe.ALIVE?G(T):G(W,!1)})}s(B,x)});var M=i(Q,2);{var X=B=>{var $=Sa(),ce=i(K($),2);he(ce,17,()=>e.mediumResults,Ae,(z,ue)=>{let x=()=>n(ue).day,y=()=>n(ue).target,T=()=>n(ue).result;var W=de(),G=K(W);{var H=D=>{var S=wa(),A=a(S),q=a(A,!0);t(A);var c=i(A,2),b=a(c);t(c);var f=i(c,2),l=a(f,!0);t(f),t(S),E(d=>{o(q,y()),o(b,`(${x()??""}日目)`),o(l,d)},[()=>_()(`game.species.${T()}`)]),s(D,S)},P=D=>{var S=Ta(),A=a(S),q=a(A,!0);t(A);var c=i(A,2),b=a(c);t(c);var f=i(c,2),l=a(f,!0);t(f),t(S),E(d=>{o(q,y()),o(b,`(${x()??""}日目)`),o(l,d)},[()=>_()(`game.species.${T()}`)]),s(D,S)};R(G,D=>{T()!==Ze.HUMAN?D(H):D(P,!1)})}s(z,W)}),s(B,$)};R(M,B=>{e.mediumResults.length>0&&B(X)})}var _e=i(M,2);{var fe=B=>{var $=Oa(),ce=i(K($),2);he(ce,17,()=>e.divineResults,Ae,(z,ue)=>{let x=()=>n(ue).day,y=()=>n(ue).target,T=()=>n(ue).result;var W=de(),G=K(W);{var H=D=>{var S=Ra(),A=a(S),q=a(A,!0);t(A);var c=i(A,2),b=a(c);t(c);var f=i(c,2),l=a(f,!0);t(f),t(S),E(d=>{o(q,y()),o(b,`(${x()??""}日目)`),o(l,d)},[()=>_()(`game.species.${T()}`)]),s(D,S)},P=D=>{var S=Ea(),A=a(S),q=a(A,!0);t(A);var c=i(A,2),b=a(c);t(c);var f=i(c,2),l=a(f,!0);t(f),t(S),E(d=>{o(q,y()),o(b,`(${x()??""}日目)`),o(l,d)},[()=>_()(`game.species.${T()}`)]),s(D,S)};R(G,D=>{T()!==Ze.HUMAN?D(H):D(P,!1)})}s(z,W)}),s(B,$)};R(_e,B=>{e.divineResults.length>0&&B(fe)})}t(v),E(B=>{o(L,e.agent?e.agent:"ゲーム外"),o(ie,B),o(oe,e.info?e.info.day+"日目":"ゲーム外")},[()=>e.role?_()(`game.role.${e.role}`):"ゲーム外"]),s(w,v)},te=w=>{var v=Ga(),m=i(K(v),2),L=a(m),Y=a(L),ie=i(a(Y),2),se=a(ie,!0);t(ie),t(Y);var oe=i(Y,2),F=i(a(oe),2),h=a(F,!0);t(F),t(oe);var O=i(oe,2),k=i(a(O),2),Q=a(k,!0);t(k),t(O);var M=i(O,2),X=i(a(M),2);{var _e=y=>{var T=Na(),W=a(T,!0);t(T),E(G=>o(W,G),[()=>_()(`game.request.${e.request}`)]),s(y,T)};R(X,y=>{e.request&&y(_e)})}t(M),t(L);var fe=i(L,2);{var B=y=>{var T=Ca(),W=i(K(T),2),G=a(W,!0);t(W),E(()=>o(G,e.profile)),s(y,T)};R(fe,y=>{e.profile&&y(B)})}var $=i(fe,4);he($,17,()=>Object.entries(e.info.status_map??{}),Ae,(y,T)=>{var W=be(()=>He(n(T),2));let G=()=>n(W)[0],H=()=>n(W)[1];var P=de(),D=K(P);{var S=q=>{var c=Ma(),b=a(c),f=a(b,!0);t(b);var l=i(b,2),d=a(l,!0);t(l);var I=i(l,2),p=a(I,!0);t(I),t(c),E((Z,N)=>{o(f,G()),o(d,Z),o(p,N)},[()=>(e.info.role_map??{})[G()]?_()(`game.role.${(e.info.role_map??{})[G()]}`):"",()=>_()(`game.status.${H()}`)]),s(q,c)},A=q=>{var c=La(),b=a(c),f=a(b,!0);t(b);var l=i(b,2),d=a(l,!0);t(l);var I=i(l,2),p=a(I);t(I),t(c),E((Z,N,V)=>{o(f,G()),o(d,Z),o(p,`${N??""}${V??""}`)},[()=>(e.info.role_map??{})[G()]?_()(`game.role.${(e.info.role_map??{})[G()]}`):"",()=>_()(`game.status.${H()}`),()=>e.executedAgents.includes(G())?" (追放)":e.attackedAgents.includes(G())?" (襲撃)":""]),s(q,c)};R(D,q=>{H()===Pe.ALIVE?q(S):q(A,!1)})}s(y,P)});var ce=i($,2);{var z=y=>{var T=Pa(),W=i(K(T),2);he(W,17,()=>e.mediumResults,Ae,(G,H)=>{let P=()=>n(H).day,D=()=>n(H).target,S=()=>n(H).result;var A=de(),q=K(A);{var c=f=>{var l=Fa(),d=a(l),I=a(d,!0);t(d);var p=i(d,2),Z=a(p);t(p);var N=i(p,2),V=a(N,!0);t(N),t(l),E(le=>{o(I,D()),o(Z,`(${P()??""}日目)`),o(V,le)},[()=>_()(`game.species.${S()}`)]),s(f,l)},b=f=>{var l=Ha(),d=a(l),I=a(d,!0);t(d);var p=i(d,2),Z=a(p);t(p);var N=i(p,2),V=a(N,!0);t(N),t(l),E(le=>{o(I,D()),o(Z,`(${P()??""}日目)`),o(V,le)},[()=>_()(`game.species.${S()}`)]),s(f,l)};R(q,f=>{S()!==Ze.HUMAN?f(c):f(b,!1)})}s(G,A)}),s(y,T)};R(ce,y=>{e.mediumResults.length>0&&y(z)})}var ue=i(ce,2);{var x=y=>{var T=Ua(),W=i(K(T),2);he(W,17,()=>e.divineResults,Ae,(G,H)=>{let P=()=>n(H).day,D=()=>n(H).target,S=()=>n(H).result;var A=de(),q=K(A);{var c=f=>{var l=Va(),d=a(l),I=a(d,!0);t(d);var p=i(d,2),Z=a(p);t(p);var N=i(p,2),V=a(N,!0);t(N),t(l),E(le=>{o(I,D()),o(Z,`(${P()??""}日目)`),o(V,le)},[()=>_()(`game.species.${S()}`)]),s(f,l)},b=f=>{var l=Ka(),d=a(l),I=a(d,!0);t(d);var p=i(d,2),Z=a(p);t(p);var N=i(p,2),V=a(N,!0);t(N),t(l),E(le=>{o(I,D()),o(Z,`(${P()??""}日目)`),o(V,le)},[()=>_()(`game.species.${S()}`)]),s(f,l)};R(q,f=>{S()!==Ze.HUMAN?f(c):f(b,!1)})}s(G,A)}),s(y,T)};R(ue,y=>{e.divineResults.length>0&&y(x)})}t(m),E(y=>{o(se,e.agent?e.agent:"ゲーム外"),o(h,y),o(Q,e.info?e.info.day+"日目":"ゲーム外")},[()=>e.role?_()(`game.role.${e.role}`):"ゲーム外"]),s(w,v)};R(ne,w=>{n(U)?.display.largeScale?w(J):w(te,!1)})}t(re),t(ee),s(r,ee),Ue(),C()}function Wa(){Ve.connect()}function Za(){Ve.disconnect()}var Ja=u('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Ba=u('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),za=u('<div class="status status-error"></div>'),Ya=(r,e)=>e("connection.url",r.currentTarget.value),Qa=(r,e)=>e("connection.token",r.currentTarget.value),Xa=(r,e)=>e("team",r.currentTarget.value),$a=(r,e)=>e("display.largeScale",r.currentTarget.checked),er=u('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./"> </a> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow"/></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow"/> <span class="badge badge-neutral badge-xs"> </span></label> <button class="btn btn-info"> </button> <button class="btn btn-error"> </button> <button class="btn"> </button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold"> </h3> <h4 class="text-base font-bold mt-2"> </h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"/></label> <h3 class="text-lg font-bold mt-4"> </h3> <h4 class="text-base font-bold mt-2"> </h4> <label class="label cursor-pointer my-2"><span class="label-text"> </span> <input type="checkbox" class="checkbox"/></label> <h4 class="text-base font-bold mt-2"> </h4> <div class="my-2"><!></div></div></div> <form method="dialog" class="modal-backdrop"><button> </button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"/> <iconify-icon></iconify-icon></label></div>',2);function tr(r,e){Ke(e,!0);const[g,C]=Be(),_=()=>ze(Ye,"$_",g);let U=ae(void 0),ee=ae(void 0);const re=Re.subscribe(me=>{j(U,me,!0)}),ne=Ve.subscribe(me=>{j(ee,me.status,!0)});je(()=>{re(),ne()});function J(me,Ee){Re.update(Le=>{const Fe=me.split("."),Ge=Fe.pop();let we=Le;for(const Oe of Fe)Oe&&(we=we[Oe]);return we[Ge]=Ee,{...Le}})}let te;var w=er(),v=a(w),m=a(v,!0);t(v);var L=i(v,2),Y=a(L),ie=a(Y);{var se=me=>{var Ee=Ja();Se(2),s(me,Ee)},oe=me=>{var Ee=de(),Le=K(Ee);{var Fe=we=>{var Oe=Ba();Se(2),s(we,Oe)},Ge=we=>{var Oe=za();s(we,Oe)};R(Le,we=>{n(ee)==="connecting"?we(Fe):we(Ge,!1)},!0)}s(me,Ee)};R(ie,me=>{n(ee)==="connected"?me(se):me(oe,!1)})}t(Y),t(L);var F=i(L,2),h=a(F);Qe(h,1,"h-[1em] opacity-50"),ve(h,"inline",!0),ve(h,"icon","mdi:link");var O=i(h,2);De(O),O.__input=[Ya,J],t(F);var k=i(F,2),Q=a(k);Qe(Q,1,"h-[1em] opacity-50"),ve(Q,"inline",!0),ve(Q,"icon","mdi:key");var M=i(Q,2);De(M),M.__input=[Qa,J];var X=i(M,2),_e=a(X,!0);t(X),t(k);var fe=i(k,2);fe.__click=[Wa];var B=a(fe,!0);t(fe);var $=i(fe,2);$.__click=[Za];var ce=a($,!0);t($);var z=i($,2);z.__click=()=>te.showModal();var ue=a(z,!0);t(z);var x=i(z,2),y=a(x),T=a(y),W=a(T),G=a(W,!0);t(W);var H=i(W,2),P=a(H,!0);t(H);var D=i(H,2),S=a(D);Qe(S,1,"h-[1em] opacity-50"),ve(S,"inline",!0),ve(S,"icon","mdi:rename");var A=i(S,2);De(A),A.__input=[Xa,J],t(D);var q=i(D,2),c=a(q,!0);t(q);var b=i(q,2),f=a(b,!0);t(b);var l=i(b,2),d=a(l),I=a(d,!0);t(d);var p=i(d,2);De(p),p.__change=[$a,J],t(l);var Z=i(l,2),N=a(Z,!0);t(Z);var V=i(Z,2),le=a(V);Ot(le,{}),t(V),t(T),t(y);var ge=i(y,2),Ie=a(ge),ke=a(Ie,!0);t(Ie),t(ge),t(x),et(x,me=>te=me,()=>te);var pe=i(x,2),ye=a(pe);ve(ye,"inline",!0),ve(ye,"icon","mdi:white-balance-sunny");var Me=i(ye,2),rt=i(Me,2);ve(rt,"inline",!0),ve(rt,"icon","mdi:moon-and-stars"),t(pe),t(w),E((me,Ee,Le,Fe,Ge,we,Oe,xt,bt,pt,yt,ht,At,It)=>{o(m,me),Te(O,"placeholder",Ee),qe(O,n(U)?.connection.url),Te(M,"placeholder",Le),qe(M,n(U)?.connection.token),o(_e,Fe),fe.disabled=n(ee)!=="disconnected",o(B,Ge),$.disabled=n(ee)==="disconnected",o(ce,we),o(ue,Oe),o(G,xt),o(P,bt),qe(A,n(U)?.team),o(c,pt),o(f,yt),o(I,ht),$e(p,n(U)?.display.largeScale),o(N,At),o(ke,It)},[()=>_()("appName"),()=>_()("realtime.websocketUrl"),()=>_()("realtime.authKey"),()=>_()("realtime.optional"),()=>_()("realtime.connect"),()=>_()("realtime.disconnect"),()=>_()("realtime.settings"),()=>_()("agent.agentSettings"),()=>_()("agent.teamName"),()=>_()("realtime.displaySettings"),()=>_()("realtime.largeScreen"),()=>_()("realtime.enable"),()=>_()("common.language"),()=>_()("common.close")]),s(r,w),Ue(),C()}mt(["input","click","change"]);var ar=u("<iconify-icon></iconify-icon>",2),rr=u("<iconify-icon></iconify-icon>",2),nr=u('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),ir=u('<div class="chat-image avatar"><div class="w-20 rounded-full"><img/></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),lr=u("<iconify-icon></iconify-icon>",2),sr=u("<iconify-icon></iconify-icon>",2),or=u('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),vr=u('<div class="chat-image avatar"><div class="w-10 rounded-full"><img/></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),cr=u('<div class="chat chat-start"><!></div>');function ft(r,e){Ke(e,!0);let g=ae(void 0);Je(()=>{const re=Re.subscribe(ne=>{j(g,ne,!0)});je(re)});var C=cr(),_=a(C);{var U=re=>{var ne=ir(),J=K(ne),te=a(J),w=a(te);t(te),t(J);var v=i(J,2),m=a(v,!0);t(v);var L=i(v,2);{var Y=F=>{var h=ar();ve(h,"inline",!0),ve(h,"icon","mdi:skip-forward"),s(F,h)},ie=F=>{var h=de(),O=K(h);{var k=M=>{var X=rr();ve(X,"inline",!0),ve(X,"icon","mdi:arrow-u-down-right-bold"),s(M,X)},Q=M=>{var X=nr(),_e=a(X,!0);t(X),E(()=>o(_e,e.talk.text)),s(M,X)};R(O,M=>{e.talk.skip?M(k):M(Q,!1)},!0)}s(F,h)};R(L,F=>{e.talk.over?F(Y):F(ie,!1)})}var se=i(L,2),oe=a(se);t(se),E(()=>{Te(w,"src",e.isDefaultProfile?`${it}${tt[e.talk.agent]}`:""),Te(w,"alt",e.talk.agent),o(m,e.talk.agent),o(oe,`Idx: ${e.talk.idx??""}`)}),s(re,ne)},ee=re=>{var ne=vr(),J=K(ne),te=a(J),w=a(te);t(te),t(J);var v=i(J,2),m=a(v,!0);t(v);var L=i(v,2);{var Y=F=>{var h=lr();ve(h,"inline",!0),ve(h,"icon","mdi:skip-forward"),s(F,h)},ie=F=>{var h=de(),O=K(h);{var k=M=>{var X=sr();ve(X,"inline",!0),ve(X,"icon","mdi:arrow-u-down-right-bold"),s(M,X)},Q=M=>{var X=or(),_e=a(X,!0);t(X),E(()=>o(_e,e.talk.text)),s(M,X)};R(O,M=>{e.talk.skip?M(k):M(Q,!1)},!0)}s(F,h)};R(L,F=>{e.talk.over?F(Y):F(ie,!1)})}var se=i(L,2),oe=a(se);t(se),E(()=>{Te(w,"src",e.isDefaultProfile?`${it}${tt[e.talk.agent]}`:""),Te(w,"alt",e.talk.agent),o(m,e.talk.agent),o(oe,`Idx: ${e.talk.idx??""}`)}),s(re,ne)};R(_,re=>{n(g)?.display.largeScale?re(U):re(ee,!1)})}t(C),s(r,C),Ue()}var ur=u('<input type="radio" name="talk_days" class="tab text-lg font-bold"/> <div class="tab-content my-4"></div>',1),_r=u('<div class="tabs tabs-border"></div>'),dr=u('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),fr=u('<input type="radio" name="talk_days" class="tab"/> <div class="tab-content my-4"></div>',1),gr=u('<div class="tabs tabs-border"></div>'),mr=u('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),xr=u('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function gt(r,e){Ke(e,!0);let g=ae(void 0),C=e.agents.every(J=>Object.keys(tt).includes(J));Je(()=>{const J=Re.subscribe(te=>{j(g,te,!0)});je(J)});var _=xr(),U=a(_),ee=a(U);{var re=J=>{var te=dr(),w=K(te),v=a(w,!0);t(w);var m=i(w,2),L=a(m);{var Y=ie=>{const se=be(()=>[...new Set(e.talks.map(F=>F.day))].sort((F,h)=>h-F));var oe=_r();he(oe,21,()=>n(se),Ae,(F,h)=>{var O=ur(),k=K(O);De(k);var Q=i(k,2);he(Q,21,()=>e.talks.filter(M=>M.day===n(h)),Ae,(M,X)=>{ft(M,{get talk(){return n(X)},get agents(){return e.agents},get isDefaultProfile(){return C}})}),t(Q),E(()=>{$e(k,n(h)===n(se)[0]),Te(k,"aria-label",`${n(h)}日目`)}),s(F,O)}),t(oe),s(ie,oe)};R(L,ie=>{e.talks.length>0&&ie(Y)})}t(m),E(()=>o(v,e.header)),s(J,te)},ne=J=>{var te=mr(),w=K(te),v=a(w,!0);t(w);var m=i(w,2),L=a(m);{var Y=ie=>{const se=be(()=>[...new Set(e.talks.map(F=>F.day))].sort((F,h)=>h-F));var oe=gr();he(oe,21,()=>n(se),Ae,(F,h)=>{var O=fr(),k=K(O);De(k);var Q=i(k,2);he(Q,21,()=>e.talks.filter(M=>M.day===n(h)),Ae,(M,X)=>{ft(M,{get talk(){return n(X)},get agents(){return e.agents},get isDefaultProfile(){return C}})}),t(Q),E(()=>{$e(k,n(h)===n(se)[0]),Te(k,"aria-label",`${n(h)}日目`)}),s(F,O)}),t(oe),s(ie,oe)};R(L,ie=>{e.talks.length>0&&ie(Y)})}t(m),E(()=>o(v,e.header)),s(J,te)};R(ee,J=>{n(g)?.display.largeScale?J(re):J(ne,!1)})}t(U),t(_),s(r,_),Ue()}var br=u('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),pr=u('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none"> </pre></div>'),yr=u('<div role="alert" class="alert m-4"><span class="text-lg font-bold"> </span></div>'),hr=u('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Fr(r,e){Ke(e,!0);const[g,C]=Be(),_=()=>ze(Ye,"$_",g);let U=ae(void 0),ee=ae(""),re=ae(null),ne=ae(Ne([])),J=ae(null),te=ae(null),w=ae(null),v=ae(null),m=ae(null),L=ae(Ne([])),Y=ae(Ne([])),ie=ae(null),se=ae(Ne([])),oe=ae(Ne([])),F=ae(Ne([])),h=ae(Ne([])),O=ae(null),k=ae(null),Q=Re.subscribe(x=>{j(U,x,!0)}),M=Ve.subscribe(x=>{j(ee,x.status,!0),x.deadline?(j(re,x.deadline.getTime(),!0),_e()):(j(re,null),j(O,null),n(k)&&(cancelAnimationFrame(n(k)),j(k,null))),j(ne,x.entries,!0),j(J,x.agent,!0),j(te,x.role,!0),j(w,x.profile,!0),j(v,x.request,!0),j(m,x.info,!0),j(L,x.mediumResults,!0),j(Y,x.divineResults,!0),j(ie,x.setting,!0),j(se,x.talkHistory,!0),j(oe,x.whisperHistory,!0),j(F,x.executedAgents,!0),j(h,x.attackedAgents,!0)});function X(){const x=St.url.searchParams,y=x.get("url"),T=x.get("token");y&&(Re.update(W=>({...W,connection:{url:y??"",token:T??""}})),Ve.connect())}function _e(){if(n(re)===null)return;const x=()=>{if(n(re)===null)return;const y=Date.now(),T=Math.max(0,n(re)-y);j(O,T,!0),T>0?j(k,requestAnimationFrame(x),!0):(j(O,0),j(k,null))};n(k)&&cancelAnimationFrame(n(k)),j(k,requestAnimationFrame(x),!0)}function fe(x){Ve.send(x)}{X();const x=T=>{n(ee)==="connected"&&T.preventDefault()},y=T=>{n(ee)==="connected"&&T.preventDefault()};window.addEventListener("beforeunload",x),window.addEventListener("popstate",y),je(()=>{window.removeEventListener("beforeunload",x),window.removeEventListener("popstate",y),n(k)&&cancelAnimationFrame(n(k)),Q(),M()})}var B=hr(),$=a(B);tr($,{});var ce=i($,2);{var z=x=>{var y=br(),T=K(y),W=a(T);ja(W,{get agent(){return n(J)},get role(){return n(te)},get profile(){return n(w)},get request(){return n(v)},get info(){return n(m)},get mediumResults(){return n(L)},get divineResults(){return n(Y)},get executedAgents(){return n(F)},get attackedAgents(){return n(h)}});var G=i(W,2);{let A=be(()=>_()("agent.talkHistory")),q=be(()=>Object.keys(n(m)?.status_map??{}));gt(G,{get header(){return n(A)},get talks(){return n(se)},get agents(){return n(q)}})}var H=i(G,2);{var P=A=>{{let q=be(()=>_()("agent.whisperHistory")),c=be(()=>Object.keys(n(m)?.status_map??{}));gt(A,{get header(){return n(q)},get talks(){return n(oe)},get agents(){return n(c)}})}};R(H,A=>{n(te)===Rt.WEREWOLF&&A(P)})}t(T);var D=i(T,2);{var S=A=>{ya(A,{get remain(){return n(O)},get setting(){return n(ie)},get request(){return n(v)},get info(){return n(m)},onSendMessage:fe})};R(D,A=>{n(O)!==null&&A(S)})}s(x,y)},ue=x=>{var y=de(),T=K(y);{var W=H=>{var P=pr(),D=a(P),S=a(D,!0);t(D),t(P),E(A=>o(S,A),[()=>_()("agent.notConnected")]),s(H,P)},G=H=>{var P=yr(),D=a(P),S=a(D,!0);t(D),t(P),E(A=>o(S,A),[()=>_()("agent.notConnected")]),s(H,P)};R(T,H=>{n(U)?.display.largeScale?H(W):H(G,!1)},!0)}s(x,y)};R(ce,x=>{n(m)!==null?x(z):x(ue,!1)})}t(B),s(r,B),Ue(),C()}export{Fr as component};
