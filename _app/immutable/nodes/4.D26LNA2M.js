import{t as u,a as d,c as gt,d as Lt}from"../chunks/BmtqTvJI.js";import{p as tt,c,r as n,t as D,a as et,f as lt,g as h,aG as mt,s as i,aH as rt,ae as ft,aE as wt,d as Y,$ as Ot}from"../chunks/BIOpa1Bb.js";import{s as F,d as pt}from"../chunks/Cnt0q032.js";import{i as N}from"../chunks/Cjw-WK3l.js";import{e as q,i as H}from"../chunks/DFUuc1kT.js";import{h as Tt}from"../chunks/DE0Q-wPF.js";import{s as O}from"../chunks/B45DtwWp.js";import{s as ct}from"../chunks/BK_dRbxW.js";import{I as Nt,R as At,S as Ct,a as Vt,T as Ut}from"../chunks/Dz1Iufi4.js";/* empty css                */import{s as Z}from"../chunks/C9_fMXGy.js";import{p as B}from"../chunks/B7VD14qR.js";import{_ as S}from"../chunks/C1FmrZbK.js";import{b as Dt}from"../chunks/COfveCtu.js";function st(m){const s=m.split(/\r?\n/).filter(t=>t.trim()),p={};return s.forEach(t=>{const[g,o,..._]=t.split(",");p[g]||(p[g]=Pt()),Rt(p[g],o,_)}),p}function Pt(){return{agents:{},talks:[],votes:[],execution:null,divine:null,attackVotes:[],attack:null,result:null}}function Rt(m,s,p){const g={status:([o,_,v,E,y])=>{m.agents[o]={role:_,status:v,originalName:E,gameName:y||Nt(o)}},talk:([o,_,v,E])=>{m.talks.push({talkIdx:o,turnIdx:_,agentIdx:v,text:E})},vote:([o,_])=>{m.votes.push({agentIdx:o,targetIdx:_})},execute:([o,_])=>{m.execution={agentIdx:o,role:_}},divine:([o,_,v])=>{m.divine={agentIdx:o,targetIdx:_,result:v}},attackVote:([o,_])=>{m.attackVotes.push({agentIdx:o,targetIdx:_})},attack:([o,_])=>{m.attack={targetIdx:o,isSuccessful:_==="true"}},result:([o,_,v])=>{m.result={villagers:o,werewolves:_,winSide:v}}}[s];g&&g(p)}function $(m){let s=0;for(let o=0;o<m.length;o++)s=m.charCodeAt(o)+((s<<5)-s);const p=Math.abs(s)%360,t=85+s%10,g=60+s%10;return`hsla(${p}, ${t}%, ${g}%, 0.7)`}var St=u("<strong> </strong>");function M(m,s){tt(s,!0);let p=B(s,"highlight",3,!1),t=B(s,"text",3,""),g=B(s,"key",3,void 0);var o=St(),_=c(o,!0);n(o),D(v=>{Z(o,v),F(_,t())},[()=>p()?`background: linear-gradient(transparent 60%, ${$(g()??t())} 60%)`:""]),d(m,o),et()}function Mt(m,s){tt(s,!0);let p=B(s,"text",3,""),t=B(s,"names",19,()=>[]);function g(v){const E=[];let y=0;for(;y<v.length;){let C=!1,T=v.length,V="",f="";for(const r of t()){const x=v.indexOf("@"+r,y);x!==-1&&x<T&&(T=x,V="@"+r,f=r,C=!0);const b=v.indexOf(">>"+r,y);b!==-1&&b<T&&(T=b,V=">>"+r,f=r,C=!0);const w=v.indexOf(r,y);w!==-1&&w<T&&(w===0||v[w-1]!=="@"&&v[w-1]!==">")&&(T=w,V=r,f=r,C=!0)}if(C)T>y&&E.push({text:v.slice(y,T),key:void 0,tag:!1}),E.push({text:V,key:f,tag:!0}),y=T+V.length;else{E.push({text:v.slice(y),key:void 0,tag:!1});break}}return{parts:E}}var o=gt(),_=lt(o);q(_,17,()=>g(p()).parts,H,(v,E)=>{var y=gt(),C=lt(y);{var T=f=>{const r=mt(()=>h(E).text??"");M(f,{get text(){return h(r)},get key(){return h(E).key},highlight:!0})},V=f=>{var r=Lt();D(()=>F(r,h(E).text)),d(f,r)};N(C,f=>{h(E).tag?f(T):f(V,!1)})}d(v,y)}),d(m,o),et()}var zt=u("<iconify-icon></iconify-icon>",2),jt=u("<iconify-icon></iconify-icon>",2),Ft=u("<iconify-icon></iconify-icon>",2),Kt=u("<iconify-icon></iconify-icon>",2),Gt=u("<iconify-icon></iconify-icon>",2),qt=u("<iconify-icon></iconify-icon>",2),Ht=u("<iconify-icon></iconify-icon>",2),Bt=u("<li><!> </li>"),Jt=u('<div><h3 class="text-lg font-bold my-2">エージェント</h3> <ul></ul></div>'),Qt=u("<li><!> <!></li>"),Wt=u('<div><h3 class="text-lg font-bold my-2">会話</h3> <ul></ul></div>'),Xt=u('<li class="p-2 my-2 border-4 rounded-md"><!> が <!> に投票</li>'),Yt=u('<div><h3 class="text-lg font-bold my-2">投票</h3> <ul></ul></div>'),Zt=u('<div><h3 class="text-lg font-bold my-2">追放</h3> <p><!> を追放</p></div>'),$t=u('<li class="p-2 my-2 border-4 rounded-md"><!> が <!> に投票</li>'),te=u('<div><h3 class="text-lg font-bold my-2">襲撃投票</h3> <ul></ul></div>'),ee=u("<p><!> を襲撃: <strong> </strong></p>"),ae=u("<p>襲撃対象なし</p>"),re=u('<div><h3 class="text-lg font-bold my-2">襲撃</h3> <!></div>'),oe=u('<div><h3 class="text-lg font-bold my-2">占い</h3> <p><!> が <!> を占い: <strong> </strong></p></div>'),ie=u('<div><h3 class="text-lg font-bold my-2">結果</h3> <p><strong> </strong> が勝利</p></div>'),ne=u('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><h2 class="text-xl font-bold pb-2"> <!> <!> <!> <!> <!> <!> <!></h2> <div class="grow overflow-y-auto pr-4"><!> <!> <!> <!> <!> <!> <!> <!></div></div></div>');function se(m,s){tt(s,!0);let p=B(s,"dayIdx",3,""),t=B(s,"dayStatus",19,()=>({}));var g=ne(),o=c(g),_=c(o),v=c(_),E=i(v);{var y=e=>{var a=zt();O(a,"inline",!0),O(a,"icon","mdi:conversation"),d(e,a)};N(E,e=>{t().talks.length>0&&e(y)})}var C=i(E,2);{var T=e=>{var a=jt();O(a,"inline",!0),O(a,"icon","mdi:vote"),d(e,a)};N(C,e=>{t().votes.length>0&&e(T)})}var V=i(C,2);{var f=e=>{var a=Ft();O(a,"inline",!0),O(a,"icon","mdi:account-remove"),d(e,a)};N(V,e=>{t().execution&&e(f)})}var r=i(V,2);{var x=e=>{var a=Kt();O(a,"inline",!0),O(a,"icon","mdi:vote"),d(e,a)};N(r,e=>{t().attackVotes.length>0&&e(x)})}var b=i(r,2);{var w=e=>{var a=Gt();O(a,"inline",!0),O(a,"icon","mdi:sword"),d(e,a)};N(b,e=>{t().attack&&e(w)})}var P=i(b,2);{var K=e=>{var a=qt();O(a,"inline",!0),O(a,"icon","mdi:account-eye"),d(e,a)};N(P,e=>{t().divine&&e(K)})}var z=i(P,2);{var j=e=>{var a=Ht();O(a,"inline",!0),O(a,"icon","mdi:trophy"),d(e,a)};N(z,e=>{t().result&&e(j)})}n(_);var G=i(_,2),Q=c(G);{var ot=e=>{var a=Jt(),k=i(c(a),2);q(k,21,()=>Object.entries(t().agents),H,(A,L)=>{let l=()=>h(L)[1];var I=Bt();let U;var R=c(I);M(R,{get text(){return`${l().gameName??""} (${l().originalName??""})`},get key(){return l().gameName}});var W=i(R);n(I),D((X,nt)=>{U=ct(I,1,"p-2 my-2 border-4 rounded-md",null,U,X),Z(I,nt),F(W,` ${At[l().role]??""??""} -
                ${Ct[l().status]??""??""}`)},[()=>({"opacity-25":l().status!=="ALIVE"}),()=>`border-color: ${$(l().gameName)}`]),d(A,I)}),n(k),n(a),d(e,a)};N(Q,e=>{Object.keys(t().agents).length>0&&e(ot)})}var J=i(Q,2);{var it=e=>{var a=Wt(),k=i(c(a),2);q(k,21,()=>t().talks,H,(A,L)=>{var l=Qt();let I;var U=c(l);M(U,{get text(){return t().agents[h(L).agentIdx].gameName}});var R=i(U,2);const W=mt(()=>Object.values(t().agents).map(X=>X.gameName));Mt(R,{get text(){return h(L).text},get names(){return h(W)}}),n(l),D((X,nt)=>{Z(l,X),I=ct(l,1,"p-2 my-2 border-4 rounded-md",null,I,nt)},[()=>`border-color: ${$(t().agents[h(L).agentIdx].gameName)}`,()=>({"opacity-25":h(L).text==="Over"})]),d(A,l)}),n(k),n(a),d(e,a)};N(J,e=>{t().talks.length>0&&e(it)})}var at=i(J,2);{var xt=e=>{var a=Yt(),k=i(c(a),2);q(k,21,()=>t().votes,H,(A,L)=>{var l=Xt(),I=c(l);M(I,{get text(){return t().agents[h(L).agentIdx].gameName}});var U=i(I,2);M(U,{get text(){return t().agents[h(L).targetIdx].gameName},highlight:!0}),rt(),n(l),D(R=>Z(l,R),[()=>`border-color: ${$(t().agents[h(L).agentIdx].gameName)}`]),d(A,l)}),n(k),n(a),d(e,a)};N(at,e=>{t().votes.length>0&&e(xt)})}var _t=i(at,2);{var ht=e=>{var a=Zt(),k=i(c(a),2),A=c(k);M(A,{get text(){return t().agents[t().execution.agentIdx].gameName},highlight:!0}),rt(),n(k),n(a),d(e,a)};N(_t,e=>{t().execution&&e(ht)})}var dt=i(_t,2);{var yt=e=>{var a=te(),k=i(c(a),2);q(k,21,()=>t().attackVotes,H,(A,L)=>{var l=$t(),I=c(l);M(I,{get text(){return t().agents[h(L).agentIdx].gameName}});var U=i(I,2);M(U,{get text(){return t().agents[h(L).targetIdx].gameName},highlight:!0}),rt(),n(l),D(R=>Z(l,R),[()=>`border-color: ${$(t().agents[h(L).agentIdx].gameName)}`]),d(A,l)}),n(k),n(a),d(e,a)};N(dt,e=>{t().attackVotes.length>0&&e(yt)})}var vt=i(dt,2);{var bt=e=>{var a=re(),k=i(c(a),2);{var A=l=>{var I=ee(),U=c(I);M(U,{get text(){return t().agents[t().attack.targetIdx].gameName},highlight:!0});var R=i(U,2),W=c(R,!0);n(R),n(I),D(()=>F(W,t().attack.isSuccessful?"成功":"失敗")),d(l,I)},L=l=>{var I=ae();d(l,I)};N(k,l=>{t().attack.targetIdx!=="-1"?l(A):l(L,!1)})}n(a),d(e,a)};N(vt,e=>{t().attack&&e(bt)})}var ut=i(vt,2);{var kt=e=>{var a=oe(),k=i(c(a),2),A=c(k);M(A,{get text(){return t().agents[t().divine.agentIdx].gameName}});var L=i(A,2);M(L,{get text(){return t().agents[t().divine.targetIdx].gameName},highlight:!0});var l=i(L,2),I=c(l,!0);n(l),n(k),n(a),D(()=>F(I,Vt[t().divine.result]??"")),d(e,a)};N(ut,e=>{t().divine&&e(kt)})}var It=i(ut,2);{var Et=e=>{var a=ie(),k=i(c(a),2),A=c(k),L=c(A,!0);n(A),rt(),n(k),n(a),D(()=>F(L,Ut[t().result.winSide])),d(e,a)};N(It,e=>{t().result&&e(Et)})}n(G),n(o),n(g),D(()=>F(v,`Day ${p()??""} `)),d(m,g),et()}var le=u("<option> </option>"),ce=u('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./">aiwolf-nlp-viewer</a> <button class="btn ml-auto">クリップボードから貼り付け</button> <select class="select min-w-3xs w-3xs"><option>サンプルログを選択</option><!></select> <input class="file-input min-w-3xs w-3xs" type="file" accept=".log" multiple> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function _e(m,s){tt(s,!0);const p=Object.entries(Object.assign({"/static/assets/1734125235_kanolab_Mille_UEC-IL_sUper_IL_satozaki.log":()=>S(()=>import("../chunks/uLwNvvUb.js"),[],import.meta.url),"/static/assets/1734126573_Mille_kanolab_sUper_IL_satozaki_UEC-IL.log":()=>S(()=>import("../chunks/cHV5Ilpp.js"),[],import.meta.url),"/static/assets/1734322165_satozaki_Mille_sUper_IL_kanolab_barneko.log":()=>S(()=>import("../chunks/KsaoEMQt.js"),[],import.meta.url),"/static/assets/1734322532_barneko_Mille_satozaki_kanolab_sUper_IL.log":()=>S(()=>import("../chunks/Cu7J-Cma.js"),[],import.meta.url),"/static/assets/1734328995_CanisLupus_barneko_Mille_satozaki_sUper_IL.log":()=>S(()=>import("../chunks/JpfJ7G0g.js"),[],import.meta.url),"/static/assets/1734329414_Mille_UEC-IL_kanolab_CanisLupus_satozaki.log":()=>S(()=>import("../chunks/CH1amTOw.js"),[],import.meta.url),"/static/assets/1734329757_UEC-IL_sUper_IL_barneko_CanisLupus_satozaki.log":()=>S(()=>import("../chunks/BCiIyikN.js"),[],import.meta.url),"/static/assets/1734335625_satozaki_CanisLupus_UEC-IL_sUper_IL_barneko.log":()=>S(()=>import("../chunks/Cx4MDn7u.js"),[],import.meta.url),"/static/assets/1734336483_Mille_barneko_sUper_IL_satozaki_UEC-IL.log":()=>S(()=>import("../chunks/F010eNko.js"),[],import.meta.url),"/static/assets/1734336998_sUper_IL_satozaki_CanisLupus_kanolab_Mille.log":()=>S(()=>import("../chunks/BrcFOvsV.js"),[],import.meta.url),"/static/assets/1734339025_Mille_kanolab_CanisLupus_sUper_IL_satozaki.log":()=>S(()=>import("../chunks/CbqCXvao.js"),[],import.meta.url)})).reduce((f,[r,x])=>{const b=r.split("/").pop()||"";return{...f,[b]:`${Dt}${r.replace("/static","")}`}},{});var t=ce(),g=i(c(t),2);g.__click=function(...f){var r;(r=s.loadClipboardLog)==null||r.apply(this,f)};var o=i(g,2);o.__change=f=>{const r=f.currentTarget.value;r&&(s.loadAssetLog(p[r],r),f.currentTarget.value="")};var _=c(o);_.value=_.__value="";var v=i(_);q(v,17,()=>Object.entries(p),H,(f,r)=>{let x=()=>h(r)[0];var b=le(),w={},P=c(b,!0);n(b),D(()=>{w!==(w=x())&&(b.value=(b.__value=x())??""),F(P,x())}),d(f,b)}),n(o);var E=i(o,2);E.__change=function(...f){var r;(r=s.handleFileSelect)==null||r.apply(this,f)};var y=i(E,2),C=c(y);O(C,"inline",!0),O(C,"icon","mdi:white-balance-sunny");var T=i(C,2),V=i(T,2);O(V,"inline",!0),O(V,"icon","mdi:moon-and-stars"),n(y),n(t),d(m,t),et()}pt(["click","change"]);var de=(m,s,p)=>Y(s,p(),!0),ve=(m,s,p)=>s(p()),ue=u('<div class="w-fit shrink-0 flex gap-0"><button> </button> <button class="btn btn-error btn-square" aria-label="Close tab"><iconify-icon></iconify-icon></button></div>',2),ge=u('<div class="w-full shrink-0 overflow-x-auto flex gap-4 m-4"></div> <div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"></div>',1),fe=u('<main class="h-screen flex flex-col"><!> <div class="w-full h-full flex flex-col overflow-hidden bg-base-300"><!></div></main>');function Ae(m,s){tt(s,!0);let p={records:{},selectedKey:""},t=ft(p.records),g=wt(ft(p.selectedKey));function o(r){const x=r.target;Array.from(x.files||[]).forEach(w=>{const P=new FileReader;P.onload=K=>{var j;const z=((j=K.target)==null?void 0:j.result)??"";t[w.name]=st(z),Y(g,w.name,!0)},P.readAsText(w)}),x&&(x.value="")}function _(){navigator.clipboard.readText().then(r=>{const x="Clipboard"+new Date().toISOString();t[x]=st(r),Y(g,x)}).catch(r=>{console.error("Error reading clipboard:",r)})}function v(r){delete t[r],Y(g,Object.keys(t)[0]||"",!0)}async function E(r,x){try{const w=await(await fetch(r)).text();t[x]=st(w),Y(g,x,!0)}catch(b){console.error("Error loading asset log:",b)}}var y=fe();Tt(r=>{Ot.title="aiwolf-nlp-viewer"});var C=c(y);_e(C,{loadAssetLog:E,loadClipboardLog:_,handleFileSelect:o});var T=i(C,2),V=c(T);{var f=r=>{var x=ge(),b=lt(x);q(b,21,()=>Object.entries(t),H,(P,K)=>{let z=()=>h(K)[0];var j=ue(),G=c(j);let Q;G.__click=[de,g,z];var ot=c(G,!0);n(G);var J=i(G,2);J.__click=[ve,v,z];var it=c(J);O(it,"icon","mdi:close"),n(J),n(j),D(at=>{Q=ct(G,1,"btn",null,Q,at),F(ot,z())},[()=>({"btn-active":h(g)===z()})]),d(P,j)}),n(b);var w=i(b,2);q(w,21,()=>Object.entries(t[h(g)]),H,(P,K)=>{let z=()=>h(K)[0],j=()=>h(K)[1];se(P,{get dayIdx(){return z()},get dayStatus(){return j()}})}),n(w),d(r,x)};N(V,r=>{Object.keys(t).length>0&&r(f)})}n(T),n(y),d(m,y),et()}pt(["click"]);export{Ae as component};
