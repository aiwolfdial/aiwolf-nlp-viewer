import{t as v,a as s,c as ct,d as bt}from"../chunks/D0Zzml86.js";import{p as Q,c as n,r,t as R,a as X,f as at,g as y,o as kt,s as o,aI as Z,aG as Lt,d as $,$ as Et}from"../chunks/heac-MY7.js";import{s as N,d as dt}from"../chunks/xyDVIoIJ.js";import{i as w}from"../chunks/BNXQp2IV.js";import{e as K,i as q}from"../chunks/BglFDjV7.js";import{h as wt}from"../chunks/CGmxII_f.js";import{s as L}from"../chunks/CTFTRwRb.js";import{I as At,s as H,c as Tt,R as Ot,t as rt,a as Ut,S as Vt,b as St,T as Rt}from"../chunks/C4llEPa_.js";import{p as B}from"../chunks/BYmUdosK.js";/* empty css                */import{p as J}from"../chunks/B1eMicas.js";import{_ as D}from"../chunks/C1FmrZbK.js";import{b as Ct}from"../chunks/Bj6oyPLr.js";function vt(m){const g=m.split(/\r?\n/).filter(a=>a.trim()),p={};return g.forEach(a=>{const[l,_,...i]=a.split(",");p[l]||(p[l]=Dt()),Mt(p[l],_,i)}),p}function Dt(){return{agents:{},talks:[],votes:[],execution:null,divine:null,attackVotes:[],attack:null,result:null}}function Mt(m,g,p){const l={status:([_,i,f,b])=>{m.agents[_]={role:i,status:f,name:b}},talk:([_,i,f,b])=>{m.talks.push({talkIdx:_,turnIdx:i,agentIdx:f,text:b})},vote:([_,i])=>{m.votes.push({agentIdx:_,targetIdx:i})},execute:([_,i])=>{m.execution={agentIdx:_,role:i}},divine:([_,i,f])=>{m.divine={agentIdx:_,targetIdx:i,result:f}},attackVote:([_,i])=>{m.attackVotes.push({agentIdx:_,targetIdx:i})},attack:([_,i])=>{m.attack={targetIdx:_,isSuccessful:i==="true"}},result:([_,i,f])=>{m.result={villagers:_,werewolves:i,winSide:f}}}[g];l&&l(p)}var jt=v("<strong> </strong>");function M(m,g){Q(g,!0);let p=J(g,"agentIdx",3,""),a=J(g,"highlight",3,!1);var l=jt(),_=n(l,!0);r(l),R((i,f)=>{H(l,Tt(i),"svelte-dj3b7l"),N(_,f)},[()=>a()?"agent"+p().padStart(2,"0"):"",()=>At(p())]),s(m,l),X()}function zt(m,g){Q(g,!0);let p=J(g,"text",3,"");function a(i){const f=/Agent\[(\d+)\]/g,b=[];let T=0,O;for(;(O=f.exec(i))!==null;)O.index>T&&b.push({text:i.slice(T,O.index),agentIdx:null,isAgentTag:!1}),b.push({text:O[0],agentIdx:parseInt(O[1]),isAgentTag:!0}),T=f.lastIndex;if(T<i.length){var E=i.slice(T);Object.entries(Ot).forEach(([d,u])=>{E=E.replaceAll(d,u)}),b.push({text:E,agentIdx:null,isAgentTag:!1})}return{parts:b}}var l=ct(),_=at(l);K(_,17,()=>a(p()).parts,q,(i,f)=>{var b=ct(),T=at(b);{var O=d=>{const u=kt(()=>{var x;return((x=y(f).agentIdx)==null?void 0:x.toString())??""});M(d,{get agentIdx(){return y(u)},highlight:!0})},E=d=>{var u=bt();R(()=>N(u,y(f).text)),s(d,u)};w(T,d=>{y(f).isAgentTag?d(O):d(E,!1)})}s(i,b)}),s(m,l),X()}var Pt=v("<iconify-icon></iconify-icon>",2),Nt=v("<iconify-icon></iconify-icon>",2),Ft=v("<iconify-icon></iconify-icon>",2),Kt=v("<iconify-icon></iconify-icon>",2),qt=v("<iconify-icon></iconify-icon>",2),Gt=v("<iconify-icon></iconify-icon>",2),Wt=v("<iconify-icon></iconify-icon>",2),Bt=v("<li><!> </li>"),Ht=v('<div><h3 class="text-lg font-bold my-2">エージェント</h3> <ul></ul></div>'),Jt=v("<li><!> <!></li>"),Qt=v('<div><h3 class="text-lg font-bold my-2">会話</h3> <ul></ul></div>'),Xt=v("<li><!> が <!> に投票</li>"),Yt=v('<div><h3 class="text-lg font-bold my-2">投票</h3> <ul></ul></div>'),Zt=v('<div><h3 class="text-lg font-bold my-2">追放</h3> <p><!> を追放</p></div>'),$t=v("<li><!> が <!> に投票</li>"),te=v('<div><h3 class="text-lg font-bold my-2">襲撃投票</h3> <ul></ul></div>'),ee=v("<p><!> を襲撃: <strong> </strong></p>"),ae=v("<p>襲撃対象なし</p>"),re=v('<div><h3 class="text-lg font-bold my-2">襲撃</h3> <!></div>'),oe=v('<div><h3 class="text-lg font-bold my-2">占い</h3> <p><!> が <!> を占い: <strong> </strong></p></div>'),ie=v('<div><h3 class="text-lg font-bold my-2">結果</h3> <p><strong> </strong> が勝利</p></div>'),ne=v('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><h2 class="text-xl font-bold pb-2"> <!> <!> <!> <!> <!> <!> <!></h2> <div class="grow overflow-y-auto pr-4"><!> <!> <!> <!> <!> <!> <!> <!></div></div></div>');function se(m,g){Q(g,!0);let p=J(g,"dayIdx",3,""),a=J(g,"dayStatus",19,()=>({}));var l=ne(),_=n(l),i=n(_),f=n(i),b=o(f);{var T=t=>{var e=Pt();L(e,"inline",!0),L(e,"icon","mdi:conversation"),s(t,e)};w(b,t=>{a().talks.length>0&&t(T)})}var O=o(b,2);{var E=t=>{var e=Nt();L(e,"inline",!0),L(e,"icon","mdi:vote"),s(t,e)};w(O,t=>{a().votes.length>0&&t(E)})}var d=o(O,2);{var u=t=>{var e=Ft();L(e,"inline",!0),L(e,"icon","mdi:account-remove"),s(t,e)};w(d,t=>{a().execution&&t(u)})}var x=o(d,2);{var S=t=>{var e=Kt();L(e,"inline",!0),L(e,"icon","mdi:vote"),s(t,e)};w(x,t=>{a().attackVotes.length>0&&t(S)})}var V=o(x,2);{var F=t=>{var e=qt();L(e,"inline",!0),L(e,"icon","mdi:sword"),s(t,e)};w(V,t=>{a().attack&&t(F)})}var P=o(V,2);{var j=t=>{var e=Gt();L(e,"inline",!0),L(e,"icon","mdi:account-eye"),s(t,e)};w(P,t=>{a().divine&&t(j)})}var z=o(P,2);{var G=t=>{var e=Wt();L(e,"inline",!0),L(e,"icon","mdi:trophy"),s(t,e)};w(z,t=>{a().result&&t(G)})}r(i);var Y=o(i,2),W=n(Y);{var tt=t=>{var e=Ht(),h=o(n(e),2);K(h,21,()=>Object.entries(a().agents),q,(A,I)=>{let c=()=>y(I)[0],k=()=>y(I)[1];var U=Bt(),C=n(U);M(C,{get agentIdx(){return c()}});var et=o(C);r(U),R(yt=>{H(U,`${yt??""} svelte-1xvg87g`),rt(U,"opacity-25",k().status!=="ALIVE"),N(et,` ${Ut[k().role]??"NULL"} -
                ${Vt[k().status]??"NULL"}`)},[()=>"p-2 my-2 border-4 rounded-md agent"+c().padStart(2,"0")]),s(A,U)}),r(h),r(e),s(t,e)};w(W,t=>{Object.keys(a().agents).length>0&&t(tt)})}var ot=o(W,2);{var ut=t=>{var e=Qt(),h=o(n(e),2);K(h,21,()=>a().talks,q,(A,I)=>{var c=Jt(),k=n(c);M(k,{get agentIdx(){return y(I).agentIdx}});var U=o(k,2);zt(U,{get text(){return y(I).text}}),r(c),R(C=>{H(c,`${C??""} svelte-1xvg87g`),rt(c,"opacity-25",y(I).text==="Over")},[()=>"p-2 my-2 border-4 rounded-md agent"+y(I).agentIdx.padStart(2,"0")]),s(A,c)}),r(h),r(e),s(t,e)};w(ot,t=>{a().talks.length>0&&t(ut)})}var it=o(ot,2);{var gt=t=>{var e=Yt(),h=o(n(e),2);K(h,21,()=>a().votes,q,(A,I)=>{var c=Xt(),k=n(c);M(k,{get agentIdx(){return y(I).agentIdx}});var U=o(k,2);M(U,{get agentIdx(){return y(I).targetIdx},highlight:!0}),Z(),r(c),R(C=>H(c,`${C??""} svelte-1xvg87g`),[()=>"p-2 my-2 border-4 rounded-md agent"+y(I).agentIdx.padStart(2,"0")]),s(A,c)}),r(h),r(e),s(t,e)};w(it,t=>{a().votes.length>0&&t(gt)})}var nt=o(it,2);{var ft=t=>{var e=Zt(),h=o(n(e),2),A=n(h);M(A,{get agentIdx(){return a().execution.agentIdx},highlight:!0}),Z(),r(h),r(e),s(t,e)};w(nt,t=>{a().execution&&t(ft)})}var st=o(nt,2);{var pt=t=>{var e=te(),h=o(n(e),2);K(h,21,()=>a().attackVotes,q,(A,I)=>{var c=$t(),k=n(c);M(k,{get agentIdx(){return y(I).agentIdx}});var U=o(k,2);M(U,{get agentIdx(){return y(I).targetIdx},highlight:!0}),Z(),r(c),R(C=>H(c,`${C??""} svelte-1xvg87g`),[()=>"p-2 my-2 border-4 rounded-md agent"+y(I).agentIdx.padStart(2,"0")]),s(A,c)}),r(h),r(e),s(t,e)};w(st,t=>{a().attackVotes.length>0&&t(pt)})}var lt=o(st,2);{var xt=t=>{var e=re(),h=o(n(e),2);{var A=c=>{var k=ee(),U=n(k);M(U,{get agentIdx(){return a().attack.targetIdx},highlight:!0});var C=o(U,2),et=n(C,!0);r(C),r(k),R(()=>N(et,a().attack.isSuccessful?"成功":"失敗")),s(c,k)},I=c=>{var k=ae();s(c,k)};w(h,c=>{a().attack.targetIdx!=="-1"?c(A):c(I,!1)})}r(e),s(t,e)};w(lt,t=>{a().attack&&t(xt)})}var _t=o(lt,2);{var mt=t=>{var e=oe(),h=o(n(e),2),A=n(h);M(A,{get agentIdx(){return a().divine.agentIdx},highlight:!0});var I=o(A,2);M(I,{get agentIdx(){return a().divine.targetIdx},highlight:!0});var c=o(I,2),k=n(c,!0);r(c),r(h),r(e),R(()=>N(k,St[a().divine.result]??"NULL")),s(t,e)};w(_t,t=>{a().divine&&t(mt)})}var ht=o(_t,2);{var It=t=>{var e=ie(),h=o(n(e),2),A=n(h),I=n(A,!0);r(A),Z(),r(h),r(e),R(()=>N(I,Rt[a().result.winSide])),s(t,e)};w(ht,t=>{a().result&&t(It)})}r(Y),r(_),r(l),R(()=>N(f,`Day ${p()??""} `)),s(m,l),X()}var le=v("<option> </option>"),_e=v('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><h1 class="text-3xl font-bold text-nowrap ml-2">aiwolf-nlp-viewer</h1> <select class="select min-w-3xs w-3xs ml-auto"><option>サンプルログを選択</option><!></select> <input class="file-input min-w-3xs w-3xs" type="file" accept=".log" multiple> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function ce(m,g){Q(g,!0);const p=Object.entries(Object.assign({"/static/assets/1734125235_kanolab_Mille_UEC-IL_sUper_IL_satozaki.log":()=>D(()=>import("../chunks/uLwNvvUb.js"),[],import.meta.url),"/static/assets/1734126573_Mille_kanolab_sUper_IL_satozaki_UEC-IL.log":()=>D(()=>import("../chunks/cHV5Ilpp.js"),[],import.meta.url),"/static/assets/1734322165_satozaki_Mille_sUper_IL_kanolab_barneko.log":()=>D(()=>import("../chunks/KsaoEMQt.js"),[],import.meta.url),"/static/assets/1734322532_barneko_Mille_satozaki_kanolab_sUper_IL.log":()=>D(()=>import("../chunks/Cu7J-Cma.js"),[],import.meta.url),"/static/assets/1734328995_CanisLupus_barneko_Mille_satozaki_sUper_IL.log":()=>D(()=>import("../chunks/JpfJ7G0g.js"),[],import.meta.url),"/static/assets/1734329414_Mille_UEC-IL_kanolab_CanisLupus_satozaki.log":()=>D(()=>import("../chunks/CH1amTOw.js"),[],import.meta.url),"/static/assets/1734329757_UEC-IL_sUper_IL_barneko_CanisLupus_satozaki.log":()=>D(()=>import("../chunks/BCiIyikN.js"),[],import.meta.url),"/static/assets/1734335625_satozaki_CanisLupus_UEC-IL_sUper_IL_barneko.log":()=>D(()=>import("../chunks/Cx4MDn7u.js"),[],import.meta.url),"/static/assets/1734336483_Mille_barneko_sUper_IL_satozaki_UEC-IL.log":()=>D(()=>import("../chunks/F010eNko.js"),[],import.meta.url),"/static/assets/1734336998_sUper_IL_satozaki_CanisLupus_kanolab_Mille.log":()=>D(()=>import("../chunks/BrcFOvsV.js"),[],import.meta.url),"/static/assets/1734339025_Mille_kanolab_CanisLupus_sUper_IL_satozaki.log":()=>D(()=>import("../chunks/CbqCXvao.js"),[],import.meta.url)})).reduce((E,[d,u])=>{const x=d.split("/").pop()||"";return{...E,[x]:`${Ct}${d.replace("/static","")}`}},{});var a=_e(),l=o(n(a),2);l.__change=E=>{const d=E.currentTarget.value;d&&(g.loadAssetLog(p[d],d),E.currentTarget.value="")};var _=n(l);_.value=((_.__value="")==null,"");var i=o(_);K(i,17,()=>Object.entries(p),q,(E,d)=>{let u=()=>y(d)[0];var x=le(),S={},V=n(x,!0);r(x),R(()=>{S!==(S=u())&&(x.value=(x.__value=u())==null?"":u()),N(V,u())}),s(E,x)}),r(l);var f=o(l,2);f.__change=function(...E){var d;(d=g.handleFileSelect)==null||d.apply(this,E)};var b=o(f,2),T=n(b);L(T,"inline",!0),L(T,"icon","mdi:white-balance-sunny");var O=o(T,4);L(O,"inline",!0),L(O,"icon","mdi:moon-and-stars"),r(b),r(a),s(m,a),X()}dt(["change"]);var ve=(m,g,p)=>$(g,B(p())),de=(m,g,p)=>g(p()),ue=v('<div class="w-fit shrink-0 flex gap-0"><button class="btn"> </button> <button class="btn btn-error btn-square" aria-label="Close tab"><iconify-icon></iconify-icon></button></div>',2),ge=v('<div class="w-full shrink-0 overflow-x-auto flex gap-4 m-4"></div> <div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"></div>',1),fe=v('<main class="h-screen flex flex-col"><!> <div class="w-full h-full flex flex-col overflow-hidden bg-base-300"><!></div></main>');function Oe(m,g){Q(g,!0);let p={records:{},selectedKey:""},a=B(p.records),l=Lt(B(p.selectedKey));function _(u){const x=u.target;Array.from(x.files||[]).forEach(V=>{const F=new FileReader;F.onload=P=>{var z;const j=((z=P.target)==null?void 0:z.result)??"";a[V.name]=vt(j),$(l,B(V.name))},F.readAsText(V)}),x&&(x.value="")}function i(u){delete a[u],$(l,B(Object.keys(a)[0]||""))}async function f(u,x){try{const V=await(await fetch(u)).text();a[x]=vt(V),$(l,B(x))}catch(S){console.error("Error loading asset log:",S)}}var b=fe();wt(u=>{Et.title="aiwolf-nlp-viewer"});var T=n(b);ce(T,{loadAssetLog:f,handleFileSelect:_});var O=o(T,2),E=n(O);{var d=u=>{var x=ge(),S=at(x);K(S,21,()=>Object.entries(a),q,(F,P)=>{let j=()=>y(P)[0];var z=ue(),G=n(z);G.__click=[ve,l,j];var Y=n(G,!0);r(G);var W=o(G,2);W.__click=[de,i,j];var tt=n(W);L(tt,"icon","mdi:close"),r(W),r(z),R(()=>{rt(G,"btn-active",y(l)===j()),N(Y,j())}),s(F,z)}),r(S);var V=o(S,2);K(V,21,()=>Object.entries(a[y(l)]),q,(F,P)=>{let j=()=>y(P)[0],z=()=>y(P)[1];se(F,{get dayIdx(){return j()},get dayStatus(){return z()}})}),r(V),s(u,x)};w(E,u=>{Object.keys(a).length>0&&u(d)})}r(O),r(b),s(m,b),X()}dt(["click"]);export{Oe as component};
