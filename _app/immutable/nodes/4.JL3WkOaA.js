import{t as v,a as l,c as ct,d as kt}from"../chunks/Dhw87SHn.js";import{p as X,c as n,r as i,t as R,a as Y,f as it,g as I,aG as Lt,s as r,aH as tt,ae as vt,aE as Et,d as et,$ as wt}from"../chunks/BOtI2AQT.js";import{s as F,d as ut}from"../chunks/rIR5awjR.js";import{i as E}from"../chunks/DOjvVc5q.js";import{e as K,i as q}from"../chunks/DglHXIJX.js";import{h as At}from"../chunks/uGJCHHHe.js";import{s as L}from"../chunks/bp46B8nJ.js";import{c as Tt,s as W}from"../chunks/BeOeQHln.js";/* empty css                */import{p as Q}from"../chunks/Dy5eO49_.js";import{I as Ot,R as Ut,a as Vt,S as St,b as Rt,T as Ct}from"../chunks/B66Uxdae.js";import{_ as D}from"../chunks/C1FmrZbK.js";import{b as Dt}from"../chunks/Cc3peBMt.js";function dt(p){const u=p.split(/\r?\n/).filter(a=>a.trim()),f={};return u.forEach(a=>{const[_,c,...o]=a.split(",");f[_]||(f[_]=Mt()),jt(f[_],c,o)}),f}function Mt(){return{agents:{},talks:[],votes:[],execution:null,divine:null,attackVotes:[],attack:null,result:null}}function jt(p,u,f){const _={status:([c,o,g,y])=>{p.agents[c]={role:o,status:g,name:y}},talk:([c,o,g,y])=>{p.talks.push({talkIdx:c,turnIdx:o,agentIdx:g,text:y})},vote:([c,o])=>{p.votes.push({agentIdx:c,targetIdx:o})},execute:([c,o])=>{p.execution={agentIdx:c,role:o}},divine:([c,o,g])=>{p.divine={agentIdx:c,targetIdx:o,result:g}},attackVote:([c,o])=>{p.attackVotes.push({agentIdx:c,targetIdx:o})},attack:([c,o])=>{p.attack={targetIdx:c,isSuccessful:o==="true"}},result:([c,o,g])=>{p.result={villagers:c,werewolves:o,winSide:g}}}[u];_&&_(f)}var zt=v("<strong> </strong>");function M(p,u){X(u,!0);let f=Q(u,"agentIdx",3,""),a=Q(u,"highlight",3,!1);var _=zt(),c=n(_,!0);i(_),R((o,g)=>{W(_,1,o,"svelte-dj3b7l"),F(c,g)},[()=>Tt(a()?"agent"+f().padStart(2,"0"):""),()=>Ot(f())]),l(p,_),Y()}function Pt(p,u){X(u,!0);let f=Q(u,"text",3,"");function a(o){const g=/Agent\[(\d+)\]/g,y=[];let T=0,O;for(;(O=g.exec(o))!==null;)O.index>T&&y.push({text:o.slice(T,O.index),agentIdx:null,isAgentTag:!1}),y.push({text:O[0],agentIdx:parseInt(O[1]),isAgentTag:!0}),T=g.lastIndex;if(T<o.length){var S=o.slice(T);Object.entries(Ut).forEach(([x,s])=>{S=S.replaceAll(x,s)}),y.push({text:S,agentIdx:null,isAgentTag:!1})}return{parts:y}}var _=ct(),c=it(_);K(c,17,()=>a(f()).parts,q,(o,g)=>{var y=ct(),T=it(y);{var O=x=>{const s=Lt(()=>{var b;return((b=I(g).agentIdx)==null?void 0:b.toString())??""});M(x,{get agentIdx(){return I(s)},highlight:!0})},S=x=>{var s=kt();R(()=>F(s,I(g).text)),l(x,s)};E(T,x=>{I(g).isAgentTag?x(O):x(S,!1)})}l(o,y)}),l(p,_),Y()}var Nt=v("<iconify-icon></iconify-icon>",2),Ft=v("<iconify-icon></iconify-icon>",2),Kt=v("<iconify-icon></iconify-icon>",2),qt=v("<iconify-icon></iconify-icon>",2),Gt=v("<iconify-icon></iconify-icon>",2),Ht=v("<iconify-icon></iconify-icon>",2),Wt=v("<iconify-icon></iconify-icon>",2),Bt=v("<li><!> </li>"),Jt=v('<div><h3 class="text-lg font-bold my-2">エージェント</h3> <ul></ul></div>'),Qt=v("<li><!> <!></li>"),Xt=v('<div><h3 class="text-lg font-bold my-2">会話</h3> <ul></ul></div>'),Yt=v("<li><!> が <!> に投票</li>"),Zt=v('<div><h3 class="text-lg font-bold my-2">投票</h3> <ul></ul></div>'),$t=v('<div><h3 class="text-lg font-bold my-2">追放</h3> <p><!> を追放</p></div>'),te=v("<li><!> が <!> に投票</li>"),ee=v('<div><h3 class="text-lg font-bold my-2">襲撃投票</h3> <ul></ul></div>'),ae=v("<p><!> を襲撃: <strong> </strong></p>"),re=v("<p>襲撃対象なし</p>"),ie=v('<div><h3 class="text-lg font-bold my-2">襲撃</h3> <!></div>'),oe=v('<div><h3 class="text-lg font-bold my-2">占い</h3> <p><!> が <!> を占い: <strong> </strong></p></div>'),ne=v('<div><h3 class="text-lg font-bold my-2">結果</h3> <p><strong> </strong> が勝利</p></div>'),se=v('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><h2 class="text-xl font-bold pb-2"> <!> <!> <!> <!> <!> <!> <!></h2> <div class="grow overflow-y-auto pr-4"><!> <!> <!> <!> <!> <!> <!> <!></div></div></div>');function le(p,u){X(u,!0);let f=Q(u,"dayIdx",3,""),a=Q(u,"dayStatus",19,()=>({}));var _=se(),c=n(_),o=n(c),g=n(o),y=r(g);{var T=t=>{var e=Nt();L(e,"inline",!0),L(e,"icon","mdi:conversation"),l(t,e)};E(y,t=>{a().talks.length>0&&t(T)})}var O=r(y,2);{var S=t=>{var e=Ft();L(e,"inline",!0),L(e,"icon","mdi:vote"),l(t,e)};E(O,t=>{a().votes.length>0&&t(S)})}var x=r(O,2);{var s=t=>{var e=Kt();L(e,"inline",!0),L(e,"icon","mdi:account-remove"),l(t,e)};E(x,t=>{a().execution&&t(s)})}var b=r(x,2);{var w=t=>{var e=qt();L(e,"inline",!0),L(e,"icon","mdi:vote"),l(t,e)};E(b,t=>{a().attackVotes.length>0&&t(w)})}var U=r(b,2);{var j=t=>{var e=Gt();L(e,"inline",!0),L(e,"icon","mdi:sword"),l(t,e)};E(U,t=>{a().attack&&t(j)})}var N=r(U,2);{var z=t=>{var e=Ht();L(e,"inline",!0),L(e,"icon","mdi:account-eye"),l(t,e)};E(N,t=>{a().divine&&t(z)})}var P=r(N,2);{var G=t=>{var e=Wt();L(e,"inline",!0),L(e,"icon","mdi:trophy"),l(t,e)};E(P,t=>{a().result&&t(G)})}i(o);var B=r(o,2),Z=n(B);{var J=t=>{var e=Jt(),m=r(n(e),2);K(m,21,()=>Object.entries(a().agents),q,(A,h)=>{let d=()=>I(h)[0],k=()=>I(h)[1];var V=Bt();let C;var H=n(V);M(H,{get agentIdx(){return d()}});var rt=r(H);i(V),R((yt,bt)=>{C=W(V,1,yt,"svelte-1xvg87g",C,bt),F(rt,` ${Vt[k().role]??"NULL"} -
                ${St[k().status]??"NULL"}`)},[()=>"p-2 my-2 border-4 rounded-md agent"+d().padStart(2,"0"),()=>({"opacity-25":k().status!=="ALIVE"})]),l(A,V)}),i(m),i(e),l(t,e)};E(Z,t=>{Object.keys(a().agents).length>0&&t(J)})}var $=r(Z,2);{var at=t=>{var e=Xt(),m=r(n(e),2);K(m,21,()=>a().talks,q,(A,h)=>{var d=Qt();let k;var V=n(d);M(V,{get agentIdx(){return I(h).agentIdx}});var C=r(V,2);Pt(C,{get text(){return I(h).text}}),i(d),R((H,rt)=>k=W(d,1,H,"svelte-1xvg87g",k,rt),[()=>"p-2 my-2 border-4 rounded-md agent"+I(h).agentIdx.padStart(2,"0"),()=>({"opacity-25":I(h).text==="Over"})]),l(A,d)}),i(m),i(e),l(t,e)};E($,t=>{a().talks.length>0&&t(at)})}var ot=r($,2);{var gt=t=>{var e=Zt(),m=r(n(e),2);K(m,21,()=>a().votes,q,(A,h)=>{var d=Yt(),k=n(d);M(k,{get agentIdx(){return I(h).agentIdx}});var V=r(k,2);M(V,{get agentIdx(){return I(h).targetIdx},highlight:!0}),tt(),i(d),R(C=>W(d,1,C,"svelte-1xvg87g"),[()=>"p-2 my-2 border-4 rounded-md agent"+I(h).agentIdx.padStart(2,"0")]),l(A,d)}),i(m),i(e),l(t,e)};E(ot,t=>{a().votes.length>0&&t(gt)})}var nt=r(ot,2);{var ft=t=>{var e=$t(),m=r(n(e),2),A=n(m);M(A,{get agentIdx(){return a().execution.agentIdx},highlight:!0}),tt(),i(m),i(e),l(t,e)};E(nt,t=>{a().execution&&t(ft)})}var st=r(nt,2);{var pt=t=>{var e=ee(),m=r(n(e),2);K(m,21,()=>a().attackVotes,q,(A,h)=>{var d=te(),k=n(d);M(k,{get agentIdx(){return I(h).agentIdx}});var V=r(k,2);M(V,{get agentIdx(){return I(h).targetIdx},highlight:!0}),tt(),i(d),R(C=>W(d,1,C,"svelte-1xvg87g"),[()=>"p-2 my-2 border-4 rounded-md agent"+I(h).agentIdx.padStart(2,"0")]),l(A,d)}),i(m),i(e),l(t,e)};E(st,t=>{a().attackVotes.length>0&&t(pt)})}var lt=r(st,2);{var xt=t=>{var e=ie(),m=r(n(e),2);{var A=d=>{var k=ae(),V=n(k);M(V,{get agentIdx(){return a().attack.targetIdx},highlight:!0});var C=r(V,2),H=n(C,!0);i(C),i(k),R(()=>F(H,a().attack.isSuccessful?"成功":"失敗")),l(d,k)},h=d=>{var k=re();l(d,k)};E(m,d=>{a().attack.targetIdx!=="-1"?d(A):d(h,!1)})}i(e),l(t,e)};E(lt,t=>{a().attack&&t(xt)})}var _t=r(lt,2);{var mt=t=>{var e=oe(),m=r(n(e),2),A=n(m);M(A,{get agentIdx(){return a().divine.agentIdx},highlight:!0});var h=r(A,2);M(h,{get agentIdx(){return a().divine.targetIdx},highlight:!0});var d=r(h,2),k=n(d,!0);i(d),i(m),i(e),R(()=>F(k,Rt[a().divine.result]??"NULL")),l(t,e)};E(_t,t=>{a().divine&&t(mt)})}var ht=r(_t,2);{var It=t=>{var e=ne(),m=r(n(e),2),A=n(m),h=n(A,!0);i(A),tt(),i(m),i(e),R(()=>F(h,Ct[a().result.winSide])),l(t,e)};E(ht,t=>{a().result&&t(It)})}i(B),i(c),i(_),R(()=>F(g,`Day ${f()??""} `)),l(p,_),Y()}var _e=v("<option> </option>"),ce=v('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./">aiwolf-nlp-viewer</a> <select class="select min-w-3xs w-3xs ml-auto"><option>サンプルログを選択</option><!></select> <input class="file-input min-w-3xs w-3xs" type="file" accept=".log" multiple> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function ve(p,u){X(u,!0);const f=Object.entries(Object.assign({"/static/assets/1734125235_kanolab_Mille_UEC-IL_sUper_IL_satozaki.log":()=>D(()=>import("../chunks/CxPUTjnS.js"),[],import.meta.url),"/static/assets/1734126573_Mille_kanolab_sUper_IL_satozaki_UEC-IL.log":()=>D(()=>import("../chunks/Ch4hCXju.js"),[],import.meta.url),"/static/assets/1734322165_satozaki_Mille_sUper_IL_kanolab_barneko.log":()=>D(()=>import("../chunks/D6Ada88o.js"),[],import.meta.url),"/static/assets/1734322532_barneko_Mille_satozaki_kanolab_sUper_IL.log":()=>D(()=>import("../chunks/BmNzAw4g.js"),[],import.meta.url),"/static/assets/1734328995_CanisLupus_barneko_Mille_satozaki_sUper_IL.log":()=>D(()=>import("../chunks/Dh5zF3NH.js"),[],import.meta.url),"/static/assets/1734329414_Mille_UEC-IL_kanolab_CanisLupus_satozaki.log":()=>D(()=>import("../chunks/B-nbrCmY.js"),[],import.meta.url),"/static/assets/1734329757_UEC-IL_sUper_IL_barneko_CanisLupus_satozaki.log":()=>D(()=>import("../chunks/CZBC5jrw.js"),[],import.meta.url),"/static/assets/1734335625_satozaki_CanisLupus_UEC-IL_sUper_IL_barneko.log":()=>D(()=>import("../chunks/JWZkbpfe.js"),[],import.meta.url),"/static/assets/1734336483_Mille_barneko_sUper_IL_satozaki_UEC-IL.log":()=>D(()=>import("../chunks/gGfePD1C.js"),[],import.meta.url),"/static/assets/1734336998_sUper_IL_satozaki_CanisLupus_kanolab_Mille.log":()=>D(()=>import("../chunks/oHz1b7i6.js"),[],import.meta.url),"/static/assets/1734339025_Mille_kanolab_CanisLupus_sUper_IL_satozaki.log":()=>D(()=>import("../chunks/K60EV997.js"),[],import.meta.url)})).reduce((x,[s,b])=>{const w=s.split("/").pop()||"";return{...x,[w]:`${Dt}${s.replace("/static","")}`}},{});var a=ce(),_=r(n(a),2);_.__change=x=>{const s=x.currentTarget.value;s&&(u.loadAssetLog(f[s],s),x.currentTarget.value="")};var c=n(_);c.value=((c.__value="")==null,"");var o=r(c);K(o,17,()=>Object.entries(f),q,(x,s)=>{let b=()=>I(s)[0];var w=_e(),U={},j=n(w,!0);i(w),R(()=>{U!==(U=b())&&(w.value=(w.__value=b())==null?"":b()),F(j,b())}),l(x,w)}),i(_);var g=r(_,2);g.__change=function(...x){var s;(s=u.handleFileSelect)==null||s.apply(this,x)};var y=r(g,2),T=n(y);L(T,"inline",!0),L(T,"icon","mdi:white-balance-sunny");var O=r(T,2),S=r(O,2);L(S,"inline",!0),L(S,"icon","mdi:moon-and-stars"),i(y),i(a),l(p,a),Y()}ut(["change"]);var de=(p,u,f)=>et(u,f(),!0),ue=(p,u,f)=>u(f()),ge=v('<div class="w-fit shrink-0 flex gap-0"><button> </button> <button class="btn btn-error btn-square" aria-label="Close tab"><iconify-icon></iconify-icon></button></div>',2),fe=v('<div class="w-full shrink-0 overflow-x-auto flex gap-4 m-4"></div> <div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"></div>',1),pe=v('<main class="h-screen flex flex-col"><!> <div class="w-full h-full flex flex-col overflow-hidden bg-base-300"><!></div></main>');function Ue(p,u){X(u,!0);let f={records:{},selectedKey:""},a=vt(f.records),_=Et(vt(f.selectedKey));function c(s){const b=s.target;Array.from(b.files||[]).forEach(U=>{const j=new FileReader;j.onload=N=>{var P;const z=((P=N.target)==null?void 0:P.result)??"";a[U.name]=dt(z),et(_,U.name,!0)},j.readAsText(U)}),b&&(b.value="")}function o(s){delete a[s],et(_,Object.keys(a)[0]||"",!0)}async function g(s,b){try{const U=await(await fetch(s)).text();a[b]=dt(U),et(_,b,!0)}catch(w){console.error("Error loading asset log:",w)}}var y=pe();At(s=>{wt.title="aiwolf-nlp-viewer"});var T=n(y);ve(T,{loadAssetLog:g,handleFileSelect:c});var O=r(T,2),S=n(O);{var x=s=>{var b=fe(),w=it(b);K(w,21,()=>Object.entries(a),q,(j,N)=>{let z=()=>I(N)[0];var P=ge(),G=n(P);let B;G.__click=[de,_,z];var Z=n(G,!0);i(G);var J=r(G,2);J.__click=[ue,o,z];var $=n(J);L($,"icon","mdi:close"),i(J),i(P),R(at=>{B=W(G,1,"btn",null,B,at),F(Z,z())},[()=>({"btn-active":I(_)===z()})]),l(j,P)}),i(w);var U=r(w,2);K(U,21,()=>Object.entries(a[I(_)]),q,(j,N)=>{let z=()=>I(N)[0],P=()=>I(N)[1];le(j,{get dayIdx(){return z()},get dayStatus(){return P()}})}),i(U),l(s,b)};E(S,s=>{Object.keys(a).length>0&&s(x)})}i(O),i(y),l(p,y),Y()}ut(["click"]);export{Ue as component};
