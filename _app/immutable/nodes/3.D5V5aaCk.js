var vt=Object.defineProperty;var ut=(t,e,i)=>e in t?vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var Je=(t,e,i)=>ut(t,typeof e!="symbol"?e+"":e,i);import{t as _,a as l,c as ge}from"../chunks/Dhw87SHn.js";import{e as Ke,u as _t,p as Ee,aE as ne,aG as Oe,j as ft,d as B,g as n,c as a,r,a as De,f as z,s as o,aH as _e,t as G,ae as Ae,$ as dt}from"../chunks/BOtI2AQT.js";import{h as gt}from"../chunks/uGJCHHHe.js";import{i as j}from"../chunks/DOjvVc5q.js";import{o as He,a as je}from"../chunks/BzesmMMy.js";import{p as xt}from"../chunks/MifH9n0i.js";import{w as lt}from"../chunks/CVZ_vLBR.js";import{a as le,s as Ce,b as Ie,c as Se,d as ke,e as Le,f as Pe,S as he,D as Ue,g as mt}from"../chunks/Cguwj11f.js";/* empty css                */import{d as ct,s as m}from"../chunks/rIR5awjR.js";import{e as fe,i as de}from"../chunks/DglHXIJX.js";import{r as ye,s as oe,a as me,c as Ne,d as We}from"../chunks/bp46B8nJ.js";import{b as Xe}from"../chunks/C-B37evS.js";import{b as Ze}from"../chunks/Dbazzlnb.js";import{s as Ge}from"../chunks/BeOeQHln.js";import{b as Ye}from"../chunks/Ba7hT1Ku.js";function $e(t,e,i){Ke(()=>{var c=_t(()=>e(t,i==null?void 0:i())||{});if(c!=null&&c.destroy)return()=>c.destroy()})}class Be{static fromJson(e){return ht(JSON.parse(e),qe("AgentSettings"))}static toJson(e){return JSON.stringify(yt(e,qe("AgentSettings")),null,2)}}function pe(t,e,i,c=""){const V=ze(t),Q=c?` on ${c}`:"",ae=i?` for key "${i}"`:"";throw Error(`Invalid value${ae}${Q}. Expected ${V} but got ${JSON.stringify(e)}`)}function ze(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${ze(t[1])}`:`one of [${t.map(e=>ze(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function bt(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(i=>e[i.json]={key:i.js,typ:i.typ}),t.jsonToJS=e}return t.jsonToJS}function pt(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(i=>e[i.js]={key:i.json,typ:i.typ}),t.jsToJSON=e}return t.jsToJSON}function Te(t,e,i,c="",V=""){function Q(v,S){return typeof v==typeof S?S:pe(v,S,c,V)}function ae(v,S){const L=v.length;for(let f=0;f<L;f++){const d=v[f];try{return Te(S,d,i)}catch{}}return pe(v,S,c,V)}function te(v,S){return v.indexOf(S)!==-1?S:pe(v.map(L=>Fe(L)),S,c,V)}function F(v,S){return Array.isArray(S)?S.map(L=>Te(L,v,i)):pe(Fe("array"),S,c,V)}function y(v){if(v===null)return null;const S=new Date(v);return isNaN(S.valueOf())?pe(Fe("Date"),v,c,V):S}function w(v,S,L){if(L===null||typeof L!="object"||Array.isArray(L))return pe(Fe(q||"object"),L,c,V);const f={};return Object.getOwnPropertyNames(v).forEach(d=>{const p=v[d],W=Object.prototype.hasOwnProperty.call(L,d)?L[d]:void 0;f[p.key]=Te(W,p.typ,i,d,q)}),Object.getOwnPropertyNames(L).forEach(d=>{Object.prototype.hasOwnProperty.call(v,d)||(f[d]=Te(L[d],S,i,d,q))}),f}if(e==="any")return t;if(e===null)return t===null?t:pe(e,t,c,V);if(e===!1)return pe(e,t,c,V);let q;for(;typeof e=="object"&&e.ref!==void 0;)q=e.ref,e=At[e.ref];return Array.isArray(e)?te(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?ae(e.unionMembers,t):e.hasOwnProperty("arrayItems")?F(e.arrayItems,t):e.hasOwnProperty("props")?w(i(e),e.additional,t):pe(e,t,c,V):e===Date&&typeof t!="number"?y(t):Q(e,t)}function ht(t,e){return Te(t,e,bt)}function yt(t,e){return Te(t,e,pt)}function Fe(t){return{literal:t}}function Ve(t,e){return{props:t,additional:e}}function qe(t){return{ref:t}}const At={AgentSettings:Ve([{json:"connection",js:"connection",typ:qe("Connection")},{json:"team",js:"team",typ:""},{json:"display",js:"display",typ:qe("Display")}],!1),Connection:Ve([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1),Display:Ve([{json:"largeScale",js:"largeScale",typ:!0}],!1)},et={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}};function wt(){const t=localStorage.getItem("agent-settings");if(t)try{return Be.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",Be.toJson(et)),et}const be=lt(wt());be.subscribe(t=>{localStorage.setItem("agent-settings",Be.toJson(t))});function kt(){const{subscribe:t,update:e}=lt({status:"disconnected",deadline:null,entries:[],role:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let i=null,c=null,V=null,Q=null;be.subscribe(y=>{c=y});function ae(){i&&(i.close(),i=null,e(y=>({...y,status:"disconnected"}))),Q&&(Q.clear(),Q=null)}function te(){if(!c)return;i&&e(w=>({...w,status:"disconnected",deadline:null,entries:[],role:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]})),e(w=>({...w,status:"connecting"}));const y=new URL(c.connection.url);c.connection.token&&y.searchParams.set("token",c.connection.token),i=new WebSocket(y),i.onopen=()=>{e(w=>({...w,status:"connected"}))},i.onclose=()=>{ae()},i.onerror=()=>{ae()},i.onmessage=w=>{try{const q=Date.now(),v=JSON.parse(w.data);switch(e(S=>{const L=S.entries.slice();L.push(v);const f={...S,entries:L,request:v.request};if(v.info){if(f.info=v.info,v.info.medium_result){const d=v.info.medium_result;f.mediumResults.findIndex(p=>p.day===d.day&&p.agent===d.agent)<0&&f.mediumResults.push(v.info.medium_result)}if(v.info.divine_result){const d=v.info.divine_result;f.divineResults.findIndex(p=>p.day===d.day&&p.agent===d.agent)<0&&f.divineResults.push(v.info.divine_result)}v.info.executed_agent&&f.executedAgents.push(v.info.executed_agent),v.info.attacked_agent&&f.attackedAgents.push(v.info.attacked_agent)}return v.setting&&(f.setting=v.setting,V=v.setting.timeout.action),v.talk_history&&f.talkHistory.push(...v.talk_history),v.whisper_history&&f.whisperHistory.push(...v.whisper_history),v.request===le.INITIALIZE&&f.info&&f.info.role_map&&f.info.agent&&(f.role=f.info.role_map[f.info.agent]),f}),v.request){case le.NAME:F((c==null?void 0:c.team)||"viewer"+Math.floor(Math.random()*1e3));break;case le.TALK:case le.WHISPER:case le.VOTE:case le.DIVINE:case le.GUARD:case le.ATTACK:Q&&Q.clear(),Q=new It(()=>{F("TIMEOUT")},new Date(q+(V??6e4))),e(S=>({...S,deadline:(Q==null?void 0:Q.deadline())??null}));break;case le.FINISH:ae();break}}catch(q){console.error("Failed to parse message:",q)}}}function F(y){if(Q&&(Q.clear(),Q=null,e(w=>({...w,deadline:null}))),i&&i.readyState===WebSocket.OPEN)try{i.send(y),e(w=>{const q=w.entries.slice();return q.push(y),{...w,entries:q}})}catch(w){console.error("Failed to send message:",w)}}return{subscribe:t,connect:te,disconnect:ae,send:F}}const Re=kt();class It{constructor(e,i){Je(this,"timeout");Je(this,"_deadline");this.timeout=setTimeout(e,i.getTime()-new Date().getTime()),this._deadline=i}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var tt;(function(t){t[t.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",t[t.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",t[t.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",t[t.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",t[t.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",t[t.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",t[t.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",t[t.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",t[t.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",t[t.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",t[t.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",t[t.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",t[t.TAGS_START=917504]="TAGS_START",t[t.TAGS_END=917631]="TAGS_END",t[t.ZWJ=8205]="ZWJ"})(tt||(tt={}));const St=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var rt;function at(t){if(typeof t!="string")throw new TypeError("string cannot be undefined or null");const e=[];let i=0,c=0;for(;i<t.length;)c+=Tt(i+c,t),Mt(t[i+c])&&c++,Dt(t[i+c])&&c++,Nt(t[i+c])&&c++,Ct(t[i+c])?c++:(e.push(t.substring(i,i+c)),i+=c,c=0);return e}function Tt(t,e){const i=e[t];if(!Rt(i)||t===e.length-1)return 1;const c=i+e[t+1];let V=e.substring(t+2,t+5);return nt(c)&&nt(V)?4:Ot(c)&&jt(V)?e.slice(t).indexOf(String.fromCodePoint(917631))+2:Et(V)?4:2}function Rt(t){return t&&we(t[0].charCodeAt(0),55296,56319)}function nt(t){return we(Qe(t),127462,127487)}function Ot(t){return we(Qe(t),127988,127988)}function Et(t){return we(Qe(t),127995,127999)}function Dt(t){return typeof t=="string"&&we(t.charCodeAt(0),65024,65039)}function Nt(t){return typeof t=="string"&&we(t.charCodeAt(0),8400,8447)}function jt(t){const e=t.codePointAt(0);return typeof t=="string"&&typeof e=="number"&&we(e,917504,917631)}function Mt(t){return typeof t=="string"&&St.includes(t.charCodeAt(0))}function Ct(t){return typeof t=="string"&&t.charCodeAt(0)===8205}function Qe(t){return(t.charCodeAt(0)-55296<<10)+(t.charCodeAt(1)-56320)+65536}function we(t,e,i){return t>=e&&t<=i}(function(t){t[t.unit_1=1]="unit_1",t[t.unit_2=2]="unit_2",t[t.unit_4=4]="unit_4"})(rt||(rt={}));function it(t,e,i){t.key==="Enter"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.onSendMessage(n(i)))}var Lt=_('<span aria-live="polite"> </span>m',1),Pt=(t,e,i)=>e(i()),Ft=_('<button class="btn btn-xl"> </button>'),qt=(t,e)=>e("Skip"),Ht=_('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),Jt=(t,e)=>e("Over"),Gt=_('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),Vt=_("<option></option>"),Kt=_("<option></option>"),Ut=_("<!> <option></option>",1),Wt=_('<pre class="text-2xl"> </pre>'),Zt=_('<pre class="text-2xl bg-error text-error-content"> </pre>'),Bt=(t,e,i)=>e.onSendMessage(n(i)),zt=_('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),Qt=_('<span aria-live="polite"> </span>m',1),Xt=(t,e,i)=>e(i()),Yt=_('<button class="btn"> </button>'),$t=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),er=(t,e)=>e("Skip"),tr=_('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),rr=(t,e)=>e("Over"),ar=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),nr=_("<option></option>"),ir=_("<option></option>"),or=_("<!> <option></option>",1),sr=_('<pre class="text-md"> </pre>'),lr=_('<pre class="text-md bg-error text-error-content"> </pre>'),cr=(t,e,i)=>e.onSendMessage(n(i)),vr=_('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),ur=_('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function _r(t,e){Ee(e,!0);let i=ne(""),c=ne(0),V=ne(void 0),Q=ne(null);const ae=Oe(()=>{var f;return e.remain!==null?e.remain/(((f=e.setting)==null?void 0:f.timeout.action)??6e4)*100:0}),te=Oe(()=>[le.VOTE,le.DIVINE,le.GUARD,le.ATTACK].includes(e.request));function F(f){var W,D;if(!e.request||!e.setting)return 0;const d=e.request===le.TALK?e.setting.talk.max_length:e.request===le.WHISPER?e.setting.whisper.max_length:null;if(!d)return 0;let p=d.base_length??0;if(p+=((W=e.info)==null?void 0:W.remain_length)??0,d.mention_length){for(const H in((D=e.info)==null?void 0:D.status_map)??{})if(f.indexOf("@"+H)!==-1){p+=d.mention_length,p+=at("@"+H).length;break}}return d.per_talk&&(p=Math.min(p,d.per_talk)),p-=at(f).length,p}ft(()=>{B(c,F(n(i)),!0)}),He(()=>{const f=be.subscribe(d=>{B(V,d,!0)});return()=>{f()}});function y(f){var d;B(i,f,!0),(d=n(Q))==null||d.focus()}function w(f){f.focus()}var q=ur(),v=a(q);{var S=f=>{var d=zt(),p=z(d),W=a(p),D=a(W);{var H=b=>{var A=Lt(),R=z(A),E=a(R,!0);r(R),_e(),G((ee,ie,re)=>{Ce(R,`--value:${ee??""};`),me(R,"aria-label",ie),m(E,re)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),l(b,A)};j(D,b=>{e.remain&&e.remain>6e4&&b(H)})}var C=o(D,2),K=a(C,!0);r(C),_e(),r(W);var k=o(W,2),M=a(k,!0);r(k),r(p);var $=o(p,2),U=a($);{var X=b=>{var A=ge(),R=z(A);fe(R,17,()=>{var E;return Object.entries(((E=e.info)==null?void 0:E.status_map)??{})},de,(E,ee)=>{let ie=()=>n(ee)[0],re=()=>n(ee)[1];var se=ge(),ue=z(se);{var xe=ve=>{var ce=Ft();ce.__click=[Pt,y,ie];var Me=a(ce,!0);r(ce),G(()=>m(Me,ie())),l(ve,ce)};j(ue,ve=>{var ce;re()===Se.ALIVE&&ie()!==((ce=e.info)==null?void 0:ce.agent)&&ve(xe)})}l(E,se)}),l(b,A)},g=b=>{var A=Gt(),R=z(A);{var E=re=>{var se=Ht();se.__click=[qt,y];var ue=a(se);oe(ue,"icon","mdi:arrow-u-down-right-bold"),_e(),r(se),l(re,se)};j(R,re=>{var se;(((se=e.info)==null?void 0:se.remain_skip)??0)>0&&re(E)})}var ee=o(R,2);ee.__click=[Jt,y];var ie=a(ee);oe(ie,"icon","mdi:skip-forward"),_e(),r(ee),l(b,A)};j(U,b=>{n(te)?b(X):b(g,!1)})}var O=o(U,2);ye(O),O.__keydown=[it,e,i],Ke(()=>Xe(O,()=>n(i),b=>B(i,b))),$e(O,b=>w==null?void 0:w(b)),Ze(O,b=>B(Q,b),()=>n(Q));var I=o(O,2),Z=a(I);{var Y=b=>{var A=ge(),R=z(A);fe(R,17,()=>{var E;return Object.entries(((E=e.info)==null?void 0:E.status_map)??{})},de,(E,ee)=>{let ie=()=>n(ee)[0],re=()=>n(ee)[1];var se=ge(),ue=z(se);{var xe=ve=>{var ce=Vt(),Me={};G(()=>{Me!==(Me=ie())&&(ce.value=(ce.__value=ie())==null?"":ie())}),l(ve,ce)};j(ue,ve=>{var ce;re()===Se.ALIVE&&ie()!==((ce=e.info)==null?void 0:ce.agent)&&ve(xe)})}l(E,se)}),l(b,A)},T=b=>{var A=Ut(),R=z(A);{var E=ie=>{var re=Kt();re.value=(re.__value="Skip")==null?"":"Skip",l(ie,re)};j(R,ie=>{var re;(((re=e.info)==null?void 0:re.remain_skip)??0)>0&&ie(E)})}var ee=o(R,2);ee.value=(ee.__value="Over")==null?"":"Over",l(b,A)};j(Z,b=>{n(te)?b(Y):b(T,!1)})}r(I);var N=o(I,2);{var h=b=>{var A=Wt(),R=a(A);r(A),G(()=>m(R,`残り${n(c)??""}文字`)),l(b,A)},J=b=>{var A=Zt(),R=a(A);r(A),G(()=>m(R,`${n(c)*-1}文字超過`)),l(b,A)};j(N,b=>{n(c)>=0?b(h):b(J,!1)})}var P=o(N,2);P.__click=[Bt,e,i];var s=a(P);oe(s,"icon","mdi:send"),_e(),r(P),r($);var u=o($,2),x=a(u);r(u),G((b,A,R)=>{Ce(C,`--value:${b??""};`),me(C,"aria-label",A),m(K,R),m(M,n(te)?`${Ie[e.request]}対象を選択してください`:`${Ie[e.request??le.INITIALIZE]}内容を入力してください`),Ne(x,n(ae))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),l(f,d)},L=f=>{var d=vr(),p=z(d),W=a(p),D=a(W);{var H=s=>{var u=Qt(),x=z(u),b=a(x,!0);r(x),_e(),G((A,R,E)=>{Ce(x,`--value:${A??""};`),me(x,"aria-label",R),m(b,E)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),l(s,u)};j(D,s=>{e.remain&&e.remain>6e4&&s(H)})}var C=o(D,2),K=a(C,!0);r(C),_e(),r(W);var k=o(W,2);{var M=s=>{var u=$t(),x=z(u),b=a(x);r(x);var A=o(x,2);fe(A,17,()=>{var R;return Object.entries(((R=e.info)==null?void 0:R.status_map)??{})},de,(R,E)=>{let ee=()=>n(E)[0],ie=()=>n(E)[1];var re=ge(),se=z(re);{var ue=xe=>{var ve=Yt();ve.__click=[Xt,y,ee];var ce=a(ve,!0);r(ve),G(()=>m(ce,ee())),l(xe,ve)};j(se,xe=>{var ve;ie()===Se.ALIVE&&ee()!==((ve=e.info)==null?void 0:ve.agent)&&xe(ue)})}l(R,re)}),G(()=>m(b,`${Ie[e.request]??""}対象を選択してください`)),l(s,u)},$=s=>{var u=ar(),x=z(u),b=a(x);r(x);var A=o(x,2);{var R=ie=>{var re=tr();re.__click=[er,y];var se=a(re);oe(se,"icon","mdi:arrow-u-down-right-bold"),_e(),r(re),l(ie,re)};j(A,ie=>{var re;(((re=e.info)==null?void 0:re.remain_skip)??0)>0&&ie(R)})}var E=o(A,2);E.__click=[rr,y];var ee=a(E);oe(ee,"icon","mdi:skip-forward"),_e(),r(E),G(()=>m(b,`${Ie[e.request??le.INITIALIZE]??""}内容を入力してください`)),l(s,u)};j(k,s=>{n(te)?s(M):s($,!1)})}var U=o(k,2);ye(U),U.__keydown=[it,e,i],Ke(()=>Xe(U,()=>n(i),s=>B(i,s))),$e(U,s=>w==null?void 0:w(s)),Ze(U,s=>B(Q,s),()=>n(Q));var X=o(U,2),g=a(X);{var O=s=>{var u=ge(),x=z(u);fe(x,17,()=>{var b;return Object.entries(((b=e.info)==null?void 0:b.status_map)??{})},de,(b,A)=>{let R=()=>n(A)[0],E=()=>n(A)[1];var ee=ge(),ie=z(ee);{var re=se=>{var ue=nr(),xe={};G(()=>{xe!==(xe=R())&&(ue.value=(ue.__value=R())==null?"":R())}),l(se,ue)};j(ie,se=>{var ue;E()===Se.ALIVE&&R()!==((ue=e.info)==null?void 0:ue.agent)&&se(re)})}l(b,ee)}),l(s,u)},I=s=>{var u=or(),x=z(u);{var b=R=>{var E=ir();E.value=(E.__value="Skip")==null?"":"Skip",l(R,E)};j(x,R=>{var E;(((E=e.info)==null?void 0:E.remain_skip)??0)>0&&R(b)})}var A=o(x,2);A.value=(A.__value="Over")==null?"":"Over",l(s,u)};j(g,s=>{n(te)?s(O):s(I,!1)})}r(X);var Z=o(X,2);{var Y=s=>{var u=sr(),x=a(u);r(u),G(()=>m(x,`残り${n(c)??""}文字`)),l(s,u)},T=s=>{var u=lr(),x=a(u);r(u),G(()=>m(x,`${n(c)*-1}文字超過`)),l(s,u)};j(Z,s=>{n(c)>=0?s(Y):s(T,!1)})}var N=o(Z,2);N.__click=[cr,e,i];var h=a(N);oe(h,"icon","mdi:send"),_e(),r(N),r(p);var J=o(p,2),P=a(J);r(J),G((s,u,x)=>{Ce(C,`--value:${s??""};`),me(C,"aria-label",u),m(K,x),Ne(P,n(ae))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),l(f,d)};j(v,f=>{var d;(d=n(V))!=null&&d.display.largeScale?f(S):f(L,!1)})}r(q),l(t,q),De()}ct(["click","keydown"]);var fr=_('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),dr=_('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),gr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),xr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),mr=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),br=_('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),pr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),hr=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),yr=_('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),Ar=_('<div class="grow overflow-y-auto pr-4"><pre class="text-5xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!></div>'),wr=_('<pre class="text-lg text-center"> </pre>'),kr=_('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ir=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Sr=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Tr=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Rr=_('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),Or=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Er=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Dr=_('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),Nr=_('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),jr=_('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function Mr(t,e){Ee(e,!0);let i=ne(void 0);He(()=>{const F=be.subscribe(y=>{B(i,y,!0)});je(F)});var c=jr(),V=a(c),Q=a(V);{var ae=F=>{var y=Ar(),w=a(y),q=a(w,!0);r(w);var v=o(w,2),S=a(v,!0);r(v);var L=o(v,2);{var f=C=>{var K=fr(),k=a(K,!0);r(K),G(()=>m(k,Ie[e.request])),l(C,K)};j(L,C=>{e.request!==null&&C(f)})}var d=o(L,2);fe(d,17,()=>Object.entries(e.info.status_map??{}),de,(C,K)=>{let k=()=>n(K)[0],M=()=>n(K)[1];var $=ge(),U=z($);{var X=O=>{var I=dr(),Z=a(I),Y=a(Z,!0);r(Z);var T=o(Z,2),N=a(T,!0);r(T);var h=o(T,2),J=a(h,!0);r(h),r(I),G(()=>{m(Y,k()),m(N,ke[(e.info.role_map??{})[k()]]??""),m(J,Le[M()])}),l(O,I)},g=O=>{var I=gr(),Z=a(I),Y=a(Z,!0);r(Z);var T=o(Z,2),N=a(T,!0);r(T);var h=o(T,2),J=a(h);r(h),r(I),G(P=>{m(Y,k()),m(N,ke[(e.info.role_map??{})[k()]]??""),m(J,`${Le[M()]??""}${P??""}`)},[()=>e.executedAgents.includes(k())?" (追放)":e.attackedAgents.includes(k())?" (襲撃)":""]),l(O,I)};j(U,O=>{M()===Se.ALIVE?O(X):O(g,!1)})}l(C,$)});var p=o(d,2);{var W=C=>{var K=br(),k=o(z(K),2);fe(k,17,()=>e.mediumResults,de,(M,$)=>{let U=()=>n($).day,X=()=>n($).target,g=()=>n($).result;var O=ge(),I=z(O);{var Z=T=>{var N=xr(),h=a(N),J=a(h,!0);r(h);var P=o(h,2),s=a(P);r(P);var u=o(P,2),x=a(u,!0);r(u),r(N),G(()=>{m(J,X()),m(s,`(${U()??""}日目)`),m(x,he[g()])}),l(T,N)},Y=T=>{var N=mr(),h=a(N),J=a(h,!0);r(h);var P=o(h,2),s=a(P);r(P);var u=o(P,2),x=a(u,!0);r(u),r(N),G(()=>{m(J,X()),m(s,`(${U()??""}日目)`),m(x,he[g()])}),l(T,N)};j(I,T=>{g()!==Pe.HUMAN?T(Z):T(Y,!1)})}l(M,O)}),l(C,K)};j(p,C=>{e.mediumResults.length>0&&C(W)})}var D=o(p,2);{var H=C=>{var K=yr(),k=o(z(K),2);fe(k,17,()=>e.divineResults,de,(M,$)=>{let U=()=>n($).day,X=()=>n($).target,g=()=>n($).result;var O=ge(),I=z(O);{var Z=T=>{var N=pr(),h=a(N),J=a(h,!0);r(h);var P=o(h,2),s=a(P);r(P);var u=o(P,2),x=a(u,!0);r(u),r(N),G(()=>{m(J,X()),m(s,`(${U()??""}日目)`),m(x,he[g()])}),l(T,N)},Y=T=>{var N=hr(),h=a(N),J=a(h,!0);r(h);var P=o(h,2),s=a(P);r(P);var u=o(P,2),x=a(u,!0);r(u),r(N),G(()=>{m(J,X()),m(s,`(${U()??""}日目)`),m(x,he[g()])}),l(T,N)};j(I,T=>{g()!==Pe.HUMAN?T(Z):T(Y,!1)})}l(M,O)}),l(C,K)};j(D,C=>{e.divineResults.length>0&&C(H)})}r(y),G(()=>{m(q,e.role!==null?ke[e.role]:"ゲーム外"),m(S,e.info!==null?e.info.day+"日目":"ゲーム外")}),l(F,y)},te=F=>{var y=Nr(),w=o(z(y),2),q=a(w),v=a(q),S=o(a(v),2),L=a(S,!0);r(S),r(v);var f=o(v,2),d=o(a(f),2),p=a(d,!0);r(d),r(f);var W=o(f,2),D=o(a(W),2);{var H=U=>{var X=wr(),g=a(X,!0);r(X),G(()=>m(g,Ie[e.request])),l(U,X)};j(D,U=>{e.request!==null&&U(H)})}r(W),r(q);var C=o(q,4);fe(C,17,()=>Object.entries(e.info.status_map??{}),de,(U,X)=>{let g=()=>n(X)[0],O=()=>n(X)[1];var I=ge(),Z=z(I);{var Y=N=>{var h=kr(),J=a(h),P=a(J,!0);r(J);var s=o(J,2),u=a(s,!0);r(s);var x=o(s,2),b=a(x,!0);r(x),r(h),G(()=>{m(P,g()),m(u,ke[(e.info.role_map??{})[g()]]??""),m(b,Le[O()])}),l(N,h)},T=N=>{var h=Ir(),J=a(h),P=a(J,!0);r(J);var s=o(J,2),u=a(s,!0);r(s);var x=o(s,2),b=a(x);r(x),r(h),G(A=>{m(P,g()),m(u,ke[(e.info.role_map??{})[g()]]??""),m(b,`${Le[O()]??""}${A??""}`)},[()=>e.executedAgents.includes(g())?" (追放)":e.attackedAgents.includes(g())?" (襲撃)":""]),l(N,h)};j(Z,N=>{O()===Se.ALIVE?N(Y):N(T,!1)})}l(U,I)});var K=o(C,2);{var k=U=>{var X=Rr(),g=o(z(X),2);fe(g,17,()=>e.mediumResults,de,(O,I)=>{let Z=()=>n(I).day,Y=()=>n(I).target,T=()=>n(I).result;var N=ge(),h=z(N);{var J=s=>{var u=Sr(),x=a(u),b=a(x,!0);r(x);var A=o(x,2),R=a(A);r(A);var E=o(A,2),ee=a(E,!0);r(E),r(u),G(()=>{m(b,Y()),m(R,`(${Z()??""}日目)`),m(ee,he[T()])}),l(s,u)},P=s=>{var u=Tr(),x=a(u),b=a(x,!0);r(x);var A=o(x,2),R=a(A);r(A);var E=o(A,2),ee=a(E,!0);r(E),r(u),G(()=>{m(b,Y()),m(R,`(${Z()??""}日目)`),m(ee,he[T()])}),l(s,u)};j(h,s=>{T()!==Pe.HUMAN?s(J):s(P,!1)})}l(O,N)}),l(U,X)};j(K,U=>{e.mediumResults.length>0&&U(k)})}var M=o(K,2);{var $=U=>{var X=Dr(),g=o(z(X),2);fe(g,17,()=>e.divineResults,de,(O,I)=>{let Z=()=>n(I).day,Y=()=>n(I).target,T=()=>n(I).result;var N=ge(),h=z(N);{var J=s=>{var u=Or(),x=a(u),b=a(x,!0);r(x);var A=o(x,2),R=a(A);r(A);var E=o(A,2),ee=a(E,!0);r(E),r(u),G(()=>{m(b,Y()),m(R,`(${Z()??""}日目)`),m(ee,he[T()])}),l(s,u)},P=s=>{var u=Er(),x=a(u),b=a(x,!0);r(x);var A=o(x,2),R=a(A);r(A);var E=o(A,2),ee=a(E,!0);r(E),r(u),G(()=>{m(b,Y()),m(R,`(${Z()??""}日目)`),m(ee,he[T()])}),l(s,u)};j(h,s=>{T()!==Pe.HUMAN?s(J):s(P,!1)})}l(O,N)}),l(U,X)};j(M,U=>{e.divineResults.length>0&&U($)})}r(w),G(()=>{m(L,e.role!==null?ke[e.role]:"ゲーム外"),m(p,e.info!==null?e.info.day+"日目":"ゲーム外")}),l(F,y)};j(Q,F=>{var y;(y=n(i))!=null&&y.display.largeScale?F(ae):F(te,!1)})}r(V),r(c),l(t,c),De()}function Cr(){Re.connect()}function Lr(){Re.disconnect()}var Pr=_('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Fr=_('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),qr=_('<div class="status status-error"></div>'),Hr=(t,e)=>e("connection.url",t.currentTarget.value),Jr=(t,e)=>e("connection.token",t.currentTarget.value),Gr=(t,e)=>e("team",t.currentTarget.value),Vr=(t,e)=>e("display.largeScale",t.currentTarget.checked),Kr=_('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><h1 class="text-3xl font-bold text-nowrap ml-2">aiwolf-nlp-viewer</h1> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="WebSocket URL"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="Authorization Key"> <span class="badge badge-neutral badge-xs">Optional</span></label> <button class="btn btn-info">接続</button> <button class="btn btn-error">切断</button> <button class="btn">設定</button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold">エージェント設定</h3> <h4 class="text-base font-bold mt-2">チーム名</h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <h3 class="text-lg font-bold mt-4">表示設定</h3> <h4 class="text-base font-bold mt-2">大画面向け</h4> <label class="label cursor-pointer my-2"><span class="label-text">有効</span> <input type="checkbox" class="checkbox"></label></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function Ur(t,e){Ee(e,!0);let i=ne(void 0),c=ne(void 0);const V=be.subscribe(h=>{B(i,h,!0)}),Q=Re.subscribe(h=>{B(c,h.status,!0)});je(()=>{V(),Q()});function ae(h,J){be.update(P=>{const s=h.split("."),u=s.pop();let x=P;for(const b of s)b&&(x=x[b]);return x[u]=J,{...P}})}let te;var F=Kr(),y=o(a(F),2),w=a(y),q=a(w);{var v=h=>{var J=Pr();_e(2),l(h,J)},S=(h,J)=>{{var P=u=>{var x=Fr();_e(2),l(u,x)},s=u=>{var x=qr();l(u,x)};j(h,u=>{n(c)==="connecting"?u(P):u(s,!1)},J)}};j(q,h=>{n(c)==="connected"?h(v):h(S,!1)})}r(w),r(y);var L=o(y,2),f=a(L);Ge(f,1,"h-[1em] opacity-50"),oe(f,"inline",!0),oe(f,"icon","mdi:link");var d=o(f,2);ye(d),d.__input=[Hr,ae],r(L);var p=o(L,2),W=a(p);Ge(W,1,"h-[1em] opacity-50"),oe(W,"inline",!0),oe(W,"icon","mdi:key");var D=o(W,2);ye(D),D.__input=[Jr,ae],_e(2),r(p);var H=o(p,2);H.__click=[Cr];var C=o(H,2);C.__click=[Lr];var K=o(C,2);K.__click=()=>te.showModal();var k=o(K,2),M=a(k),$=a(M),U=o(a($),4),X=a(U);Ge(X,1,"h-[1em] opacity-50"),oe(X,"inline",!0),oe(X,"icon","mdi:rename");var g=o(X,2);ye(g),g.__input=[Gr,ae],r(U);var O=o(U,6),I=o(a(O),2);ye(I),I.__change=[Vr,ae],r(O),r($),r(M),_e(2),r(k),Ze(k,h=>te=h,()=>te);var Z=o(k,2),Y=a(Z);oe(Y,"inline",!0),oe(Y,"icon","mdi:white-balance-sunny");var T=o(Y,2),N=o(T,2);oe(N,"inline",!0),oe(N,"icon","mdi:moon-and-stars"),r(Z),r(F),G(()=>{var h,J,P,s;Ne(d,(h=n(i))==null?void 0:h.connection.url),Ne(D,(J=n(i))==null?void 0:J.connection.token),H.disabled=n(c)!=="disconnected",C.disabled=n(c)==="disconnected",Ne(g,(P=n(i))==null?void 0:P.team),We(I,(s=n(i))==null?void 0:s.display.largeScale)}),l(t,F),De()}ct(["input","click","change"]);var Wr=_("<iconify-icon></iconify-icon>",2),Zr=_("<iconify-icon></iconify-icon>",2),Br=_('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),zr=_('<div class="chat-image avatar"><div class="w-20 rounded-full"><img></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),Qr=_("<iconify-icon></iconify-icon>",2),Xr=_("<iconify-icon></iconify-icon>",2),Yr=_('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),$r=_('<div class="chat-image avatar"><div class="w-10 rounded-full"><img></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),ea=_('<div class="chat chat-start"><!></div>');function ot(t,e){Ee(e,!0);let i=ne(void 0);He(()=>{const te=be.subscribe(F=>{B(i,F,!0)});je(te)});var c=ea(),V=a(c);{var Q=te=>{var F=zr(),y=z(F),w=a(y),q=a(w);r(w),r(y);var v=o(y,2),S=a(v,!0);r(v);var L=o(v,2);{var f=D=>{var H=Wr();oe(H,"inline",!0),oe(H,"icon","mdi:skip-forward"),l(D,H)},d=(D,H)=>{{var C=k=>{var M=Zr();oe(M,"inline",!0),oe(M,"icon","mdi:arrow-u-down-right-bold"),l(k,M)},K=k=>{var M=Br(),$=a(M,!0);r(M),G(()=>m($,e.talk.text)),l(k,M)};j(D,k=>{e.talk.skip?k(C):k(K,!1)},H)}};j(L,D=>{e.talk.over?D(f):D(d,!1)})}var p=o(L,2),W=a(p);r(p),G(()=>{me(q,"src",e.isDefaultProfile?`${Ye}${Ue[e.talk.agent]}`:""),me(q,"alt",e.talk.agent),m(S,e.talk.agent),m(W,`Idx: ${e.talk.idx??""}`)}),l(te,F)},ae=te=>{var F=$r(),y=z(F),w=a(y),q=a(w);r(w),r(y);var v=o(y,2),S=a(v,!0);r(v);var L=o(v,2);{var f=D=>{var H=Qr();oe(H,"inline",!0),oe(H,"icon","mdi:skip-forward"),l(D,H)},d=(D,H)=>{{var C=k=>{var M=Xr();oe(M,"inline",!0),oe(M,"icon","mdi:arrow-u-down-right-bold"),l(k,M)},K=k=>{var M=Yr(),$=a(M,!0);r(M),G(()=>m($,e.talk.text)),l(k,M)};j(D,k=>{e.talk.skip?k(C):k(K,!1)},H)}};j(L,D=>{e.talk.over?D(f):D(d,!1)})}var p=o(L,2),W=a(p);r(p),G(()=>{me(q,"src",e.isDefaultProfile?`${Ye}${Ue[e.talk.agent]}`:""),me(q,"alt",e.talk.agent),m(S,e.talk.agent),m(W,`Idx: ${e.talk.idx??""}`)}),l(te,F)};j(V,te=>{var F;(F=n(i))!=null&&F.display.largeScale?te(Q):te(ae,!1)})}r(c),l(t,c),De()}var ta=_('<input type="radio" name="talk_days" class="tab text-lg font-bold"> <div class="tab-content my-4"></div>',1),ra=_('<div class="tabs tabs-border"></div>'),aa=_('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),na=_('<input type="radio" name="talk_days" class="tab"> <div class="tab-content my-4"></div>',1),ia=_('<div class="tabs tabs-border"></div>'),oa=_('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),sa=_('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function st(t,e){Ee(e,!0);let i=ne(void 0),c=e.agents.every(y=>Object.keys(Ue).includes(y));He(()=>{const y=be.subscribe(w=>{B(i,w,!0)});je(y)});var V=sa(),Q=a(V),ae=a(Q);{var te=y=>{var w=aa(),q=z(w),v=a(q,!0);r(q);var S=o(q,2),L=a(S);{var f=d=>{var p=ra();const W=Oe(()=>[...new Set(e.talks.map(D=>D.day))].sort((D,H)=>H-D));fe(p,21,()=>n(W),de,(D,H)=>{var C=ta(),K=z(C);ye(K);var k=o(K,2);fe(k,21,()=>e.talks.filter(M=>M.day===n(H)),de,(M,$)=>{ot(M,{get talk(){return n($)},get agents(){return e.agents},isDefaultProfile:c})}),r(k),G(()=>{We(K,n(H)===n(W)[0]),me(K,"aria-label",`${n(H)}日目`)}),l(D,C)}),r(p),l(d,p)};j(L,d=>{e.talks.length>0&&d(f)})}r(S),G(()=>m(v,e.header)),l(y,w)},F=y=>{var w=oa(),q=z(w),v=a(q,!0);r(q);var S=o(q,2),L=a(S);{var f=d=>{var p=ia();const W=Oe(()=>[...new Set(e.talks.map(D=>D.day))].sort((D,H)=>H-D));fe(p,21,()=>n(W),de,(D,H)=>{var C=na(),K=z(C);ye(K);var k=o(K,2);fe(k,21,()=>e.talks.filter(M=>M.day===n(H)),de,(M,$)=>{ot(M,{get talk(){return n($)},get agents(){return e.agents},isDefaultProfile:c})}),r(k),G(()=>{We(K,n(H)===n(W)[0]),me(K,"aria-label",`${n(H)}日目`)}),l(D,C)}),r(p),l(d,p)};j(L,d=>{e.talks.length>0&&d(f)})}r(S),G(()=>m(v,e.header)),l(y,w)};j(ae,y=>{var w;(w=n(i))!=null&&w.display.largeScale?y(te):y(F,!1)})}r(Q),r(V),l(t,V),De()}var la=_('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),ca=_('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none">未接続</pre></div>'),va=_('<div role="alert" class="alert m-4"><span class="text-lg font-bold">未接続</span></div>'),ua=_('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Oa(t,e){Ee(e,!0);let i=ne(void 0),c=ne(""),V=ne(null),Q=ne(Ae([])),ae=ne(null),te=ne(null),F=ne(null),y=ne(Ae([])),w=ne(Ae([])),q=ne(null),v=ne(Ae([])),S=ne(Ae([])),L=ne(Ae([])),f=ne(Ae([])),d=ne(null),p=ne(null),W=be.subscribe(g=>{B(i,g,!0)}),D=Re.subscribe(g=>{B(c,g.status,!0),g.deadline?(B(V,g.deadline.getTime(),!0),C()):(B(V,null),B(d,null),n(p)&&(cancelAnimationFrame(n(p)),B(p,null))),B(Q,g.entries,!0),B(ae,g.role,!0),B(te,g.request,!0),B(F,g.info,!0),B(y,g.mediumResults,!0),B(w,g.divineResults,!0),B(q,g.setting,!0),B(v,g.talkHistory,!0),B(S,g.whisperHistory,!0),B(L,g.executedAgents,!0),B(f,g.attackedAgents,!0)});function H(){const g=xt.url.searchParams,O=g.get("url"),I=g.get("token");O&&(be.update(Z=>({...Z,connection:{url:O??"",token:I??""}})),Re.connect())}function C(){if(n(V)===null)return;const g=()=>{if(n(V)===null)return;const O=Date.now(),I=Math.max(0,n(V)-O);B(d,I,!0),I>0?B(p,requestAnimationFrame(g),!0):(B(d,0),B(p,null))};n(p)&&cancelAnimationFrame(n(p)),B(p,requestAnimationFrame(g),!0)}function K(g){Re.send(g)}{H();const g=I=>{n(c)==="connected"&&I.preventDefault()},O=I=>{n(c)==="connected"&&I.preventDefault()};window.addEventListener("beforeunload",g),window.addEventListener("popstate",O),je(()=>{window.removeEventListener("beforeunload",g),window.removeEventListener("popstate",O),n(p)&&cancelAnimationFrame(n(p)),W(),D()})}var k=ua();gt(g=>{dt.title="aiwolf-nlp-viewer"});var M=a(k);Ur(M,{});var $=o(M,2);{var U=g=>{var O=la(),I=z(O),Z=a(I);Mr(Z,{get role(){return n(ae)},get request(){return n(te)},get info(){return n(F)},get mediumResults(){return n(y)},get divineResults(){return n(w)},get executedAgents(){return n(L)},get attackedAgents(){return n(f)}});var Y=o(Z,2);const T=Oe(()=>{var s;return Object.keys(((s=n(F))==null?void 0:s.status_map)??{})});st(Y,{header:"トーク履歴",get talks(){return n(v)},get agents(){return n(T)}});var N=o(Y,2);{var h=s=>{const u=Oe(()=>{var x;return Object.keys(((x=n(F))==null?void 0:x.status_map)??{})});st(s,{header:"囁き履歴",get talks(){return n(S)},get agents(){return n(u)}})};j(N,s=>{n(ae)===mt.WEREWOLF&&s(h)})}r(I);var J=o(I,2);{var P=s=>{_r(s,{get remain(){return n(d)},get setting(){return n(q)},get request(){return n(te)},get info(){return n(F)},onSendMessage:K})};j(J,s=>{n(d)!==null&&s(P)})}l(g,O)},X=(g,O)=>{{var I=Y=>{var T=ca();l(Y,T)},Z=Y=>{var T=va();l(Y,T)};j(g,Y=>{var T;(T=n(i))!=null&&T.display.largeScale?Y(I):Y(Z,!1)},O)}};j($,g=>{n(F)!==null?g(U):g(X,!1)})}r(k),l(t,k),De()}export{Oa as component};
