var Rt=Object.defineProperty;var Et=(r,e,g)=>e in r?Rt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:g}):r[e]=g;var ze=(r,e,g)=>Et(r,typeof e!="symbol"?e+"":e,g);import{t as _,a as o,c as Ae}from"../chunks/CAIg9LuS.js";import{y as Qe,u as Ot,aC as Dt,p as Pe,ao as Nt,i as j,b as n,aD as ne,c as a,r as t,a as Ve,f as Z,s as i,aE as we,aL as Te,t as L,h as Ne}from"../chunks/CVbD-S9Z.js";import{d as bt,s}from"../chunks/C8ECSYUL.js";import{i as O}from"../chunks/BIKTZzlQ.js";import{s as je,a as Ze}from"../chunks/CkcQFZMy.js";import{p as Ct}from"../chunks/C46m9TOj.js";import{s as Ue,a as Fe,S as We,R as Mt}from"../chunks/DnmOadT0.js";import{c as Lt,r as Oe,a as oe,s as Ie,b as Ke,L as Ft,d as Xe}from"../chunks/BOS-JZUI.js";import{a as Je,o as Ge}from"../chunks/DKiJJ5YD.js";import{$ as Be}from"../chunks/CxsNamv1.js";import{e as be,i as he}from"../chunks/D_DjLMOV.js";import{b as st}from"../chunks/BEbmUPvZ.js";import{b as $e}from"../chunks/ovxldbG8.js";import{s as Ye}from"../chunks/DdMmm6By.js";import{b as ot}from"../chunks/BcFVByYQ.js";function vt(r,e,g){Qe(()=>{var D=Ot(()=>e(r,g==null?void 0:g())||{});if(D!=null&&D.destroy)return()=>D.destroy()})}class ct{static fromJson(e){return JSON.parse(e)}static toJson(e){return JSON.stringify(e,null,2)}}const Ht={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}},Re=Lt({storageKey:"agent-settings",defaultValue:Ht,serialize:ct.toJson,deserialize:ct.fromJson});var pe=(r=>(r.NAME="NAME",r.TALK="TALK",r.WHISPER="WHISPER",r.VOTE="VOTE",r.DIVINE="DIVINE",r.GUARD="GUARD",r.ATTACK="ATTACK",r.INITIALIZE="INITIALIZE",r.DAILY_INITIALIZE="DAILY_INITIALIZE",r.DAILY_FINISH="DAILY_FINISH",r.FINISH="FINISH",r))(pe||{});const et={ミナト:"/images/male/01.png",タクミ:"/images/male/02.png",ケンジ:"/images/male/03.png",リュウジ:"/images/male/04.png",ダイスケ:"/images/male/05.png",シオン:"/images/male/06.png",ベンジャミン:"/images/male/07.png",トシオ:"/images/male/08.png",ジョナサン:"/images/male/09.png",シュンイチ:"/images/male/10.png",ジョージ:"/images/male/11.png",セルヴァス:"/images/male/12.png",サクラ:"/images/female/01.png",リン:"/images/female/02.png",ユミ:"/images/female/03.png",メイ:"/images/female/04.png",ミサキ:"/images/female/05.png",ミオ:"/images/female/06.png",ミヅキ:"/images/female/07.png",ミナコ:"/images/female/08.png",アスカ:"/images/female/09.png",ミドリ:"/images/female/10.png",ヴィクトリア:"/images/female/11.png",シズエ:"/images/female/12.png"},ut=()=>({status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});function Pt(){const{subscribe:r,update:e}=Dt(ut());let g=null,D=null,d=null,H=null;Re.subscribe(w=>{D=w});function ee(){g&&(g.close(),g=null,e(w=>({...w,status:"disconnected"}))),H&&(H.clear(),H=null)}function ie(){if(!D)return;g&&e(()=>ut()),e(c=>({...c,status:"connecting"}));const w=new URL(D.connection.url);D.connection.token&&w.searchParams.set("token",D.connection.token),g=new WebSocket(w),g.onopen=()=>{e(c=>({...c,status:"connected"}))},g.onclose=()=>{ee()},g.onerror=()=>{ee()},g.onmessage=c=>{try{const x=Date.now(),P=JSON.parse(c.data);e(W=>B(W,P)),Y(P,x)}catch(x){console.error("Failed to parse message:",x)}}}function ae(w){if(H&&(H.clear(),H=null,e(c=>({...c,deadline:null}))),g&&g.readyState===WebSocket.OPEN)try{g.send(w),e(c=>{const x=c.entries.slice();return x.push(w),{...c,entries:x}})}catch(c){console.error("Failed to send message:",c)}}function B(w,c){const x={...w,entries:[...w.entries,c],request:c.request};if(c.info){if(x.info=c.info,c.info.medium_result){const P=c.info.medium_result;x.mediumResults.some(W=>W.day===P.day&&W.agent===P.agent)||x.mediumResults.push(P)}if(c.info.divine_result){const P=c.info.divine_result;x.divineResults.some(W=>W.day===P.day&&W.agent===P.agent)||x.divineResults.push(P)}c.info.executed_agent&&x.executedAgents.push(c.info.executed_agent),c.info.attacked_agent&&x.attackedAgents.push(c.info.attacked_agent)}return c.setting&&(x.setting=c.setting,d=c.setting.timeout.action),c.talk_history&&x.talkHistory.push(...c.talk_history),c.whisper_history&&x.whisperHistory.push(...c.whisper_history),c.request===pe.INITIALIZE&&x.info&&(x.agent=x.info.agent,x.role=x.info.role_map[x.info.agent],x.profile=x.info.profile||null),x}function Y(w,c){switch(w.request){case pe.NAME:ae((D==null?void 0:D.team)||"viewer"+Math.floor(Math.random()*1e3));break;case pe.TALK:case pe.WHISPER:case pe.VOTE:case pe.DIVINE:case pe.GUARD:case pe.ATTACK:H&&H.clear(),H=new Vt(()=>{ae("TIMEOUT")},new Date(c+(d??6e4))),e(x=>({...x,deadline:(H==null?void 0:H.deadline())??null}));break;case pe.FINISH:ee();break}}return{subscribe:r,connect:ie,disconnect:ee,send:ae}}const He=Pt();class Vt{constructor(e,g){ze(this,"timeout");ze(this,"_deadline");this.timeout=setTimeout(e,g.getTime()-new Date().getTime()),this._deadline=g}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var _t;(function(r){r[r.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",r[r.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",r[r.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",r[r.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",r[r.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",r[r.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",r[r.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",r[r.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",r[r.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",r[r.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",r[r.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",r[r.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",r[r.TAGS_START=917504]="TAGS_START",r[r.TAGS_END=917631]="TAGS_END",r[r.ZWJ=8205]="ZWJ"})(_t||(_t={}));const Kt=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var dt;function ft(r){if(typeof r!="string")throw new TypeError("string cannot be undefined or null");const e=[];let g=0,D=0;for(;g<r.length;)D+=Gt(g+D,r),Bt(r[g+D])&&D++,jt(r[g+D])&&D++,Zt(r[g+D])&&D++,zt(r[g+D])?D++:(e.push(r.substring(g,g+D)),g+=D,D=0);return e}function Gt(r,e){const g=e[r];if(!qt(g)||r===e.length-1)return 1;const D=g+e[r+1];let d=e.substring(r+2,r+5);return gt(D)&&gt(d)?4:Ut(D)&&Jt(d)?e.slice(r).indexOf(String.fromCodePoint(917631))+2:Wt(d)?4:2}function qt(r){return r&&Ce(r[0].charCodeAt(0),55296,56319)}function gt(r){return Ce(tt(r),127462,127487)}function Ut(r){return Ce(tt(r),127988,127988)}function Wt(r){return Ce(tt(r),127995,127999)}function jt(r){return typeof r=="string"&&Ce(r.charCodeAt(0),65024,65039)}function Zt(r){return typeof r=="string"&&Ce(r.charCodeAt(0),8400,8447)}function Jt(r){const e=r.codePointAt(0);return typeof r=="string"&&typeof e=="number"&&Ce(e,917504,917631)}function Bt(r){return typeof r=="string"&&Kt.includes(r.charCodeAt(0))}function zt(r){return typeof r=="string"&&r.charCodeAt(0)===8205}function tt(r){return(r.charCodeAt(0)-55296<<10)+(r.charCodeAt(1)-56320)+65536}function Ce(r,e,g){return r>=e&&r<=g}(function(r){r[r.unit_1=1]="unit_1",r[r.unit_2=2]="unit_2",r[r.unit_4=4]="unit_4"})(dt||(dt={}));function mt(r,e,g){r.key==="Enter"&&(r.ctrlKey||r.metaKey)&&(r.preventDefault(),e.onSendMessage(n(g)))}var Yt=_('<span aria-live="polite"> </span>m',1),Qt=(r,e,g)=>e(g()),Xt=_('<button class="btn btn-xl"> </button>'),$t=(r,e)=>e("Skip"),ea=_('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),ta=(r,e)=>e("Over"),aa=_('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),ra=_("<option></option>"),na=_("<option></option>"),ia=_("<!> <option></option>",1),la=_('<pre class="text-2xl"> </pre>'),sa=_('<pre class="text-2xl bg-error text-error-content"> </pre>'),oa=(r,e,g)=>e.onSendMessage(n(g)),va=_('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> </button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),ca=_('<span aria-live="polite"> </span>m',1),ua=(r,e,g)=>e(g()),_a=_('<button class="btn"> </button>'),da=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),fa=(r,e)=>e("Skip"),ga=_('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),ma=(r,e)=>e("Over"),xa=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),pa=_("<option></option>"),ba=_("<option></option>"),ha=_("<!> <option></option>",1),ya=_('<pre class="text-md"> </pre>'),Aa=_('<pre class="text-md bg-error text-error-content"> </pre>'),Ia=(r,e,g)=>e.onSendMessage(n(g)),ka=_('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> </button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),wa=_('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function Ta(r,e){Pe(e,!0);const[g,D]=je(),d=()=>Ze(Be,"$_",g);let H=ne(""),ee=ne(0),ie=ne(void 0),ae=ne(null);const B=Te(()=>{var b;return e.remain!==null?e.remain/(((b=e.setting)==null?void 0:b.timeout.action)??6e4)*100:0}),Y=Te(()=>e.remain!==null?Math.floor(e.remain/6e4):0),w=Te(()=>e.remain!==null?Math.floor(e.remain%6e4/1e3):0),c=Te(()=>[pe.VOTE,pe.DIVINE,pe.GUARD,pe.ATTACK].includes(e.request));function x(b){var F,R;if(!e.request||!e.setting)return 0;const T=e.request===pe.TALK?e.setting.talk.max_length:e.request===pe.WHISPER?e.setting.whisper.max_length:null;if(!T)return 0;let I=T.base_length??0;if(I+=((F=e.info)==null?void 0:F.remain_length)??0,T.mention_length){for(const ve in((R=e.info)==null?void 0:R.status_map)??{})if(b.indexOf("@"+ve)!==-1){I+=T.mention_length,I+=ft("@"+ve).length;break}}return T.per_talk&&(I=Math.min(I,T.per_talk)),I-=ft(b).length,I}Nt(()=>{j(ee,x(n(H)),!0)}),Je(()=>{const b=Re.subscribe(T=>{j(ie,T,!0)});return()=>{b()}});function P(b){var T;j(H,b,!0),(T=n(ae))==null||T.focus()}function W(b){b.focus()}var se=wa(),le=a(se);{var ce=b=>{var T=va(),I=Z(T),F=a(I),R=a(F);{var ve=l=>{var u=Yt(),A=Z(u),m=a(A,!0);t(A),we(),L(q=>{Ue(A,`--value:${n(Y)??""};`),Ie(A,"aria-label",q),s(m,n(Y))},[()=>n(Y).toString()]),o(l,u)};O(R,l=>{e.remain&&e.remain>6e4&&l(ve)})}var de=i(R,2),me=a(de,!0);t(de),we(),t(F);var z=i(F,2),Q=a(z,!0);t(z),t(I);var te=i(I,2),re=a(te);{var ue=l=>{var u=Ae(),A=Z(u);be(A,17,()=>{var m;return Object.entries(((m=e.info)==null?void 0:m.status_map)??{})},he,(m,q)=>{let U=()=>n(q)[0],K=()=>n(q)[1];var $=Ae(),fe=Z($);{var ye=ge=>{var _e=Xt();_e.__click=[Qt,P,U];var Ee=a(_e,!0);t(_e),L(()=>s(Ee,U())),o(ge,_e)};O(fe,ge=>{var _e;K()===Fe.ALIVE&&U()!==((_e=e.info)==null?void 0:_e.agent)&&ge(ye)})}o(m,$)}),o(l,u)},p=l=>{var u=aa(),A=Z(u);{var m=K=>{var $=ea();$.__click=[$t,P];var fe=a($);oe(fe,"icon","mdi:arrow-u-down-right-bold"),we(),t($),o(K,$)};O(A,K=>{var $;((($=e.info)==null?void 0:$.remain_skip)??0)>0&&K(m)})}var q=i(A,2);q.__click=[ta,P];var U=a(q);oe(U,"icon","mdi:skip-forward"),we(),t(q),o(l,u)};O(re,l=>{n(c)?l(ue):l(p,!1)})}var h=i(re,2);Oe(h),h.__keydown=[mt,e,H],Qe(()=>st(h,()=>n(H),l=>j(H,l))),vt(h,l=>W==null?void 0:W(l)),$e(h,l=>j(ae,l),()=>n(ae));var k=i(h,2),E=a(k);{var G=l=>{var u=Ae(),A=Z(u);be(A,17,()=>{var m;return Object.entries(((m=e.info)==null?void 0:m.status_map)??{})},he,(m,q)=>{let U=()=>n(q)[0],K=()=>n(q)[1];var $=Ae(),fe=Z($);{var ye=ge=>{var _e=ra(),Ee={};L(()=>{Ee!==(Ee=U())&&(_e.value=(_e.__value=U())??"")}),o(ge,_e)};O(fe,ge=>{var _e;K()===Fe.ALIVE&&U()!==((_e=e.info)==null?void 0:_e.agent)&&ge(ye)})}o(m,$)}),o(l,u)},M=l=>{var u=ia(),A=Z(u);{var m=U=>{var K=na();K.value=K.__value="Skip",o(U,K)};O(A,U=>{var K;(((K=e.info)==null?void 0:K.remain_skip)??0)>0&&U(m)})}var q=i(A,2);q.value=q.__value="Over",o(l,u)};O(E,l=>{n(c)?l(G):l(M,!1)})}t(k);var X=i(k,2);{var N=l=>{var u=la(),A=a(u,!0);t(u),L(m=>s(A,m),[()=>d()("agent.remainingChars",{values:{count:n(ee)}})]),o(l,u)},C=l=>{var u=sa(),A=a(u,!0);t(u),L(m=>s(A,m),[()=>d()("agent.exceededChars",{values:{count:n(ee)*-1}})]),o(l,u)};O(X,l=>{n(ee)>=0?l(N):l(C,!1)})}var S=i(X,2);S.__click=[oa,e,H];var J=a(S);oe(J,"icon","mdi:send");var v=i(J);t(S),t(te);var y=i(te,2),f=a(y);t(y),L((l,u,A)=>{Ue(de,`--value:${n(w)??""};`),Ie(de,"aria-label",l),s(me,n(w)),s(Q,u),s(v,` ${A??""}`),Ke(f,n(B))},[()=>n(w).toString(),()=>n(c)?`${d()(`game.request.${e.request}`)}${d()("agent.selectTarget")}`:`${d()(`game.request.${e.request}`)}${d()("agent.enterContent")}`,()=>d()("agent.send")]),o(b,T)},V=b=>{var T=ka(),I=Z(T),F=a(I),R=a(F);{var ve=v=>{var y=ca(),f=Z(y),l=a(f,!0);t(f),we(),L((u,A,m)=>{Ue(f,`--value:${u??""};`),Ie(f,"aria-label",A),s(l,m)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),o(v,y)};O(R,v=>{e.remain&&e.remain>6e4&&v(ve)})}var de=i(R,2),me=a(de,!0);t(de),we(),t(F);var z=i(F,2);{var Q=v=>{var y=da(),f=Z(y),l=a(f);t(f);var u=i(f,2);be(u,17,()=>{var A;return Object.entries(((A=e.info)==null?void 0:A.status_map)??{})},he,(A,m)=>{let q=()=>n(m)[0],U=()=>n(m)[1];var K=Ae(),$=Z(K);{var fe=ye=>{var ge=_a();ge.__click=[ua,P,q];var _e=a(ge,!0);t(ge),L(()=>s(_e,q())),o(ye,ge)};O($,ye=>{var ge;U()===Fe.ALIVE&&q()!==((ge=e.info)==null?void 0:ge.agent)&&ye(fe)})}o(A,K)}),L((A,m)=>s(l,`${A??""}${m??""}`),[()=>d()(`game.request.${e.request}`),()=>d()("agent.selectTarget")]),o(v,y)},te=v=>{var y=xa(),f=Z(y),l=a(f);t(f);var u=i(f,2);{var A=U=>{var K=ga();K.__click=[fa,P];var $=a(K);oe($,"icon","mdi:arrow-u-down-right-bold"),we(),t(K),o(U,K)};O(u,U=>{var K;(((K=e.info)==null?void 0:K.remain_skip)??0)>0&&U(A)})}var m=i(u,2);m.__click=[ma,P];var q=a(m);oe(q,"icon","mdi:skip-forward"),we(),t(m),L((U,K)=>s(l,`${U??""}${K??""}`),[()=>d()(`game.request.${e.request}`),()=>d()("agent.enterContent")]),o(v,y)};O(z,v=>{n(c)?v(Q):v(te,!1)})}var re=i(z,2);Oe(re),re.__keydown=[mt,e,H],Qe(()=>st(re,()=>n(H),v=>j(H,v))),vt(re,v=>W==null?void 0:W(v)),$e(re,v=>j(ae,v),()=>n(ae));var ue=i(re,2),p=a(ue);{var h=v=>{var y=Ae(),f=Z(y);be(f,17,()=>{var l;return Object.entries(((l=e.info)==null?void 0:l.status_map)??{})},he,(l,u)=>{let A=()=>n(u)[0],m=()=>n(u)[1];var q=Ae(),U=Z(q);{var K=$=>{var fe=pa(),ye={};L(()=>{ye!==(ye=A())&&(fe.value=(fe.__value=A())??"")}),o($,fe)};O(U,$=>{var fe;m()===Fe.ALIVE&&A()!==((fe=e.info)==null?void 0:fe.agent)&&$(K)})}o(l,q)}),o(v,y)},k=v=>{var y=ha(),f=Z(y);{var l=A=>{var m=ba();m.value=m.__value="Skip",o(A,m)};O(f,A=>{var m;(((m=e.info)==null?void 0:m.remain_skip)??0)>0&&A(l)})}var u=i(f,2);u.value=u.__value="Over",o(v,y)};O(p,v=>{n(c)?v(h):v(k,!1)})}t(ue);var E=i(ue,2);{var G=v=>{var y=ya(),f=a(y,!0);t(y),L(l=>s(f,l),[()=>d()("agent.remainingChars",{values:{count:n(ee)}})]),o(v,y)},M=v=>{var y=Aa(),f=a(y,!0);t(y),L(l=>s(f,l),[()=>d()("agent.exceededChars",{values:{count:n(ee)*-1}})]),o(v,y)};O(E,v=>{n(ee)>=0?v(G):v(M,!1)})}var X=i(E,2);X.__click=[Ia,e,H];var N=a(X);oe(N,"icon","mdi:send");var C=i(N);t(X),t(I);var S=i(I,2),J=a(S);t(S),L((v,y,f,l)=>{Ue(de,`--value:${v??""};`),Ie(de,"aria-label",y),s(me,f),s(C,` ${l??""}`),Ke(J,n(B))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>d()("agent.send")]),o(b,T)};O(le,b=>{var T;(T=n(ie))!=null&&T.display.largeScale?b(ce):b(V,!1)})}t(se),o(r,se),Ve(),D()}bt(["click","keydown"]);var Sa=_('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),Ra=_('<pre class="text-md text-pretty break-all my-2"> </pre>'),Ea=_('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Oa=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Da=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Na=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ca=_('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),Ma=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),La=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Fa=_('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),Ha=_('<div class="grow overflow-y-auto pr-4"><pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!> <!></div>'),Pa=_('<pre class="text-lg text-center"> </pre>'),Va=_('<h2 class="text-lg font-bold text-center">プロフィール</h2> <pre class="text-md text-pretty break-all"> </pre>',1),Ka=_('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ga=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),qa=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ua=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Wa=_('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),ja=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Za=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ja=_('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),Ba=_('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">名前</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <!> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),za=_('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function Ya(r,e){Pe(e,!0);const[g,D]=je(),d=()=>Ze(Be,"$_",g);let H=ne(void 0);Je(()=>{const w=Re.subscribe(c=>{j(H,c,!0)});Ge(w)});var ee=za(),ie=a(ee),ae=a(ie);{var B=w=>{var c=Ha(),x=a(c),P=a(x,!0);t(x);var W=i(x,2),se=a(W,!0);t(W);var le=i(W,2),ce=a(le,!0);t(le);var V=i(le,2);{var b=z=>{var Q=Sa(),te=a(Q,!0);t(Q),L(re=>s(te,re),[()=>d()(`game.request.${e.request}`)]),o(z,Q)};O(V,z=>{e.request&&z(b)})}var T=i(V,2);{var I=z=>{var Q=Ra(),te=a(Q,!0);t(Q),L(()=>s(te,e.profile)),o(z,Q)};O(T,z=>{e.profile&&z(I)})}var F=i(T,2);be(F,17,()=>Object.entries(e.info.status_map??{}),he,(z,Q)=>{let te=()=>n(Q)[0],re=()=>n(Q)[1];var ue=Ae(),p=Z(ue);{var h=E=>{var G=Ea(),M=a(G),X=a(M,!0);t(M);var N=i(M,2),C=a(N,!0);t(N);var S=i(N,2),J=a(S,!0);t(S),t(G),L((v,y)=>{s(X,te()),s(C,v),s(J,y)},[()=>(e.info.role_map??{})[te()]?d()(`game.role.${(e.info.role_map??{})[te()]}`):"",()=>d()(`game.status.${re()}`)]),o(E,G)},k=E=>{var G=Oa(),M=a(G),X=a(M,!0);t(M);var N=i(M,2),C=a(N,!0);t(N);var S=i(N,2),J=a(S);t(S),t(G),L((v,y,f)=>{s(X,te()),s(C,v),s(J,`${y??""}${f??""}`)},[()=>(e.info.role_map??{})[te()]?d()(`game.role.${(e.info.role_map??{})[te()]}`):"",()=>d()(`game.status.${re()}`),()=>e.executedAgents.includes(te())?" (追放)":e.attackedAgents.includes(te())?" (襲撃)":""]),o(E,G)};O(p,E=>{re()===Fe.ALIVE?E(h):E(k,!1)})}o(z,ue)});var R=i(F,2);{var ve=z=>{var Q=Ca(),te=i(Z(Q),2);be(te,17,()=>e.mediumResults,he,(re,ue)=>{let p=()=>n(ue).day,h=()=>n(ue).target,k=()=>n(ue).result;var E=Ae(),G=Z(E);{var M=N=>{var C=Da(),S=a(C),J=a(S,!0);t(S);var v=i(S,2),y=a(v);t(v);var f=i(v,2),l=a(f,!0);t(f),t(C),L(u=>{s(J,h()),s(y,`(${p()??""}日目)`),s(l,u)},[()=>d()(`game.species.${k()}`)]),o(N,C)},X=N=>{var C=Na(),S=a(C),J=a(S,!0);t(S);var v=i(S,2),y=a(v);t(v);var f=i(v,2),l=a(f,!0);t(f),t(C),L(u=>{s(J,h()),s(y,`(${p()??""}日目)`),s(l,u)},[()=>d()(`game.species.${k()}`)]),o(N,C)};O(G,N=>{k()!==We.HUMAN?N(M):N(X,!1)})}o(re,E)}),o(z,Q)};O(R,z=>{e.mediumResults.length>0&&z(ve)})}var de=i(R,2);{var me=z=>{var Q=Fa(),te=i(Z(Q),2);be(te,17,()=>e.divineResults,he,(re,ue)=>{let p=()=>n(ue).day,h=()=>n(ue).target,k=()=>n(ue).result;var E=Ae(),G=Z(E);{var M=N=>{var C=Ma(),S=a(C),J=a(S,!0);t(S);var v=i(S,2),y=a(v);t(v);var f=i(v,2),l=a(f,!0);t(f),t(C),L(u=>{s(J,h()),s(y,`(${p()??""}日目)`),s(l,u)},[()=>d()(`game.species.${k()}`)]),o(N,C)},X=N=>{var C=La(),S=a(C),J=a(S,!0);t(S);var v=i(S,2),y=a(v);t(v);var f=i(v,2),l=a(f,!0);t(f),t(C),L(u=>{s(J,h()),s(y,`(${p()??""}日目)`),s(l,u)},[()=>d()(`game.species.${k()}`)]),o(N,C)};O(G,N=>{k()!==We.HUMAN?N(M):N(X,!1)})}o(re,E)}),o(z,Q)};O(de,z=>{e.divineResults.length>0&&z(me)})}t(c),L(z=>{s(P,e.agent?e.agent:"ゲーム外"),s(se,z),s(ce,e.info?e.info.day+"日目":"ゲーム外")},[()=>e.role?d()(`game.role.${e.role}`):"ゲーム外"]),o(w,c)},Y=w=>{var c=Ba(),x=i(Z(c),2),P=a(x),W=a(P),se=i(a(W),2),le=a(se,!0);t(se),t(W);var ce=i(W,2),V=i(a(ce),2),b=a(V,!0);t(V),t(ce);var T=i(ce,2),I=i(a(T),2),F=a(I,!0);t(I),t(T);var R=i(T,2),ve=i(a(R),2);{var de=h=>{var k=Pa(),E=a(k,!0);t(k),L(G=>s(E,G),[()=>d()(`game.request.${e.request}`)]),o(h,k)};O(ve,h=>{e.request&&h(de)})}t(R),t(P);var me=i(P,2);{var z=h=>{var k=Va(),E=i(Z(k),2),G=a(E,!0);t(E),L(()=>s(G,e.profile)),o(h,k)};O(me,h=>{e.profile&&h(z)})}var Q=i(me,4);be(Q,17,()=>Object.entries(e.info.status_map??{}),he,(h,k)=>{let E=()=>n(k)[0],G=()=>n(k)[1];var M=Ae(),X=Z(M);{var N=S=>{var J=Ka(),v=a(J),y=a(v,!0);t(v);var f=i(v,2),l=a(f,!0);t(f);var u=i(f,2),A=a(u,!0);t(u),t(J),L((m,q)=>{s(y,E()),s(l,m),s(A,q)},[()=>(e.info.role_map??{})[E()]?d()(`game.role.${(e.info.role_map??{})[E()]}`):"",()=>d()(`game.status.${G()}`)]),o(S,J)},C=S=>{var J=Ga(),v=a(J),y=a(v,!0);t(v);var f=i(v,2),l=a(f,!0);t(f);var u=i(f,2),A=a(u);t(u),t(J),L((m,q,U)=>{s(y,E()),s(l,m),s(A,`${q??""}${U??""}`)},[()=>(e.info.role_map??{})[E()]?d()(`game.role.${(e.info.role_map??{})[E()]}`):"",()=>d()(`game.status.${G()}`),()=>e.executedAgents.includes(E())?" (追放)":e.attackedAgents.includes(E())?" (襲撃)":""]),o(S,J)};O(X,S=>{G()===Fe.ALIVE?S(N):S(C,!1)})}o(h,M)});var te=i(Q,2);{var re=h=>{var k=Wa(),E=i(Z(k),2);be(E,17,()=>e.mediumResults,he,(G,M)=>{let X=()=>n(M).day,N=()=>n(M).target,C=()=>n(M).result;var S=Ae(),J=Z(S);{var v=f=>{var l=qa(),u=a(l),A=a(u,!0);t(u);var m=i(u,2),q=a(m);t(m);var U=i(m,2),K=a(U,!0);t(U),t(l),L($=>{s(A,N()),s(q,`(${X()??""}日目)`),s(K,$)},[()=>d()(`game.species.${C()}`)]),o(f,l)},y=f=>{var l=Ua(),u=a(l),A=a(u,!0);t(u);var m=i(u,2),q=a(m);t(m);var U=i(m,2),K=a(U,!0);t(U),t(l),L($=>{s(A,N()),s(q,`(${X()??""}日目)`),s(K,$)},[()=>d()(`game.species.${C()}`)]),o(f,l)};O(J,f=>{C()!==We.HUMAN?f(v):f(y,!1)})}o(G,S)}),o(h,k)};O(te,h=>{e.mediumResults.length>0&&h(re)})}var ue=i(te,2);{var p=h=>{var k=Ja(),E=i(Z(k),2);be(E,17,()=>e.divineResults,he,(G,M)=>{let X=()=>n(M).day,N=()=>n(M).target,C=()=>n(M).result;var S=Ae(),J=Z(S);{var v=f=>{var l=ja(),u=a(l),A=a(u,!0);t(u);var m=i(u,2),q=a(m);t(m);var U=i(m,2),K=a(U,!0);t(U),t(l),L($=>{s(A,N()),s(q,`(${X()??""}日目)`),s(K,$)},[()=>d()(`game.species.${C()}`)]),o(f,l)},y=f=>{var l=Za(),u=a(l),A=a(u,!0);t(u);var m=i(u,2),q=a(m);t(m);var U=i(m,2),K=a(U,!0);t(U),t(l),L($=>{s(A,N()),s(q,`(${X()??""}日目)`),s(K,$)},[()=>d()(`game.species.${C()}`)]),o(f,l)};O(J,f=>{C()!==We.HUMAN?f(v):f(y,!1)})}o(G,S)}),o(h,k)};O(ue,h=>{e.divineResults.length>0&&h(p)})}t(x),L(h=>{s(le,e.agent?e.agent:"ゲーム外"),s(b,h),s(F,e.info?e.info.day+"日目":"ゲーム外")},[()=>e.role?d()(`game.role.${e.role}`):"ゲーム外"]),o(w,c)};O(ae,w=>{var c;(c=n(H))!=null&&c.display.largeScale?w(B):w(Y,!1)})}t(ie),t(ee),o(r,ee),Ve(),D()}function Qa(){He.connect()}function Xa(){He.disconnect()}var $a=_('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),er=_('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),tr=_('<div class="status status-error"></div>'),ar=(r,e)=>e("connection.url",r.currentTarget.value),rr=(r,e)=>e("connection.token",r.currentTarget.value),nr=(r,e)=>e("team",r.currentTarget.value),ir=(r,e)=>e("display.largeScale",r.currentTarget.checked),lr=_('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./"> </a> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow"> <span class="badge badge-neutral badge-xs"> </span></label> <button class="btn btn-info"> </button> <button class="btn btn-error"> </button> <button class="btn"> </button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold"> </h3> <h4 class="text-base font-bold mt-2"> </h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <h3 class="text-lg font-bold mt-4"> </h3> <h4 class="text-base font-bold mt-2"> </h4> <label class="label cursor-pointer my-2"><span class="label-text"> </span> <input type="checkbox" class="checkbox"></label> <h4 class="text-base font-bold mt-2"> </h4> <div class="my-2"><!></div></div></div> <form method="dialog" class="modal-backdrop"><button> </button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function sr(r,e){Pe(e,!0);const[g,D]=je(),d=()=>Ze(Be,"$_",g);let H=ne(void 0),ee=ne(void 0);const ie=Re.subscribe(xe=>{j(H,xe,!0)}),ae=He.subscribe(xe=>{j(ee,xe.status,!0)});Ge(()=>{ie(),ae()});function B(xe,De){Re.update(Me=>{const Le=xe.split("."),ke=Le.pop();let Se=Me;for(const qe of Le)qe&&(Se=Se[qe]);return Se[ke]=De,{...Me}})}let Y;var w=lr(),c=a(w),x=a(c,!0);t(c);var P=i(c,2),W=a(P),se=a(W);{var le=xe=>{var De=$a();we(2),o(xe,De)},ce=(xe,De)=>{{var Me=ke=>{var Se=er();we(2),o(ke,Se)},Le=ke=>{var Se=tr();o(ke,Se)};O(xe,ke=>{n(ee)==="connecting"?ke(Me):ke(Le,!1)},De)}};O(se,xe=>{n(ee)==="connected"?xe(le):xe(ce,!1)})}t(W),t(P);var V=i(P,2),b=a(V);Ye(b,1,"h-[1em] opacity-50"),oe(b,"inline",!0),oe(b,"icon","mdi:link");var T=i(b,2);Oe(T),T.__input=[ar,B],t(V);var I=i(V,2),F=a(I);Ye(F,1,"h-[1em] opacity-50"),oe(F,"inline",!0),oe(F,"icon","mdi:key");var R=i(F,2);Oe(R),R.__input=[rr,B];var ve=i(R,2),de=a(ve,!0);t(ve),t(I);var me=i(I,2);me.__click=[Qa];var z=a(me,!0);t(me);var Q=i(me,2);Q.__click=[Xa];var te=a(Q,!0);t(Q);var re=i(Q,2);re.__click=()=>Y.showModal();var ue=a(re,!0);t(re);var p=i(re,2),h=a(p),k=a(h),E=a(k),G=a(E,!0);t(E);var M=i(E,2),X=a(M,!0);t(M);var N=i(M,2),C=a(N);Ye(C,1,"h-[1em] opacity-50"),oe(C,"inline",!0),oe(C,"icon","mdi:rename");var S=i(C,2);Oe(S),S.__input=[nr,B],t(N);var J=i(N,2),v=a(J,!0);t(J);var y=i(J,2),f=a(y,!0);t(y);var l=i(y,2),u=a(l),A=a(u,!0);t(u);var m=i(u,2);Oe(m),m.__change=[ir,B],t(l);var q=i(l,2),U=a(q,!0);t(q);var K=i(q,2),$=a(K);Ft($,{}),t(K),t(k),t(h);var fe=i(h,2),ye=a(fe),ge=a(ye,!0);t(ye),t(fe),t(p),$e(p,xe=>Y=xe,()=>Y);var _e=i(p,2),Ee=a(_e);oe(Ee,"inline",!0),oe(Ee,"icon","mdi:white-balance-sunny");var ht=i(Ee,2),at=i(ht,2);oe(at,"inline",!0),oe(at,"icon","mdi:moon-and-stars"),t(_e),t(w),L((xe,De,Me,Le,ke,Se,qe,yt,At,It,kt,wt,Tt,St)=>{var rt,nt,it,lt;s(x,xe),Ie(T,"placeholder",De),Ke(T,(rt=n(H))==null?void 0:rt.connection.url),Ie(R,"placeholder",Me),Ke(R,(nt=n(H))==null?void 0:nt.connection.token),s(de,Le),me.disabled=n(ee)!=="disconnected",s(z,ke),Q.disabled=n(ee)==="disconnected",s(te,Se),s(ue,qe),s(G,yt),s(X,At),Ke(S,(it=n(H))==null?void 0:it.team),s(v,It),s(f,kt),s(A,wt),Xe(m,(lt=n(H))==null?void 0:lt.display.largeScale),s(U,Tt),s(ge,St)},[()=>d()("appName"),()=>d()("realtime.websocketUrl"),()=>d()("realtime.authKey"),()=>d()("realtime.optional"),()=>d()("realtime.connect"),()=>d()("realtime.disconnect"),()=>d()("realtime.settings"),()=>d()("agent.agentSettings"),()=>d()("agent.teamName"),()=>d()("realtime.displaySettings"),()=>d()("realtime.largeScreen"),()=>d()("realtime.enable"),()=>d()("common.language"),()=>d()("common.close")]),o(r,w),Ve(),D()}bt(["input","click","change"]);var or=_("<iconify-icon></iconify-icon>",2),vr=_("<iconify-icon></iconify-icon>",2),cr=_('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),ur=_('<div class="chat-image avatar"><div class="w-20 rounded-full"><img></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),_r=_("<iconify-icon></iconify-icon>",2),dr=_("<iconify-icon></iconify-icon>",2),fr=_('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),gr=_('<div class="chat-image avatar"><div class="w-10 rounded-full"><img></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),mr=_('<div class="chat chat-start"><!></div>');function xt(r,e){Pe(e,!0);let g=ne(void 0);Je(()=>{const ie=Re.subscribe(ae=>{j(g,ae,!0)});Ge(ie)});var D=mr(),d=a(D);{var H=ie=>{var ae=ur(),B=Z(ae),Y=a(B),w=a(Y);t(Y),t(B);var c=i(B,2),x=a(c,!0);t(c);var P=i(c,2);{var W=V=>{var b=or();oe(b,"inline",!0),oe(b,"icon","mdi:skip-forward"),o(V,b)},se=(V,b)=>{{var T=F=>{var R=vr();oe(R,"inline",!0),oe(R,"icon","mdi:arrow-u-down-right-bold"),o(F,R)},I=F=>{var R=cr(),ve=a(R,!0);t(R),L(()=>s(ve,e.talk.text)),o(F,R)};O(V,F=>{e.talk.skip?F(T):F(I,!1)},b)}};O(P,V=>{e.talk.over?V(W):V(se,!1)})}var le=i(P,2),ce=a(le);t(le),L(()=>{Ie(w,"src",e.isDefaultProfile?`${ot}${et[e.talk.agent]}`:""),Ie(w,"alt",e.talk.agent),s(x,e.talk.agent),s(ce,`Idx: ${e.talk.idx??""}`)}),o(ie,ae)},ee=ie=>{var ae=gr(),B=Z(ae),Y=a(B),w=a(Y);t(Y),t(B);var c=i(B,2),x=a(c,!0);t(c);var P=i(c,2);{var W=V=>{var b=_r();oe(b,"inline",!0),oe(b,"icon","mdi:skip-forward"),o(V,b)},se=(V,b)=>{{var T=F=>{var R=dr();oe(R,"inline",!0),oe(R,"icon","mdi:arrow-u-down-right-bold"),o(F,R)},I=F=>{var R=fr(),ve=a(R,!0);t(R),L(()=>s(ve,e.talk.text)),o(F,R)};O(V,F=>{e.talk.skip?F(T):F(I,!1)},b)}};O(P,V=>{e.talk.over?V(W):V(se,!1)})}var le=i(P,2),ce=a(le);t(le),L(()=>{Ie(w,"src",e.isDefaultProfile?`${ot}${et[e.talk.agent]}`:""),Ie(w,"alt",e.talk.agent),s(x,e.talk.agent),s(ce,`Idx: ${e.talk.idx??""}`)}),o(ie,ae)};O(d,ie=>{var ae;(ae=n(g))!=null&&ae.display.largeScale?ie(H):ie(ee,!1)})}t(D),o(r,D),Ve()}var xr=_('<input type="radio" name="talk_days" class="tab text-lg font-bold"> <div class="tab-content my-4"></div>',1),pr=_('<div class="tabs tabs-border"></div>'),br=_('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),hr=_('<input type="radio" name="talk_days" class="tab"> <div class="tab-content my-4"></div>',1),yr=_('<div class="tabs tabs-border"></div>'),Ar=_('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),Ir=_('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function pt(r,e){Pe(e,!0);let g=ne(void 0),D=e.agents.every(B=>Object.keys(et).includes(B));Je(()=>{const B=Re.subscribe(Y=>{j(g,Y,!0)});Ge(B)});var d=Ir(),H=a(d),ee=a(H);{var ie=B=>{var Y=br(),w=Z(Y),c=a(w,!0);t(w);var x=i(w,2),P=a(x);{var W=se=>{var le=pr();const ce=Te(()=>[...new Set(e.talks.map(V=>V.day))].sort((V,b)=>b-V));be(le,21,()=>n(ce),he,(V,b)=>{var T=xr(),I=Z(T);Oe(I);var F=i(I,2);be(F,21,()=>e.talks.filter(R=>R.day===n(b)),he,(R,ve)=>{xt(R,{get talk(){return n(ve)},get agents(){return e.agents},isDefaultProfile:D})}),t(F),L(()=>{Xe(I,n(b)===n(ce)[0]),Ie(I,"aria-label",`${n(b)}日目`)}),o(V,T)}),t(le),o(se,le)};O(P,se=>{e.talks.length>0&&se(W)})}t(x),L(()=>s(c,e.header)),o(B,Y)},ae=B=>{var Y=Ar(),w=Z(Y),c=a(w,!0);t(w);var x=i(w,2),P=a(x);{var W=se=>{var le=yr();const ce=Te(()=>[...new Set(e.talks.map(V=>V.day))].sort((V,b)=>b-V));be(le,21,()=>n(ce),he,(V,b)=>{var T=hr(),I=Z(T);Oe(I);var F=i(I,2);be(F,21,()=>e.talks.filter(R=>R.day===n(b)),he,(R,ve)=>{xt(R,{get talk(){return n(ve)},get agents(){return e.agents},isDefaultProfile:D})}),t(F),L(()=>{Xe(I,n(b)===n(ce)[0]),Ie(I,"aria-label",`${n(b)}日目`)}),o(V,T)}),t(le),o(se,le)};O(P,se=>{e.talks.length>0&&se(W)})}t(x),L(()=>s(c,e.header)),o(B,Y)};O(ee,B=>{var Y;(Y=n(g))!=null&&Y.display.largeScale?B(ie):B(ae,!1)})}t(H),t(d),o(r,d),Ve()}var kr=_('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),wr=_('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none"> </pre></div>'),Tr=_('<div role="alert" class="alert m-4"><span class="text-lg font-bold"> </span></div>'),Sr=_('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Wr(r,e){Pe(e,!0);const[g,D]=je(),d=()=>Ze(Be,"$_",g);let H=ne(void 0),ee=ne(""),ie=ne(null),ae=ne(Ne([])),B=ne(null),Y=ne(null),w=ne(null),c=ne(null),x=ne(null),P=ne(Ne([])),W=ne(Ne([])),se=ne(null),le=ne(Ne([])),ce=ne(Ne([])),V=ne(Ne([])),b=ne(Ne([])),T=ne(null),I=ne(null),F=Re.subscribe(p=>{j(H,p,!0)}),R=He.subscribe(p=>{j(ee,p.status,!0),p.deadline?(j(ie,p.deadline.getTime(),!0),de()):(j(ie,null),j(T,null),n(I)&&(cancelAnimationFrame(n(I)),j(I,null))),j(ae,p.entries,!0),j(B,p.agent,!0),j(Y,p.role,!0),j(w,p.profile,!0),j(c,p.request,!0),j(x,p.info,!0),j(P,p.mediumResults,!0),j(W,p.divineResults,!0),j(se,p.setting,!0),j(le,p.talkHistory,!0),j(ce,p.whisperHistory,!0),j(V,p.executedAgents,!0),j(b,p.attackedAgents,!0)});function ve(){const p=Ct.url.searchParams,h=p.get("url"),k=p.get("token");h&&(Re.update(E=>({...E,connection:{url:h??"",token:k??""}})),He.connect())}function de(){if(n(ie)===null)return;const p=()=>{if(n(ie)===null)return;const h=Date.now(),k=Math.max(0,n(ie)-h);j(T,k,!0),k>0?j(I,requestAnimationFrame(p),!0):(j(T,0),j(I,null))};n(I)&&cancelAnimationFrame(n(I)),j(I,requestAnimationFrame(p),!0)}function me(p){He.send(p)}{ve();const p=k=>{n(ee)==="connected"&&k.preventDefault()},h=k=>{n(ee)==="connected"&&k.preventDefault()};window.addEventListener("beforeunload",p),window.addEventListener("popstate",h),Ge(()=>{window.removeEventListener("beforeunload",p),window.removeEventListener("popstate",h),n(I)&&cancelAnimationFrame(n(I)),F(),R()})}var z=Sr(),Q=a(z);sr(Q,{});var te=i(Q,2);{var re=p=>{var h=kr(),k=Z(h),E=a(k);Ya(E,{get agent(){return n(B)},get role(){return n(Y)},get profile(){return n(w)},get request(){return n(c)},get info(){return n(x)},get mediumResults(){return n(P)},get divineResults(){return n(W)},get executedAgents(){return n(V)},get attackedAgents(){return n(b)}});var G=i(E,2);const M=Te(()=>d()("agent.talkHistory")),X=Te(()=>{var v;return Object.keys(((v=n(x))==null?void 0:v.status_map)??{})});pt(G,{get header(){return n(M)},get talks(){return n(le)},get agents(){return n(X)}});var N=i(G,2);{var C=v=>{const y=Te(()=>d()("agent.whisperHistory")),f=Te(()=>{var l;return Object.keys(((l=n(x))==null?void 0:l.status_map)??{})});pt(v,{get header(){return n(y)},get talks(){return n(ce)},get agents(){return n(f)}})};O(N,v=>{n(Y)===Mt.WEREWOLF&&v(C)})}t(k);var S=i(k,2);{var J=v=>{Ta(v,{get remain(){return n(T)},get setting(){return n(se)},get request(){return n(c)},get info(){return n(x)},onSendMessage:me})};O(S,v=>{n(T)!==null&&v(J)})}o(p,h)},ue=(p,h)=>{{var k=G=>{var M=wr(),X=a(M),N=a(X,!0);t(X),t(M),L(C=>s(N,C),[()=>d()("agent.notConnected")]),o(G,M)},E=G=>{var M=Tr(),X=a(M),N=a(X,!0);t(X),t(M),L(C=>s(N,C),[()=>d()("agent.notConnected")]),o(G,M)};O(p,G=>{var M;(M=n(H))!=null&&M.display.largeScale?G(k):G(E,!1)},h)}};O(te,p=>{n(x)!==null?p(re):p(ue,!1)})}t(z),o(r,z),Ve(),D()}export{Wr as component};
