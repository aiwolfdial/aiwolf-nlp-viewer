var Oe=Object.defineProperty;var Le=(t,e,n)=>e in t?Oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Bt=(t,e,n)=>Le(t,typeof e!="symbol"?e+"":e,n);import{t as _,a as u,c as Ut}from"../chunks/HViqgMOa.js";import{p as pe,s as Kt,h as s,i as H,a as ge,aG as Ct,c as a,g as c,f as r,aI as yt,aw as ut,$ as He,x as ue}from"../chunks/DVw0lqtx.js";import{d as be,s as k}from"../chunks/D2z9SdKz.js";import{i as V}from"../chunks/Iz7RvOh6.js";import{e as lt,i as ct}from"../chunks/UHQ7A5qY.js";import{h as Re}from"../chunks/CmhqFjS7.js";import{a as X,r as kt,c as Wt,s as mt,d as de}from"../chunks/EUBOkeHQ.js";import{b as je}from"../chunks/CBoNgZLI.js";import{p as Rt}from"../chunks/CS0_dE9u.js";import{b as he}from"../chunks/xYCJa3Tf.js";import{s as Me,a as Q,b as Mt}from"../chunks/BKjCbnh7.js";import{w as C}from"../chunks/vxh45KTb.js";import{a as xe,o as $e}from"../chunks/CBQtZvgM.js";/* empty css                */class Qt{static fromJson(e){return Ve(JSON.parse(e),ee("AgentSettings"))}static toJson(e){return JSON.stringify(Ue(e,ee("AgentSettings")),null,2)}}function _t(t,e,n,b=""){const j=te(t),R=b?` on ${b}`:"",S=n?` for key "${n}"`:"";throw Error(`Invalid value${S}${R}. Expected ${j} but got ${JSON.stringify(e)}`)}function te(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${te(t[1])}`:`one of [${t.map(e=>te(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function Je(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(n=>e[n.json]={key:n.js,typ:n.typ}),t.jsonToJS=e}return t.jsonToJS}function Fe(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(n=>e[n.js]={key:n.json,typ:n.typ}),t.jsToJSON=e}return t.jsToJSON}function St(t,e,n,b="",j=""){function R(o,h){return typeof o==typeof h?h:_t(o,h,b,j)}function S(o,h){const I=o.length;for(let m=0;m<I;m++){const x=o[m];try{return St(h,x,n)}catch{}}return _t(o,h,b,j)}function dt(o,h){return o.indexOf(h)!==-1?h:_t(o.map(I=>Ft(I)),h,b,j)}function G(o,h){return Array.isArray(h)?h.map(I=>St(I,o,n)):_t(Ft("array"),h,b,j)}function U(o){if(o===null)return null;const h=new Date(o);return isNaN(h.valueOf())?_t(Ft("Date"),o,b,j):h}function M(o,h,I){if(I===null||typeof I!="object"||Array.isArray(I))return _t(Ft(Y||"object"),I,b,j);const m={};return Object.getOwnPropertyNames(o).forEach(x=>{const $=o[x],vt=Object.prototype.hasOwnProperty.call(I,x)?I[x]:void 0;m[$.key]=St(vt,$.typ,n,x,Y)}),Object.getOwnPropertyNames(I).forEach(x=>{Object.prototype.hasOwnProperty.call(o,x)||(m[x]=St(I[x],h,n,x,Y))}),m}if(e==="any")return t;if(e===null)return t===null?t:_t(e,t,b,j);if(e===!1)return _t(e,t,b,j);let Y;for(;typeof e=="object"&&e.ref!==void 0;)Y=e.ref,e=We[e.ref];return Array.isArray(e)?dt(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?S(e.unionMembers,t):e.hasOwnProperty("arrayItems")?G(e.arrayItems,t):e.hasOwnProperty("props")?M(n(e),e.additional,t):_t(e,t,b,j):e===Date&&typeof t!="number"?U(t):R(e,t)}function Ve(t,e){return St(t,e,Je)}function Ue(t,e){return St(t,e,Fe)}function Ft(t){return{literal:t}}function ve(t,e){return{props:t,additional:e}}function ee(t){return{ref:t}}const We={AgentSettings:ve([{json:"connection",js:"connection",typ:ee("Connection")},{json:"team",js:"team",typ:""}],!1),Connection:ve([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1)},fe={connection:{url:"ws://localhost:8080/ws",token:""},team:"default"};function Pe(){const t=localStorage.getItem("agent-settings");if(t)try{return Qt.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",Qt.toJson(fe)),fe}const jt=C(Pe());jt.subscribe(t=>{localStorage.setItem("agent-settings",Qt.toJson(t))});var nt=(t=>(t.NAME="NAME",t.TALK="TALK",t.WHISPER="WHISPER",t.VOTE="VOTE",t.DIVINE="DIVINE",t.GUARD="GUARD",t.ATTACK="ATTACK",t.INITIALIZE="INITIALIZE",t.DAILY_INITIALIZE="DAILY_INITIALIZE",t.DAILY_FINISH="DAILY_FINISH",t.FINISH="FINISH",t))(nt||{});const Ke={NAME:"名前",TALK:"トーク",WHISPER:"囁き",VOTE:"投票",DIVINE:"占い",GUARD:"護衛",ATTACK:"襲撃",INITIALIZE:"ゲーム開始",DAILY_INITIALIZE:"昼開始",DAILY_FINISH:"昼終了",FINISH:"ゲーム終了"};var ne=(t=>(t.HUMAN="HUMAN",t.WEREWOLF="WEREWOLF",t))(ne||{});const Vt={HUMAN:"人間",WEREWOLF:"人狼"};var Pt=(t=>(t.ALIVE="ALIVE",t.DEAD="DEAD",t))(Pt||{});const _e={ALIVE:"生存",DEAD:"死亡"},me={WEREWOLF:"人狼",POSSESSED:"狂人",SEER:"占い師",BODYGUARD:"騎士",VILLAGER:"村人",MEDIUM:"霊媒師"};function Ce(){const{subscribe:t,update:e}=C({status:"disconnected",deadline:null,entries:[],role:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let n=null,b=null,j=null,R=null;jt.subscribe(U=>{b=U});function S(){n&&(n.close(),n=null),R&&(R.clear(),R=null),e(U=>({...U,status:"disconnected",deadline:null,entries:[],role:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]}))}function dt(){if(!b)return;n&&S(),e(M=>({...M,status:"connecting"}));const U=new URL(b.connection.url);b.connection.token&&U.searchParams.set("token",b.connection.token),n=new WebSocket(U),n.onopen=()=>{e(M=>({...M,status:"connected"}))},n.onclose=()=>{S()},n.onerror=()=>{S()},n.onmessage=M=>{try{const Y=Date.now(),o=JSON.parse(M.data);switch(e(h=>{const I=h.entries.slice();I.push(o);const m={...h,entries:I,request:o.request};if(o.info){if(m.info=o.info,o.info.mediumResult){const x=o.info.mediumResult;m.mediumResults.findIndex($=>$.day===x.day&&$.agent===x.agent)<0&&m.mediumResults.push(o.info.mediumResult)}if(o.info.divineResult){const x=o.info.divineResult;m.divineResults.findIndex($=>$.day===x.day&&$.agent===x.agent)<0&&m.divineResults.push(o.info.divineResult)}o.info.executedAgent&&m.executedAgents.push(o.info.executedAgent),o.info.attackedAgent&&m.attackedAgents.push(o.info.attackedAgent)}return o.setting&&(m.setting=o.setting,j=o.setting.actionTimeout),o.talkHistory&&m.talkHistory.push(...o.talkHistory),o.whisperHistory&&m.whisperHistory.push(...o.whisperHistory),o.request===nt.INITIALIZE&&m.info&&m.info.roleMap&&m.info.agent&&(m.role=m.info.roleMap[m.info.agent]),m}),o.request){case nt.NAME:G((b==null?void 0:b.team)||"viewer"+Math.floor(Math.random()*1e3));break;case nt.TALK:case nt.WHISPER:case nt.VOTE:case nt.DIVINE:case nt.GUARD:case nt.ATTACK:R&&R.clear(),R=new Ge(()=>{G("TIMEOUT")},new Date(Y+(j??6e4))),e(h=>({...h,deadline:(R==null?void 0:R.deadline())??null}));break;case nt.FINISH:S();break}}catch(Y){console.error("Failed to parse message:",Y)}}}function G(U){if(R&&(R.clear(),R=null,e(M=>({...M,deadline:null}))),n&&n.readyState===WebSocket.OPEN)try{n.send(U),e(M=>{const Y=M.entries.slice();return Y.push(U),{...M,entries:Y}})}catch(M){console.error("Failed to send message:",M)}}return{subscribe:t,connect:dt,disconnect:S,send:G}}const $t=Ce();class Ge{constructor(e,n){Bt(this,"timeout");Bt(this,"_deadline");this.timeout=setTimeout(e,n.getTime()-new Date().getTime()),this._deadline=n}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}function Ye(){$t.connect()}function Ze(){$t.disconnect()}var qe=_('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),ze=_('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),Xe=_('<div class="status status-error"></div>'),Be=(t,e)=>e("connection.url",t.currentTarget.value),Qe=(t,e)=>e("connection.token",t.currentTarget.value),tn=(t,e)=>e("team",t.currentTarget.value),en=_('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><h1 class="text-3xl font-bold text-nowrap ml-2">aiwolf-nlp-viewer</h1> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="WebSocket URL"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="Authorization Key"> <span class="badge badge-neutral badge-xs">Optional</span></label> <button class="btn btn-info">接続</button> <button class="btn btn-error">切断</button> <button class="btn">設定</button> <dialog class="modal"><div class="modal-box"><div class="form-control"><h3 class="text-lg font-bold mt-2">エージェント設定</h3> <h4 class="text-base font-bold mt-4">チーム名</h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function nn(t,e){pe(e,!0);let n=Ct(void 0),b=Ct(void 0);const j=jt.subscribe(N=>{Kt(n,Rt(N))}),R=$t.subscribe(N=>{Kt(b,Rt(N.status))});xe(()=>{j(),R()});function S(N,Z){jt.update(ft=>{const rt=N.split("."),ht=rt.pop();let tt=ft;for(const it of rt)it&&(tt=tt[it]);return tt[ht]=Z,{...ft}})}let dt;var G=en(),U=s(a(G),2),M=a(U),Y=a(M);{var o=N=>{var Z=qe();yt(2),u(N,Z)},h=N=>{var Z=Ut(),ft=ut(Z);{var rt=tt=>{var it=ze();yt(2),u(tt,it)},ht=tt=>{var it=Xe();u(tt,it)};V(ft,tt=>{c(b)==="connecting"?tt(rt):tt(ht,!1)},!0)}u(N,Z)};V(Y,N=>{c(b)==="connected"?N(o):N(h,!1)})}r(M),r(U);var I=s(U,2),m=a(I);X(m,"class","h-[1em] opacity-50"),X(m,"inline",!0),X(m,"icon","mdi:link");var x=s(m,2);kt(x),x.__input=[Be,S],r(I);var $=s(I,2),vt=a($);X(vt,"class","h-[1em] opacity-50"),X(vt,"inline",!0),X(vt,"icon","mdi:key");var wt=s(vt,2);kt(wt),wt.__input=[Qe,S],yt(2),r($);var pt=s($,2);pt.__click=[Ye];var At=s(pt,2);At.__click=[Ze];var Tt=s(At,2);Tt.__click=()=>dt.showModal();var gt=s(Tt,2),Nt=a(gt),Dt=a(Nt),Ot=s(a(Dt),4),bt=a(Ot);X(bt,"class","h-[1em] opacity-50"),X(bt,"inline",!0),X(bt,"icon","mdi:rename");var It=s(bt,2);kt(It),It.__input=[tn,S],r(Ot),r(Dt),r(Nt),yt(2),r(gt),he(gt,N=>dt=N,()=>dt);var Lt=s(gt,2),Et=a(Lt);X(Et,"inline",!0),X(Et,"icon","mdi:white-balance-sunny");var Ht=s(Et,4);X(Ht,"inline",!0),X(Ht,"icon","mdi:moon-and-stars"),r(Lt),r(G),H(()=>{var N,Z,ft;Wt(x,(N=c(n))==null?void 0:N.connection.url),Wt(wt,(Z=c(n))==null?void 0:Z.connection.token),pt.disabled=c(b)!=="disconnected",At.disabled=c(b)==="disconnected",Wt(It,(ft=c(n))==null?void 0:ft.team)}),u(t,G),ge()}be(["input","click"]);var rn=_('<pre class="bg-primary text-primary-content p-2"> </pre>'),an=_('<pre class="font-bold bg-info text-info-content ml-auto"> </pre>'),on=_('<pre class="font-bold bg-error text-error-content ml-auto"> </pre>'),sn=_('<div class="flex flex-row gap-2"><pre> </pre> <pre> </pre> <!></div>'),ln=_('<pre class="font-bold bg-success text-success-content ml-auto"> </pre>'),cn=_('<pre class="font-bold bg-error text-error-content ml-auto"> </pre>'),un=_('<div class="flex flex-row gap-2"><pre> </pre> <pre> </pre> <!></div>'),dn=_('<div class="p-2"><h2 class="font-bold text-lg">霊能結果</h2> <!></div>'),vn=_('<pre class="font-bold bg-info text-info-content ml-auto"> </pre>'),fn=_('<pre class="font-bold bg-error text-error-content ml-auto"> </pre>'),_n=_('<div class="flex flex-row gap-2"><pre> </pre> <pre> </pre> <!></div>'),mn=_('<div class="p-2"><h2 class="font-bold text-lg">占い結果</h2> <!></div>'),pn=_('<div class="p-2"></div> <!> <!>',1),gn=_('<div class="chat chat-start"><div class="chat-image avatar avatar-placeholder"><div class="bg-neutral text-neutral-content w-12 rounded-full"><span class="text-2xl"> </span></div></div> <div class="chat-header"></div> <div class="chat-bubble bg-base-100 text-pretty break-all"> </div> <pre class="chat-footer opacity-50"> </pre></div>'),bn=_('<input type="radio" name="talk_days" class="tab"> <div class="tab-content bg-base-200 p-2 max-h-96 overflow-y-auto"></div>',1),hn=_('<div class="tabs tabs-border"></div>'),xn=_('<div class="p-2"><h2 class="font-bold text-lg">トーク履歴</h2> <!></div>'),yn=_('<div class="chat chat-start"><div class="chat-image avatar avatar-placeholder"><div class="bg-neutral text-neutral-content w-12 rounded-full"><span class="text-2xl"> </span></div></div> <div class="chat-header"></div> <div class="chat-bubble bg-base-100 text-pretty break-all"> </div> <pre class="chat-footer opacity-50"> </pre></div>'),wn=_('<input type="radio" name="whisper_days" class="tab"> <div class="tab-content bg-base-200 p-2 max-h-96 overflow-y-auto"></div>',1),An=_('<div class="tabs tabs-border"></div>'),In=_('<div class="p-2"><h2 class="font-bold text-lg">囁き履歴</h2> <!></div>'),En=_('<pre class="overflow-x-auto"> </pre> <div class="divider"></div>',1),Sn=_('<span aria-live="polite"> </span>m',1),kn=(t,e,n,b)=>Mt(n,Rt(b())),Tn=_('<button class="btn"> </button>'),Nn=(t,e,n)=>Mt(n,"Skip"),Dn=_('<button class="btn btn-square" aria-label="Skip"><iconify-icon></iconify-icon></button>',2),On=(t,e,n)=>Mt(n,"Over"),Ln=_('<!> <button class="btn btn-square" aria-label="Over"><iconify-icon></iconify-icon></button>',3),Hn=_("<option></option>"),Rn=(t,e,n)=>{$t.send(e()),Mt(n,"")},jn=_('<div class="m-4"><div class="flex gap-2 items-center"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input flex-1" list="agents"> <datalist id="agents"></datalist> <button class="btn btn-square" aria-label="Send"><iconify-icon></iconify-icon></button></div> <progress class="progress" max="100"></progress></div>',2),Mn=_('<main class="h-screen flex flex-col"><!> <div class="flex flex-1 overflow-hidden w-full flex-col"><div class="flex-auto bg-base-300 h-full overflow-hidden"><div class="flex flex-row h-full"><div class="overflow-y-auto px-2 h-full"><pre class="font-bold text-xl p-2"> </pre> <!> <!> <!> <!></div> <button class="cursor-ew-resize w-2 rounded bg-gray-300 hover:bg-gray-400 active:bg-gray-500 transition-colors border-0 my-2" aria-label="Resize"></button> <div class="overflow-y-auto pl-2 h-full"></div></div></div> <!></div></main>');function Bn(t,e){pe(e,!0);const[n,b]=Me(),j=()=>Q(pt,"$deadline",n),R=()=>Q(wt,"$status",n),S=()=>Q(Nt,"$info",n),dt=()=>Q(Tt,"$role",n),G=()=>Q(gt,"$request",n),U=()=>Q(Et,"$executedAgents",n),M=()=>Q(Ht,"$attackedAgents",n),Y=()=>Q(Dt,"$mediumResults",n),o=()=>Q(Ot,"$divineResults",n),h=()=>Q(It,"$talkHistory",n),I=()=>Q(Lt,"$whisperHistory",n),m=()=>Q(At,"$entries",n),x=()=>Q(N,"$remain",n),$=()=>Q(Z,"$message",n),vt=()=>Q(bt,"$setting",n),wt=C(""),pt=C(null),At=C([]),Tt=C(null),gt=C(null),Nt=C(null),Dt=C([]),Ot=C([]),bt=C(null),It=C([]),Lt=C([]),Et=C([]),Ht=C([]),N=C(null),Z=C("");let ft=Ct(void 0),rt,ht=Ct(50),tt=!1,it=null;function ye(l){if(!tt||!it)return;const f=it.getBoundingClientRect(),i=l-f.left,W=f.width;Kt(ht,Rt(Math.min(90,Math.max(10,i/W*100))))}function re(){tt=!0,document.body.style.cursor="ew-resize",document.body.style.userSelect="none";const l=i=>{const W=i instanceof MouseEvent?i.clientX:i.touches[0].clientX;ye(W)},f=()=>{tt=!1,document.body.style.cursor="",document.body.style.userSelect="",window.removeEventListener("mousemove",l),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",f),window.removeEventListener("touchend",f)};window.addEventListener("mousemove",l),window.addEventListener("touchmove",l),window.addEventListener("mouseup",f),window.addEventListener("touchend",f)}function ae(){if(j()!==null){const l=Date.now(),f=Math.max(0,j()-l);N.set(f),f>0?rt=requestAnimationFrame(ae):N.set(0)}return()=>{rt&&cancelAnimationFrame(rt)}}$e(()=>{const l=$t.subscribe(i=>{wt.set(i.status),i.deadline?(pt.set(i.deadline.getTime()),rt&&cancelAnimationFrame(rt),rt=requestAnimationFrame(ae)):(pt.set(null),N.set(null)),At.set(i.entries),Tt.set(i.role),gt.set(i.request),Nt.set(i.info),Dt.set(i.mediumResults),Ot.set(i.divineResults),bt.set(i.setting),It.set(i.talkHistory),Lt.set(i.whisperHistory),Et.set(i.executedAgents),Ht.set(i.attackedAgents)}),f=jt.subscribe(i=>{Kt(ft,Rt(i))});xe(()=>{l(),f(),rt&&cancelAnimationFrame(rt)}),window.addEventListener("beforeunload",i=>{R()==="connecting"&&i.preventDefault()})});var Gt=Mn();Re(l=>{He.title="aiwolf-nlp-viewer"});var oe=a(Gt);nn(oe,{});var se=s(oe,2),Yt=a(se),Zt=a(Yt),Jt=a(Zt),qt=a(Jt),we=a(qt);r(qt);var ie=s(qt,2);{var Ae=l=>{var f=rn(),i=a(f);r(f),H(()=>k(i,`${(S()!==null?S().day+"日目":"ゲーム外")??""} ${Ke[G()]??""}`)),u(l,f)};V(ie,l=>{G()!==null&&l(Ae)})}var le=s(ie,2);{var Ie=l=>{var f=pn(),i=ut(f);lt(i,5,()=>Object.entries(S().statusMap??{}),ct,(T,E)=>{let q=()=>c(E)[0],J=()=>c(E)[1];var D=sn(),F=a(D),P=a(F,!0);r(F);var K=s(F,2),B=a(K,!0);r(K);var v=s(K,2);{var w=A=>{var y=an(),O=a(y,!0);r(y),H(()=>k(O,_e[J()])),u(A,y)},d=A=>{var y=on(),O=a(y);r(y),H(L=>k(O,`${_e[J()]??""}${L??""}`),[()=>U().includes(q())?" (追放)":M().includes(q())?" (襲撃)":""]),u(A,y)};V(v,A=>{J()===Pt.ALIVE?A(w):A(d,!1)})}r(D),H(()=>{k(P,q()),k(B,me[(S().roleMap??{})[q()]]??"-")}),u(T,D)}),r(i);var W=s(i,2);{var et=T=>{var E=dn(),q=s(a(E),2);lt(q,1,Y,ct,(J,D)=>{let F=()=>c(D).day,P=()=>c(D).target,K=()=>c(D).result;var B=un(),v=a(B),w=a(v,!0);r(v);var d=s(v,2),A=a(d);r(d);var y=s(d,2);{var O=p=>{var g=ln(),z=a(g,!0);r(g),H(()=>k(z,Vt[K()])),u(p,g)},L=p=>{var g=cn(),z=a(g,!0);r(g),H(()=>k(z,Vt[K()])),u(p,g)};V(y,p=>{K()===ne.HUMAN?p(O):p(L,!1)})}r(B),H(()=>{k(w,P()),k(A,`(Day${F()??""})`)}),u(J,B)}),r(E),u(T,E)};V(W,T=>{Y().length>0&&T(et)})}var at=s(W,2);{var st=T=>{var E=mn(),q=s(a(E),2);lt(q,1,o,ct,(J,D)=>{let F=()=>c(D).day,P=()=>c(D).target,K=()=>c(D).result;var B=_n(),v=a(B),w=a(v,!0);r(v);var d=s(v,2),A=a(d);r(d);var y=s(d,2);{var O=p=>{var g=vn(),z=a(g,!0);r(g),H(()=>k(z,Vt[K()])),u(p,g)},L=p=>{var g=fn(),z=a(g,!0);r(g),H(()=>k(z,Vt[K()])),u(p,g)};V(y,p=>{K()===ne.HUMAN?p(O):p(L,!1)})}r(B),H(()=>{k(w,P()),k(A,`(Day${F()??""})`)}),u(J,B)}),r(E),u(T,E)};V(at,T=>{o().length>0&&T(st)})}u(l,f)};V(le,l=>{S()!==null&&l(Ie)})}var ce=s(le,2);{var Ee=l=>{var f=xn(),i=s(a(f),2);{var W=et=>{var at=hn();const st=ue(()=>[...new Set(h().map(T=>T.day))].sort((T,E)=>E-T));lt(at,21,()=>c(st),ct,(T,E)=>{var q=bn(),J=ut(q);kt(J);var D=s(J,2);lt(D,5,()=>h().filter(F=>F.day===c(E)),ct,(F,P)=>{let K=()=>c(P).agent,B=()=>c(P).idx,v=()=>c(P).text;var w=gn(),d=a(w),A=a(d),y=a(A),O=a(y,!0);r(y),r(A),r(d);var L=s(d,4),p=a(L,!0);r(L);var g=s(L,2),z=a(g,!0);r(g),r(w),H(ot=>{k(O,ot),k(p,v()),k(z,B())},[()=>{var ot;return Number((ot=K().match(/Agent\[(\d+)\]/))==null?void 0:ot[1])??""}]),u(F,w)}),r(D),H(()=>{de(J,c(E)===c(st)[0]),mt(J,"aria-label",`${c(E)}日目`)}),u(T,q)}),r(at),u(et,at)};V(i,et=>{h().length>0&&et(W)})}r(f),u(l,f)};V(ce,l=>{h().length>0&&l(Ee)})}var Se=s(ce,2);{var ke=l=>{var f=In(),i=s(a(f),2);{var W=et=>{var at=An();const st=ue(()=>[...new Set(I().map(T=>T.day))].sort((T,E)=>E-T));lt(at,21,()=>c(st),ct,(T,E)=>{var q=wn(),J=ut(q);kt(J);var D=s(J,2);lt(D,5,()=>I().filter(F=>F.day===c(E)),ct,(F,P)=>{let K=()=>c(P).agent,B=()=>c(P).idx,v=()=>c(P).text;var w=yn(),d=a(w),A=a(d),y=a(A),O=a(y,!0);r(y),r(A),r(d);var L=s(d,4),p=a(L,!0);r(L);var g=s(L,2),z=a(g,!0);r(g),r(w),H(ot=>{k(O,ot),k(p,v()),k(z,B())},[()=>{var ot;return Number((ot=K().match(/Agent\[(\d+)\]/))==null?void 0:ot[1])??""}]),u(F,w)}),r(D),H(()=>{de(J,c(E)===c(st)[0]),mt(J,"aria-label",`${c(E)}日目`)}),u(T,q)}),r(at),u(et,at)};V(i,et=>{I().length>0&&et(W)})}r(f),u(l,f)};V(Se,l=>{I().length>0&&l(ke)})}r(Jt);var zt=s(Jt,2);zt.__mousedown=re,zt.__touchstart=re;var Xt=s(zt,2);lt(Xt,5,()=>[...m()].reverse(),ct,(l,f)=>{var i=En(),W=ut(i),et=a(W,!0);r(W),yt(2),H(at=>k(et,at),[()=>JSON.stringify(c(f),null,2)]),u(l,i)}),r(Xt),r(Zt),he(Zt,l=>it=l,()=>it),r(Yt);var Te=s(Yt,2);{var Ne=l=>{var f=jn(),i=a(f),W=a(i),et=a(W);{var at=v=>{var w=Sn(),d=ut(w),A=a(d,!0);r(d),yt(),H((y,O)=>{mt(d,"style",`--value:${y??""};`),mt(d,"aria-label",O),k(A,y)},[()=>Math.floor(x()/6e4),()=>Math.floor(x()/6e4).toString()]),u(v,w)};V(et,v=>{x()>6e4&&v(at)})}var st=s(et,2),T=a(st,!0);r(st),yt(),r(W);var E=s(W,2);{var q=v=>{var w=Ut(),d=ut(w);lt(d,1,()=>{var A;return Object.entries(((A=S())==null?void 0:A.statusMap)??{})},ct,(A,y)=>{let O=()=>c(y)[0],L=()=>c(y)[1];var p=Ut(),g=ut(p);{var z=ot=>{var xt=Tn();xt.__click=[kn,$,Z,O];var De=a(xt,!0);r(xt),H(()=>k(De,O())),u(ot,xt)};V(g,ot=>{var xt;L()===Pt.ALIVE&&O()!==((xt=S())==null?void 0:xt.agent)&&ot(z)})}u(A,p)}),u(v,w)},J=v=>{var w=Ln(),d=ut(w);{var A=L=>{var p=Dn();p.__click=[Nn,$,Z];var g=a(p);X(g,"icon","mdi:arrow-u-down-right-bold"),r(p),u(L,p)};V(d,L=>{var p;(((p=vt())==null?void 0:p.maxSkip)??!1)&&L(A)})}var y=s(d,2);y.__click=[On,$,Z];var O=a(y);X(O,"icon","mdi:skip-forward"),r(y),u(v,w)};V(E,v=>{G()===nt.VOTE||G()===nt.DIVINE||G()===nt.GUARD||G()===nt.ATTACK?v(q):v(J,!1)})}var D=s(E,2);kt(D);var F=s(D,2);lt(F,5,()=>{var v;return Object.entries(((v=S())==null?void 0:v.statusMap)??{})},ct,(v,w)=>{let d=()=>c(w)[0],A=()=>c(w)[1];var y=Ut(),O=ut(y);{var L=p=>{var g=Hn(),z={};H(()=>{z!==(z=d())&&(g.value=(g.__value=d())==null?"":d())}),u(p,g)};V(O,p=>{var g;A()===Pt.ALIVE&&d()!==((g=S())==null?void 0:g.agent)&&p(L)})}u(v,y)}),r(F);var P=s(F,2);P.__click=[Rn,$,Z];var K=a(P);X(K,"icon","mdi:send"),r(P),r(i);var B=s(i,2);r(f),H((v,w)=>{var d;mt(st,"style",`--value:${v??""};`),mt(st,"aria-label",w),k(T,v),Wt(B,x()!==null?x()/(((d=vt())==null?void 0:d.actionTimeout)??6e4)*100:0)},[()=>Math.floor(x()%6e4/1e3),()=>Math.floor(x()%6e4/1e3).toString()]),je(D,$,v=>Mt(Z,v)),u(l,f)};V(Te,l=>{x()!==null&&l(Ne)})}r(se),r(Gt),H(()=>{var l;mt(Jt,"style",`width: ${c(ht)??""}%`),k(we,`${((l=S())==null?void 0:l.agent)??"未接続"} ${me[dt()]??""}`),mt(Xt,"style",`width: ${100-c(ht)-.5}%;`)}),u(t,Gt),ge(),b()}be(["mousedown","touchstart","click"]);export{Bn as component};
