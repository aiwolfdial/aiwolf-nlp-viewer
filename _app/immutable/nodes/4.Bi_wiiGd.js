import{t as c,a as s,c as vt,d as bt}from"../chunks/Co3XnC6y.js";import{p as Q,c as n,f as r,i as R,a as X,av as at,g as y,x as kt,h as i,aF as Z,aE as Lt,s as $,$ as Et}from"../chunks/BgVlIibR.js";import{s as N,d as dt}from"../chunks/DYnTS7MI.js";import{i as w}from"../chunks/BuyP8_jq.js";import{e as K,i as q}from"../chunks/RllC1XSL.js";import{h as wt}from"../chunks/BcqNrQiA.js";import{a as L}from"../chunks/IJDf9Saa.js";import{I as At,s as H,c as Tt,R as Ot,t as rt,a as Ut,S as Vt,b as St,T as Rt}from"../chunks/DbXV2oBo.js";import{p as G}from"../chunks/DR9iGoyE.js";/* empty css                */import{p as J,_ as D}from"../chunks/DX9rLxGD.js";import{b as Ct}from"../chunks/CfxdwYC1.js";function ct(m){const g=m.split(/\r?\n/).filter(a=>a.trim()),p={};return g.forEach(a=>{const[l,_,...o]=a.split(",");p[l]||(p[l]=Dt()),Mt(p[l],_,o)}),p}function Dt(){return{agents:{},talks:[],votes:[],execution:null,divine:null,attackVotes:[],attack:null,result:null}}function Mt(m,g,p){const l={status:([_,o,f,b])=>{m.agents[_]={role:o,status:f,name:b}},talk:([_,o,f,b])=>{m.talks.push({talkIdx:_,turnIdx:o,agentIdx:f,text:b})},vote:([_,o])=>{m.votes.push({agentIdx:_,targetIdx:o})},execute:([_,o])=>{m.execution={agentIdx:_,role:o}},divine:([_,o,f])=>{m.divine={agentIdx:_,targetIdx:o,result:f}},attackVote:([_,o])=>{m.attackVotes.push({agentIdx:_,targetIdx:o})},attack:([_,o])=>{m.attack={targetIdx:_,isSuccessful:o==="true"}},result:([_,o,f])=>{m.result={villagers:_,werewolves:o,winSide:f}}}[g];l&&l(p)}var jt=c("<strong> </strong>");function M(m,g){Q(g,!0);let p=J(g,"agentIdx",3,""),a=J(g,"highlight",3,!1);var l=jt(),_=n(l,!0);r(l),R((o,f)=>{H(l,Tt(o),"svelte-dj3b7l"),N(_,f)},[()=>a()?"agent"+p().padStart(2,"0"):"",()=>At(p())]),s(m,l),X()}function zt(m,g){Q(g,!0);let p=J(g,"text",3,"");function a(o){const f=/Agent\[(\d+)\]/g,b=[];let T=0,O;for(;(O=f.exec(o))!==null;)O.index>T&&b.push({text:o.slice(T,O.index),agentIdx:null,isAgentTag:!1}),b.push({text:O[0],agentIdx:parseInt(O[1]),isAgentTag:!0}),T=f.lastIndex;if(T<o.length){var E=o.slice(T);Object.entries(Ot).forEach(([d,u])=>{E=E.replaceAll(d,u)}),b.push({text:E,agentIdx:null,isAgentTag:!1})}return{parts:b}}var l=vt(),_=at(l);K(_,17,()=>a(p()).parts,q,(o,f)=>{var b=vt(),T=at(b);{var O=d=>{const u=kt(()=>{var x;return((x=y(f).agentIdx)==null?void 0:x.toString())??""});M(d,{get agentIdx(){return y(u)},highlight:!0})},E=d=>{var u=bt();R(()=>N(u,y(f).text)),s(d,u)};w(T,d=>{y(f).isAgentTag?d(O):d(E,!1)})}s(o,b)}),s(m,l),X()}var Pt=c("<iconify-icon></iconify-icon>",2),Nt=c("<iconify-icon></iconify-icon>",2),Ft=c("<iconify-icon></iconify-icon>",2),Kt=c("<iconify-icon></iconify-icon>",2),qt=c("<iconify-icon></iconify-icon>",2),Wt=c("<iconify-icon></iconify-icon>",2),Bt=c("<iconify-icon></iconify-icon>",2),Gt=c("<li><!> </li>"),Ht=c('<div><h3 class="text-lg font-bold my-2">エージェント</h3> <ul></ul></div>'),Jt=c("<li><!> <!></li>"),Qt=c('<div><h3 class="text-lg font-bold my-2">会話</h3> <ul></ul></div>'),Xt=c("<li><!> が <!> に投票</li>"),Yt=c('<div><h3 class="text-lg font-bold my-2">投票</h3> <ul></ul></div>'),Zt=c('<div><h3 class="text-lg font-bold my-2">追放</h3> <p><!> を追放</p></div>'),$t=c("<li><!> が <!> に投票</li>"),te=c('<div><h3 class="text-lg font-bold my-2">襲撃投票</h3> <ul></ul></div>'),ee=c("<p><!> を襲撃: <strong> </strong></p>"),ae=c("<p>襲撃対象なし</p>"),re=c('<div><h3 class="text-lg font-bold my-2">襲撃</h3> <!></div>'),ie=c('<div><h3 class="text-lg font-bold my-2">占い</h3> <p><!> が <!> を占い: <strong> </strong></p></div>'),oe=c('<div><h3 class="text-lg font-bold my-2">結果</h3> <p><strong> </strong> が勝利</p></div>'),ne=c('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><h2 class="text-xl font-bold pb-2"> <!> <!> <!> <!> <!> <!> <!></h2> <div class="grow overflow-y-auto pr-4"><!> <!> <!> <!> <!> <!> <!> <!></div></div></div>');function se(m,g){Q(g,!0);let p=J(g,"dayIdx",3,""),a=J(g,"dayStatus",19,()=>({}));var l=ne(),_=n(l),o=n(_),f=n(o),b=i(f);{var T=t=>{var e=Pt();L(e,"inline",!0),L(e,"icon","mdi:conversation"),s(t,e)};w(b,t=>{a().talks.length>0&&t(T)})}var O=i(b,2);{var E=t=>{var e=Nt();L(e,"inline",!0),L(e,"icon","mdi:vote"),s(t,e)};w(O,t=>{a().votes.length>0&&t(E)})}var d=i(O,2);{var u=t=>{var e=Ft();L(e,"inline",!0),L(e,"icon","mdi:account-remove"),s(t,e)};w(d,t=>{a().execution&&t(u)})}var x=i(d,2);{var S=t=>{var e=Kt();L(e,"inline",!0),L(e,"icon","mdi:vote"),s(t,e)};w(x,t=>{a().attackVotes.length>0&&t(S)})}var V=i(x,2);{var F=t=>{var e=qt();L(e,"inline",!0),L(e,"icon","mdi:sword"),s(t,e)};w(V,t=>{a().attack&&t(F)})}var P=i(V,2);{var j=t=>{var e=Wt();L(e,"inline",!0),L(e,"icon","mdi:account-eye"),s(t,e)};w(P,t=>{a().divine&&t(j)})}var z=i(P,2);{var W=t=>{var e=Bt();L(e,"inline",!0),L(e,"icon","mdi:trophy"),s(t,e)};w(z,t=>{a().result&&t(W)})}r(o);var Y=i(o,2),B=n(Y);{var tt=t=>{var e=Ht(),h=i(n(e),2);K(h,21,()=>Object.entries(a().agents),q,(A,I)=>{let v=()=>y(I)[0],k=()=>y(I)[1];var U=Gt(),C=n(U);M(C,{get agentIdx(){return v()}});var et=i(C);r(U),R(yt=>{H(U,`${yt??""} svelte-1xvg87g`),rt(U,"opacity-25",k().status!=="ALIVE"),N(et,` ${Ut[k().role]??"NULL"} -
                ${Vt[k().status]??"NULL"}`)},[()=>"p-2 my-2 border-4 rounded-md agent"+v().padStart(2,"0")]),s(A,U)}),r(h),r(e),s(t,e)};w(B,t=>{Object.keys(a().agents).length>0&&t(tt)})}var it=i(B,2);{var ut=t=>{var e=Qt(),h=i(n(e),2);K(h,21,()=>a().talks,q,(A,I)=>{var v=Jt(),k=n(v);M(k,{get agentIdx(){return y(I).agentIdx}});var U=i(k,2);zt(U,{get text(){return y(I).text}}),r(v),R(C=>{H(v,`${C??""} svelte-1xvg87g`),rt(v,"opacity-25",y(I).text==="Over")},[()=>"p-2 my-2 border-4 rounded-md agent"+y(I).agentIdx.padStart(2,"0")]),s(A,v)}),r(h),r(e),s(t,e)};w(it,t=>{a().talks.length>0&&t(ut)})}var ot=i(it,2);{var gt=t=>{var e=Yt(),h=i(n(e),2);K(h,21,()=>a().votes,q,(A,I)=>{var v=Xt(),k=n(v);M(k,{get agentIdx(){return y(I).agentIdx}});var U=i(k,2);M(U,{get agentIdx(){return y(I).targetIdx},highlight:!0}),Z(),r(v),R(C=>H(v,`${C??""} svelte-1xvg87g`),[()=>"p-2 my-2 border-4 rounded-md agent"+y(I).agentIdx.padStart(2,"0")]),s(A,v)}),r(h),r(e),s(t,e)};w(ot,t=>{a().votes.length>0&&t(gt)})}var nt=i(ot,2);{var ft=t=>{var e=Zt(),h=i(n(e),2),A=n(h);M(A,{get agentIdx(){return a().execution.agentIdx},highlight:!0}),Z(),r(h),r(e),s(t,e)};w(nt,t=>{a().execution&&t(ft)})}var st=i(nt,2);{var pt=t=>{var e=te(),h=i(n(e),2);K(h,21,()=>a().attackVotes,q,(A,I)=>{var v=$t(),k=n(v);M(k,{get agentIdx(){return y(I).agentIdx}});var U=i(k,2);M(U,{get agentIdx(){return y(I).targetIdx},highlight:!0}),Z(),r(v),R(C=>H(v,`${C??""} svelte-1xvg87g`),[()=>"p-2 my-2 border-4 rounded-md agent"+y(I).agentIdx.padStart(2,"0")]),s(A,v)}),r(h),r(e),s(t,e)};w(st,t=>{a().attackVotes.length>0&&t(pt)})}var lt=i(st,2);{var xt=t=>{var e=re(),h=i(n(e),2);{var A=v=>{var k=ee(),U=n(k);M(U,{get agentIdx(){return a().attack.targetIdx},highlight:!0});var C=i(U,2),et=n(C,!0);r(C),r(k),R(()=>N(et,a().attack.isSuccessful?"成功":"失敗")),s(v,k)},I=v=>{var k=ae();s(v,k)};w(h,v=>{a().attack.targetIdx!=="-1"?v(A):v(I,!1)})}r(e),s(t,e)};w(lt,t=>{a().attack&&t(xt)})}var _t=i(lt,2);{var mt=t=>{var e=ie(),h=i(n(e),2),A=n(h);M(A,{get agentIdx(){return a().divine.agentIdx},highlight:!0});var I=i(A,2);M(I,{get agentIdx(){return a().divine.targetIdx},highlight:!0});var v=i(I,2),k=n(v,!0);r(v),r(h),r(e),R(()=>N(k,St[a().divine.result]??"NULL")),s(t,e)};w(_t,t=>{a().divine&&t(mt)})}var ht=i(_t,2);{var It=t=>{var e=oe(),h=i(n(e),2),A=n(h),I=n(A,!0);r(A),Z(),r(h),r(e),R(()=>N(I,Rt[a().result.winSide])),s(t,e)};w(ht,t=>{a().result&&t(It)})}r(Y),r(_),r(l),R(()=>N(f,`Day ${p()??""} `)),s(m,l),X()}var le=c("<option> </option>"),_e=c('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><h1 class="text-3xl font-bold text-nowrap ml-2">aiwolf-nlp-viewer</h1> <select class="select min-w-3xs w-3xs ml-auto"><option>サンプルログを選択</option><!></select> <input class="file-input min-w-3xs w-3xs" type="file" accept=".log" multiple> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function ve(m,g){Q(g,!0);const p=Object.entries(Object.assign({"/static/assets/1734125235_kanolab_Mille_UEC-IL_sUper_IL_satozaki.log":()=>D(()=>import("../chunks/CxPUTjnS.js"),[],import.meta.url),"/static/assets/1734126573_Mille_kanolab_sUper_IL_satozaki_UEC-IL.log":()=>D(()=>import("../chunks/Ch4hCXju.js"),[],import.meta.url),"/static/assets/1734322165_satozaki_Mille_sUper_IL_kanolab_barneko.log":()=>D(()=>import("../chunks/D6Ada88o.js"),[],import.meta.url),"/static/assets/1734322532_barneko_Mille_satozaki_kanolab_sUper_IL.log":()=>D(()=>import("../chunks/BmNzAw4g.js"),[],import.meta.url),"/static/assets/1734328995_CanisLupus_barneko_Mille_satozaki_sUper_IL.log":()=>D(()=>import("../chunks/Dh5zF3NH.js"),[],import.meta.url),"/static/assets/1734329414_Mille_UEC-IL_kanolab_CanisLupus_satozaki.log":()=>D(()=>import("../chunks/B-nbrCmY.js"),[],import.meta.url),"/static/assets/1734329757_UEC-IL_sUper_IL_barneko_CanisLupus_satozaki.log":()=>D(()=>import("../chunks/CZBC5jrw.js"),[],import.meta.url),"/static/assets/1734335625_satozaki_CanisLupus_UEC-IL_sUper_IL_barneko.log":()=>D(()=>import("../chunks/JWZkbpfe.js"),[],import.meta.url),"/static/assets/1734336483_Mille_barneko_sUper_IL_satozaki_UEC-IL.log":()=>D(()=>import("../chunks/gGfePD1C.js"),[],import.meta.url),"/static/assets/1734336998_sUper_IL_satozaki_CanisLupus_kanolab_Mille.log":()=>D(()=>import("../chunks/oHz1b7i6.js"),[],import.meta.url),"/static/assets/1734339025_Mille_kanolab_CanisLupus_sUper_IL_satozaki.log":()=>D(()=>import("../chunks/K60EV997.js"),[],import.meta.url)})).reduce((E,[d,u])=>{const x=d.split("/").pop()||"";return{...E,[x]:`${Ct}${d.replace("/static","")}`}},{});var a=_e(),l=i(n(a),2);l.__change=E=>{const d=E.currentTarget.value;d&&(g.loadAssetLog(p[d],d),E.currentTarget.value="")};var _=n(l);_.value=((_.__value="")==null,"");var o=i(_);K(o,17,()=>Object.entries(p),q,(E,d)=>{let u=()=>y(d)[0];var x=le(),S={},V=n(x,!0);r(x),R(()=>{S!==(S=u())&&(x.value=(x.__value=u())==null?"":u()),N(V,u())}),s(E,x)}),r(l);var f=i(l,2);f.__change=function(...E){var d;(d=g.handleFileSelect)==null||d.apply(this,E)};var b=i(f,2),T=n(b);L(T,"inline",!0),L(T,"icon","mdi:white-balance-sunny");var O=i(T,4);L(O,"inline",!0),L(O,"icon","mdi:moon-and-stars"),r(b),r(a),s(m,a),X()}dt(["change"]);var ce=(m,g,p)=>$(g,G(p())),de=(m,g,p)=>g(p()),ue=c('<div class="w-fit shrink-0 flex gap-0"><button class="btn"> </button> <button class="btn btn-error btn-square" aria-label="Close tab"><iconify-icon></iconify-icon></button></div>',2),ge=c('<div class="w-full shrink-0 overflow-x-auto flex gap-4 m-4"></div> <div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"></div>',1),fe=c('<main class="h-screen flex flex-col"><!> <div class="w-full h-full flex flex-col overflow-hidden bg-base-300"><!></div></main>');function Te(m,g){Q(g,!0);let p={records:{},selectedKey:""},a=G(p.records),l=Lt(G(p.selectedKey));function _(u){const x=u.target;Array.from(x.files||[]).forEach(V=>{const F=new FileReader;F.onload=P=>{var z;const j=((z=P.target)==null?void 0:z.result)??"";a[V.name]=ct(j),$(l,G(V.name))},F.readAsText(V)}),x&&(x.value="")}function o(u){delete a[u],$(l,G(Object.keys(a)[0]||""))}async function f(u,x){try{const V=await(await fetch(u)).text();a[x]=ct(V),$(l,G(x))}catch(S){console.error("Error loading asset log:",S)}}var b=fe();wt(u=>{Et.title="aiwolf-nlp-viewer"});var T=n(b);ve(T,{loadAssetLog:f,handleFileSelect:_});var O=i(T,2),E=n(O);{var d=u=>{var x=ge(),S=at(x);K(S,21,()=>Object.entries(a),q,(F,P)=>{let j=()=>y(P)[0];var z=ue(),W=n(z);W.__click=[ce,l,j];var Y=n(W,!0);r(W);var B=i(W,2);B.__click=[de,o,j];var tt=n(B);L(tt,"icon","mdi:close"),r(B),r(z),R(()=>{rt(W,"btn-active",y(l)===j()),N(Y,j())}),s(F,z)}),r(S);var V=i(S,2);K(V,21,()=>Object.entries(a[y(l)]),q,(F,P)=>{let j=()=>y(P)[0],z=()=>y(P)[1];se(F,{get dayIdx(){return j()},get dayStatus(){return z()}})}),r(V),s(u,x)};w(E,u=>{Object.keys(a).length>0&&u(d)})}r(O),r(b),s(m,b),X()}dt(["click"]);export{Te as component};
