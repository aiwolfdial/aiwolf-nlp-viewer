import{p as Y,_ as M}from"../chunks/B_Zuiqjk.js";import{t as d,a as v,d as ut,b as Et}from"../chunks/D1-2HBWE.js";import{i as at}from"../chunks/YxGi1cMD.js";import{k as Tt,av as At,p as rt,c,r as s,x as S,N as K,a as it,ai as dt,i as n,s as o,aH as tt,$ as wt,w as ft,j as J}from"../chunks/CeyBd2Nv.js";import{s as N}from"../chunks/TjTo9LhE.js";import{i as L}from"../chunks/DpkoRr6P.js";import{e as H,i as W}from"../chunks/DRqcREdK.js";import{h as Ut,e as et}from"../chunks/sQXm3MJV.js";import{I as Ot,c as X,R as Vt,a as A,t as nt,d as St,S as Rt,e as Dt,T as Ct}from"../chunks/B8prnrLd.js";import{b as Mt}from"../chunks/CJbdu2BS.js";/* empty css                */function ht(r){var _,i,t="";if(typeof r=="string"||typeof r=="number")t+=r;else if(typeof r=="object")if(Array.isArray(r)){var g=r.length;for(_=0;_<g;_++)r[_]&&(i=ht(r[_]))&&(t&&(t+=" "),t+=i)}else for(i in r)r[i]&&(t&&(t+=" "),t+=i);return t}function zt(){for(var r,_,i=0,t="",g=arguments.length;i<g;i++)(r=arguments[i])&&(_=ht(r))&&(t&&(t+=" "),t+=_);return t}function Pt(r){return typeof r=="object"?zt(r):r??""}function jt(r,_,i){var t=Tt(r,_);t&&t.set&&(r[_]=i,At(()=>{r[_]=null}))}var Ft=d("<strong> </strong>");function z(r,_){rt(_,!1);let i=Y(_,"agentIdx",8),t=Y(_,"highlight",8,!1);at();var g=Ft(),f=c(g,!0);s(g),S((l,m)=>{X(g,Pt(l),"svelte-2m8qed"),N(f,m)},[()=>t()?"agent"+i().padStart(2,"0"):"",()=>Ot(i())],K),v(r,g),it()}function Nt(r,_){rt(_,!1);let i=Y(_,"text",8);function t(l){const m=/Agent\[(\d+)\]/g,y=[];let O=0,T;for(;(T=m.exec(l))!==null;)T.index>O&&y.push({text:l.slice(O,T.index),agentIdx:null,isAgentTag:!1}),y.push({text:T[0],agentIdx:parseInt(T[1]),isAgentTag:!0}),O=m.lastIndex;if(O<l.length){var R=l.slice(O);Object.entries(Vt).forEach(([V,P])=>{R=R.replaceAll(V,P)}),y.push({text:R,agentIdx:null,isAgentTag:!1})}return{parts:y}}at();var g=ut(),f=dt(g);return H(f,1,()=>t(i()).parts,W,(l,m)=>{var y=ut(),O=dt(y);{var T=V=>{const P=K(()=>{var B;return((B=n(m).agentIdx)==null?void 0:B.toString())??""});z(V,{get agentIdx(){return n(P)},highlight:!0})},R=V=>{var P=Et();S(()=>N(P,n(m).text)),v(V,P)};L(O,V=>{n(m).isAgentTag?V(T):V(R,!1)})}v(l,y)}),v(r,g),jt(_,"formatTalkText",t),it({formatTalkText:t})}var qt=d("<iconify-icon></iconify-icon>",2),Ht=d("<iconify-icon></iconify-icon>",2),Wt=d("<iconify-icon></iconify-icon>",2),Bt=d("<iconify-icon></iconify-icon>",2),Gt=d("<iconify-icon></iconify-icon>",2),Jt=d("<iconify-icon></iconify-icon>",2),Kt=d("<iconify-icon></iconify-icon>",2),Qt=d("<li><!> </li>"),Xt=d('<section class="agent-section"><h3 class="svelte-1cf5h64">エージェント</h3> <ul class="svelte-1cf5h64"></ul></section>'),Yt=d("<li><!> <!></li>"),Zt=d('<section class="talks-section"><h3 class="svelte-1cf5h64">会話</h3> <ul class="talks svelte-1cf5h64"></ul></section>'),$t=d("<li><!> が <!> に投票</li>"),te=d('<section class="votes-section"><h3 class="svelte-1cf5h64">投票</h3> <ul class="svelte-1cf5h64"></ul></section>'),ee=d('<section class="execution-section"><h3 class="svelte-1cf5h64">追放</h3> <p><!> を追放</p></section>'),ae=d("<li><!> が <!> に投票</li>"),re=d('<section class="attack-votes-section"><h3 class="svelte-1cf5h64">襲撃投票</h3> <ul class="svelte-1cf5h64"></ul></section>'),ie=d("<p><!> を襲撃: <strong> </strong></p>"),se=d("<p>襲撃対象なし</p>"),oe=d('<section class="attack-section"><h3 class="svelte-1cf5h64">襲撃</h3> <!></section>'),ne=d('<section class="divine-section"><h3 class="svelte-1cf5h64">占い</h3> <p><!> が <!> を占い: <strong> </strong></p></section>'),le=d('<section class="result-section"><h3 class="svelte-1cf5h64">結果</h3> <p><strong> </strong> が勝利</p></section>'),ce=d('<div class="day-column svelte-1cf5h64"><div class="day-section svelte-1cf5h64"><h2 class="svelte-1cf5h64"> <!> <!> <!> <!> <!> <!> <!></h2> <div class="scrollable-content svelte-1cf5h64"><!> <!> <!> <!> <!> <!> <!> <!></div></div></div>');function _e(r,_){rt(_,!1);let i=Y(_,"dayIdx",8),t=Y(_,"dayStatus",8);at();var g=ce(),f=c(g),l=c(f),m=c(l),y=o(m);{var O=e=>{var a=qt();A(a,"inline",!0),A(a,"icon","mdi:conversation"),v(e,a)};L(y,e=>{t().talks.length>0&&e(O)})}var T=o(y,2);{var R=e=>{var a=Ht();A(a,"inline",!0),A(a,"icon","mdi:vote"),v(e,a)};L(T,e=>{t().votes.length>0&&e(R)})}var V=o(T,2);{var P=e=>{var a=Wt();A(a,"inline",!0),A(a,"icon","mdi:account-remove"),v(e,a)};L(V,e=>{t().execution&&e(P)})}var B=o(V,2);{var st=e=>{var a=Bt();A(a,"inline",!0),A(a,"icon","mdi:vote"),v(e,a)};L(B,e=>{t().attackVotes.length>0&&e(st)})}var I=o(B,2);{var k=e=>{var a=Gt();A(a,"inline",!0),A(a,"icon","mdi:sword"),v(e,a)};L(I,e=>{t().attack&&e(k)})}var h=o(I,2);{var w=e=>{var a=Jt();A(a,"inline",!0),A(a,"icon","mdi:account-eye"),v(e,a)};L(h,e=>{t().divine&&e(w)})}var j=o(h,2);{var q=e=>{var a=Kt();A(a,"inline",!0),A(a,"icon","mdi:trophy"),v(e,a)};L(j,e=>{t().result&&e(q)})}s(l);var F=o(l,2),D=c(F);{var G=e=>{var a=Xt(),p=o(c(a),2);H(p,5,()=>Object.entries(t().agents),W,(E,x)=>{let u=()=>n(x)[0],b=()=>n(x)[1];var U=Qt(),C=c(U);z(C,{get agentIdx(){return u()}});var ot=o(C);s(U),S(Lt=>{X(U,`${Lt??""} svelte-1cf5h64`),nt(U,"over",b().status!=="ALIVE"),N(ot,` ${St[b().role]??"NULL"} -
                ${Rt[b().status]??"NULL"}`)},[()=>"agent"+u().padStart(2,"0")],K),v(E,U)}),s(p),s(a),v(e,a)};L(D,e=>{Object.keys(t().agents).length>0&&e(G)})}var Z=o(D,2);{var Q=e=>{var a=Zt(),p=o(c(a),2);H(p,5,()=>t().talks,W,(E,x)=>{var u=Yt(),b=c(u);z(b,{get agentIdx(){return n(x).agentIdx}});var U=o(b,2);Nt(U,{get text(){return n(x).text}}),s(u),S(C=>{X(u,`${C??""} svelte-1cf5h64`),nt(u,"over",n(x).text==="Over")},[()=>"talk agent"+n(x).agentIdx.padStart(2,"0")],K),v(E,u)}),s(p),s(a),v(e,a)};L(Z,e=>{t().talks.length>0&&e(Q)})}var $=o(Z,2);{var pt=e=>{var a=te(),p=o(c(a),2);H(p,5,()=>t().votes,W,(E,x)=>{var u=$t(),b=c(u);z(b,{get agentIdx(){return n(x).agentIdx}});var U=o(b,2);z(U,{get agentIdx(){return n(x).targetIdx},highlight:!0}),tt(),s(u),S(C=>X(u,`${C??""} svelte-1cf5h64`),[()=>"agent"+n(x).agentIdx.padStart(2,"0")],K),v(E,u)}),s(p),s(a),v(e,a)};L($,e=>{t().votes.length>0&&e(pt)})}var lt=o($,2);{var xt=e=>{var a=ee(),p=o(c(a),2),E=c(p);z(E,{get agentIdx(){return t().execution.agentIdx},highlight:!0}),tt(),s(p),s(a),v(e,a)};L(lt,e=>{t().execution&&e(xt)})}var ct=o(lt,2);{var mt=e=>{var a=re(),p=o(c(a),2);H(p,5,()=>t().attackVotes,W,(E,x)=>{var u=ae(),b=c(u);z(b,{get agentIdx(){return n(x).agentIdx}});var U=o(b,2);z(U,{get agentIdx(){return n(x).targetIdx},highlight:!0}),tt(),s(u),S(C=>X(u,`${C??""} svelte-1cf5h64`),[()=>"agent"+n(x).agentIdx.padStart(2,"0")],K),v(E,u)}),s(p),s(a),v(e,a)};L(ct,e=>{t().attackVotes.length>0&&e(mt)})}var _t=o(ct,2);{var It=e=>{var a=oe(),p=o(c(a),2);{var E=u=>{var b=ie(),U=c(b);z(U,{get agentIdx(){return t().attack.targetIdx},highlight:!0});var C=o(U,2),ot=c(C,!0);s(C),s(b),S(()=>N(ot,t().attack.isSuccessful?"成功":"失敗")),v(u,b)},x=u=>{var b=se();v(u,b)};L(p,u=>{t().attack.targetIdx!=="-1"?u(E):u(x,!1)})}s(a),v(e,a)};L(_t,e=>{t().attack&&e(It)})}var vt=o(_t,2);{var kt=e=>{var a=ne(),p=o(c(a),2),E=c(p);z(E,{get agentIdx(){return t().divine.agentIdx},highlight:!0});var x=o(E,2);z(x,{get agentIdx(){return t().divine.targetIdx},highlight:!0});var u=o(x,2),b=c(u,!0);s(u),s(p),s(a),S(()=>N(b,Dt[t().divine.result]??"NULL")),v(e,a)};L(vt,e=>{t().divine&&e(kt)})}var bt=o(vt,2);{var yt=e=>{var a=le(),p=o(c(a),2),E=c(p),x=c(E,!0);s(E),tt(),s(p),s(a),S(()=>N(x,Ct[t().result.winSide])),v(e,a)};L(bt,e=>{t().result&&e(yt)})}s(F),s(f),s(g),S(()=>N(m,`Day ${i()??""} `)),v(r,g),it()}function gt(r){const _=r.split(/\r?\n/).filter(t=>t.trim()),i={};return _.forEach(t=>{const[g,f,...l]=t.split(",");i[g]||(i[g]=ve()),ue(i[g],f,l)}),i}function ve(){return{agents:{},talks:[],votes:[],execution:null,divine:null,attackVotes:[],attack:null,result:null}}function ue(r,_,i){const g={status:([f,l,m,y])=>{r.agents[f]={role:l,status:m,name:y}},talk:([f,l,m,y])=>{r.talks.push({talkIdx:f,turnIdx:l,agentIdx:m,text:y})},vote:([f,l])=>{r.votes.push({agentIdx:f,targetIdx:l})},execute:([f,l])=>{r.execution={agentIdx:f,role:l}},divine:([f,l,m])=>{r.divine={agentIdx:f,targetIdx:l,result:m}},attackVote:([f,l])=>{r.attackVotes.push({agentIdx:f,targetIdx:l})},attack:([f,l])=>{r.attack={targetIdx:f,isSuccessful:l==="true"}},result:([f,l,m])=>{r.result={villagers:f,werewolves:l,winSide:m}}}[_];g&&g(i)}var de=d("<option> </option>"),fe=d('<div class="w-fit shrink-0 flex gap-0"><button class="btn"> </button> <button class="btn btn-error btn-square" aria-label="Close tab"><iconify-icon></iconify-icon></button></div>',2),ge=d('<div class="w-full h-full flex flex-col overflow-hidden"><div class="w-full shrink-0 overflow-x-auto flex gap-4 m-4"></div> <div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"></div></div>'),he=d('<main class="h-screen flex flex-col"><div class="navbar bg-base-100 flex justify-start"><h1 class="text-3xl font-bold truncate mx-4">aiwolf-nlp-viewer</h1> <select class="select w-full max-w-xs ml-auto"><option>サンプルログを選択</option><!></select> <input class="file-input w-full max-w-xs mx-2" type="file" accept=".log" multiple></div> <!></main>');function we(r,_){rt(_,!1);let i=ft([]),t=ft(0);function g(I){const k=I.target;Array.from(k.files||[]).forEach(w=>{const j=new FileReader;j.onload=q=>{var D;const F=((D=q.target)==null?void 0:D.result)??"";J(i,[...n(i),{name:w.name,data:gt(F)}]),J(t,n(i).length-1)},j.readAsText(w)}),k&&(k.value="")}function f(I){J(i,n(i).filter((k,h)=>h!==I)),n(t)>=n(i).length&&J(t,n(i).length-1)}const l=Object.entries(Object.assign({"/static/assets/1734125235_kanolab_Mille_UEC-IL_sUper_IL_satozaki.log":()=>M(()=>import("../chunks/CxPUTjnS.js"),[],import.meta.url),"/static/assets/1734126573_Mille_kanolab_sUper_IL_satozaki_UEC-IL.log":()=>M(()=>import("../chunks/Ch4hCXju.js"),[],import.meta.url),"/static/assets/1734322165_satozaki_Mille_sUper_IL_kanolab_barneko.log":()=>M(()=>import("../chunks/D6Ada88o.js"),[],import.meta.url),"/static/assets/1734322532_barneko_Mille_satozaki_kanolab_sUper_IL.log":()=>M(()=>import("../chunks/BmNzAw4g.js"),[],import.meta.url),"/static/assets/1734328995_CanisLupus_barneko_Mille_satozaki_sUper_IL.log":()=>M(()=>import("../chunks/Dh5zF3NH.js"),[],import.meta.url),"/static/assets/1734329414_Mille_UEC-IL_kanolab_CanisLupus_satozaki.log":()=>M(()=>import("../chunks/B-nbrCmY.js"),[],import.meta.url),"/static/assets/1734329757_UEC-IL_sUper_IL_barneko_CanisLupus_satozaki.log":()=>M(()=>import("../chunks/CZBC5jrw.js"),[],import.meta.url),"/static/assets/1734335625_satozaki_CanisLupus_UEC-IL_sUper_IL_barneko.log":()=>M(()=>import("../chunks/JWZkbpfe.js"),[],import.meta.url),"/static/assets/1734336483_Mille_barneko_sUper_IL_satozaki_UEC-IL.log":()=>M(()=>import("../chunks/gGfePD1C.js"),[],import.meta.url),"/static/assets/1734336998_sUper_IL_satozaki_CanisLupus_kanolab_Mille.log":()=>M(()=>import("../chunks/oHz1b7i6.js"),[],import.meta.url),"/static/assets/1734339025_Mille_kanolab_CanisLupus_sUper_IL_satozaki.log":()=>M(()=>import("../chunks/K60EV997.js"),[],import.meta.url)})).map(([I,k])=>({name:I.split("/").pop()||"",path:`${Mt}${I.replace("/static","")}`}));async function m(I,k){try{const w=await(await fetch(I)).text();J(i,[...n(i),{name:k,data:gt(w)}]),J(t,n(i).length-1)}catch(h){console.error("Error loading asset log:",h)}}at();var y=he();Ut(I=>{wt.title="aiwolf-nlp-viewer"});var O=c(y),T=o(c(O),2),R=c(T);R.value=((R.__value="")==null,"");var V=o(R);H(V,1,()=>l,W,(I,k)=>{var h=de(),w={},j=c(h,!0);s(h),S(()=>{w!==(w=n(k).path)&&(h.value=(h.__value=n(k).path)==null?"":n(k).path),N(j,n(k).name)}),v(I,h)}),s(T);var P=o(T,2);s(O);var B=o(O,2);{var st=I=>{var k=ge(),h=c(k);H(h,5,()=>n(i),W,(j,q,F)=>{var D=fe(),G=c(D),Z=c(G,!0);s(G);var Q=o(G,2),$=c(Q);A($,"icon","mdi:close"),s(Q),s(D),S(()=>{nt(G,"btn-active",n(t)===F),N(Z,n(q).name)}),et("click",G,()=>J(t,F)),et("click",Q,()=>f(F)),v(j,D)}),s(h);var w=o(h,2);H(w,5,()=>Object.entries(n(i)[n(t)].data),W,(j,q)=>{let F=()=>n(q)[0],D=()=>n(q)[1];_e(j,{get dayIdx(){return F()},get dayStatus(){return D()}})}),s(w),s(k),v(I,k)};L(B,I=>{n(i).length>0&&I(st)})}s(y),et("change",T,I=>{const k=I.currentTarget.value;if(k){const h=l.find(w=>w.path===k);h&&m(h.path,h.name),I.currentTarget.value=""}}),et("change",P,g),v(r,y),it()}export{we as component};
