var lt=Object.defineProperty;var ct=(t,e,i)=>e in t?lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var He=(t,e,i)=>ct(t,typeof e!="symbol"?e+"":e,i);import{t as _,a as s,c as ve}from"../chunks/D0Zzml86.js";import{e as Ge,u as vt,p as Ee,j as ut,d as Q,g as n,aG as oe,c as a,r,a as De,f as Z,s as o,aI as de,o as Oe,t as V,$ as _t}from"../chunks/heac-MY7.js";import{h as ft}from"../chunks/CGmxII_f.js";import{i as D}from"../chunks/BNXQp2IV.js";import{p as ee}from"../chunks/BYmUdosK.js";import{o as qe,a as je}from"../chunks/FHtQcyAd.js";import{p as dt}from"../chunks/DCEFaYcF.js";import{w as ot}from"../chunks/Dn7NCLaY.js";import{a as ce,b as Ie,c as Se,d as ke,e as Ce,f as Le,S as ye,D as Ve,g as gt}from"../chunks/BON7M-IV.js";/* empty css                */import{d as st,s as b}from"../chunks/xyDVIoIJ.js";import{e as xe,i as me}from"../chunks/BglFDjV7.js";import{r as Ae,s as ne,a as ge,c as Ne,d as Ke}from"../chunks/CTFTRwRb.js";import{b as ze}from"../chunks/JXFzDlmf.js";import{b as Ue}from"../chunks/BTLOw_KB.js";import{b as Qe}from"../chunks/Bj6oyPLr.js";function Xe(t,e,i){Ge(()=>{var c=vt(()=>e(t,i==null?void 0:i())||{});if(c!=null&&c.destroy)return()=>c.destroy()})}class We{static fromJson(e){return bt(JSON.parse(e),Fe("AgentSettings"))}static toJson(e){return JSON.stringify(pt(e,Fe("AgentSettings")),null,2)}}function he(t,e,i,c=""){const K=Ze(t),X=c?` on ${c}`:"",ie=i?` for key "${i}"`:"";throw Error(`Invalid value${ie}${X}. Expected ${K} but got ${JSON.stringify(e)}`)}function Ze(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${Ze(t[1])}`:`one of [${t.map(e=>Ze(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function xt(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(i=>e[i.json]={key:i.js,typ:i.typ}),t.jsonToJS=e}return t.jsonToJS}function mt(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(i=>e[i.js]={key:i.json,typ:i.typ}),t.jsToJSON=e}return t.jsToJSON}function Te(t,e,i,c="",K=""){function X(u,T){return typeof u==typeof T?T:he(u,T,c,K)}function ie(u,T){const L=u.length;for(let f=0;f<L;f++){const d=u[f];try{return Te(T,d,i)}catch{}}return he(u,T,c,K)}function te(u,T){return u.indexOf(T)!==-1?T:he(u.map(L=>Pe(L)),T,c,K)}function H(u,T){return Array.isArray(T)?T.map(L=>Te(L,u,i)):he(Pe("array"),T,c,K)}function y(u){if(u===null)return null;const T=new Date(u);return isNaN(T.valueOf())?he(Pe("Date"),u,c,K):T}function w(u,T,L){if(L===null||typeof L!="object"||Array.isArray(L))return he(Pe(J||"object"),L,c,K);const f={};return Object.getOwnPropertyNames(u).forEach(d=>{const p=u[d],B=Object.prototype.hasOwnProperty.call(L,d)?L[d]:void 0;f[p.key]=Te(B,p.typ,i,d,J)}),Object.getOwnPropertyNames(L).forEach(d=>{Object.prototype.hasOwnProperty.call(u,d)||(f[d]=Te(L[d],T,i,d,J))}),f}if(e==="any")return t;if(e===null)return t===null?t:he(e,t,c,K);if(e===!1)return he(e,t,c,K);let J;for(;typeof e=="object"&&e.ref!==void 0;)J=e.ref,e=ht[e.ref];return Array.isArray(e)?te(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?ie(e.unionMembers,t):e.hasOwnProperty("arrayItems")?H(e.arrayItems,t):e.hasOwnProperty("props")?w(i(e),e.additional,t):he(e,t,c,K):e===Date&&typeof t!="number"?y(t):X(e,t)}function bt(t,e){return Te(t,e,xt)}function pt(t,e){return Te(t,e,mt)}function Pe(t){return{literal:t}}function Je(t,e){return{props:t,additional:e}}function Fe(t){return{ref:t}}const ht={AgentSettings:Je([{json:"connection",js:"connection",typ:Fe("Connection")},{json:"team",js:"team",typ:""},{json:"display",js:"display",typ:Fe("Display")}],!1),Connection:Je([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1),Display:Je([{json:"largeScale",js:"largeScale",typ:!0}],!1)},Ye={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}};function yt(){const t=localStorage.getItem("agent-settings");if(t)try{return We.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",We.toJson(Ye)),Ye}const pe=ot(yt());pe.subscribe(t=>{localStorage.setItem("agent-settings",We.toJson(t))});function At(){const{subscribe:t,update:e}=ot({status:"disconnected",deadline:null,entries:[],role:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let i=null,c=null,K=null,X=null;pe.subscribe(y=>{c=y});function ie(){i&&(i.close(),i=null,e(y=>({...y,status:"disconnected"}))),X&&(X.clear(),X=null)}function te(){if(!c)return;i&&e(w=>({...w,status:"disconnected",deadline:null,entries:[],role:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]})),e(w=>({...w,status:"connecting"}));const y=new URL(c.connection.url);c.connection.token&&y.searchParams.set("token",c.connection.token),i=new WebSocket(y),i.onopen=()=>{e(w=>({...w,status:"connected"}))},i.onclose=()=>{ie()},i.onerror=()=>{ie()},i.onmessage=w=>{try{const J=Date.now(),u=JSON.parse(w.data);switch(e(T=>{const L=T.entries.slice();L.push(u);const f={...T,entries:L,request:u.request};if(u.info){if(f.info=u.info,u.info.medium_result){const d=u.info.medium_result;f.mediumResults.findIndex(p=>p.day===d.day&&p.agent===d.agent)<0&&f.mediumResults.push(u.info.medium_result)}if(u.info.divine_result){const d=u.info.divine_result;f.divineResults.findIndex(p=>p.day===d.day&&p.agent===d.agent)<0&&f.divineResults.push(u.info.divine_result)}u.info.executed_agent&&f.executedAgents.push(u.info.executed_agent),u.info.attacked_agent&&f.attackedAgents.push(u.info.attacked_agent)}return u.setting&&(f.setting=u.setting,K=u.setting.timeout.action),u.talk_history&&f.talkHistory.push(...u.talk_history),u.whisper_history&&f.whisperHistory.push(...u.whisper_history),u.request===ce.INITIALIZE&&f.info&&f.info.role_map&&f.info.agent&&(f.role=f.info.role_map[f.info.agent]),f}),u.request){case ce.NAME:H((c==null?void 0:c.team)||"viewer"+Math.floor(Math.random()*1e3));break;case ce.TALK:case ce.WHISPER:case ce.VOTE:case ce.DIVINE:case ce.GUARD:case ce.ATTACK:X&&X.clear(),X=new wt(()=>{H("TIMEOUT")},new Date(J+(K??6e4))),e(T=>({...T,deadline:(X==null?void 0:X.deadline())??null}));break;case ce.FINISH:ie();break}}catch(J){console.error("Failed to parse message:",J)}}}function H(y){if(X&&(X.clear(),X=null,e(w=>({...w,deadline:null}))),i&&i.readyState===WebSocket.OPEN)try{i.send(y),e(w=>{const J=w.entries.slice();return J.push(y),{...w,entries:J}})}catch(w){console.error("Failed to send message:",w)}}return{subscribe:t,connect:te,disconnect:ie,send:H}}const Re=At();class wt{constructor(e,i){He(this,"timeout");He(this,"_deadline");this.timeout=setTimeout(e,i.getTime()-new Date().getTime()),this._deadline=i}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var $e;(function(t){t[t.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",t[t.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",t[t.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",t[t.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",t[t.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",t[t.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",t[t.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",t[t.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",t[t.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",t[t.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",t[t.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",t[t.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",t[t.TAGS_START=917504]="TAGS_START",t[t.TAGS_END=917631]="TAGS_END",t[t.ZWJ=8205]="ZWJ"})($e||($e={}));const kt=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var et;function tt(t){if(typeof t!="string")throw new TypeError("string cannot be undefined or null");const e=[];let i=0,c=0;for(;i<t.length;)c+=It(i+c,t),Nt(t[i+c])&&c++,Ot(t[i+c])&&c++,Et(t[i+c])&&c++,jt(t[i+c])?c++:(e.push(t.substring(i,i+c)),i+=c,c=0);return e}function It(t,e){const i=e[t];if(!St(i)||t===e.length-1)return 1;const c=i+e[t+1];let K=e.substring(t+2,t+5);return rt(c)&&rt(K)?4:Tt(c)&&Dt(K)?e.slice(t).indexOf(String.fromCodePoint(917631))+2:Rt(K)?4:2}function St(t){return t&&we(t[0].charCodeAt(0),55296,56319)}function rt(t){return we(Be(t),127462,127487)}function Tt(t){return we(Be(t),127988,127988)}function Rt(t){return we(Be(t),127995,127999)}function Ot(t){return typeof t=="string"&&we(t.charCodeAt(0),65024,65039)}function Et(t){return typeof t=="string"&&we(t.charCodeAt(0),8400,8447)}function Dt(t){const e=t.codePointAt(0);return typeof t=="string"&&typeof e=="number"&&we(e,917504,917631)}function Nt(t){return typeof t=="string"&&kt.includes(t.charCodeAt(0))}function jt(t){return typeof t=="string"&&t.charCodeAt(0)===8205}function Be(t){return(t.charCodeAt(0)-55296<<10)+(t.charCodeAt(1)-56320)+65536}function we(t,e,i){return t>=e&&t<=i}(function(t){t[t.unit_1=1]="unit_1",t[t.unit_2=2]="unit_2",t[t.unit_4=4]="unit_4"})(et||(et={}));function at(t,e,i){t.key==="Enter"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.onSendMessage(n(i)))}var Mt=_('<span aria-live="polite"> </span>m',1),Ct=(t,e,i)=>e(i()),Lt=_('<button class="btn btn-xl"> </button>'),Pt=(t,e)=>e("Skip"),Ft=_('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),qt=(t,e)=>e("Over"),Ht=_('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),Jt=_("<option></option>"),Gt=_("<option></option>"),Vt=_("<!> <option></option>",1),Kt=_('<pre class="text-2xl"> </pre>'),Ut=_('<pre class="text-2xl bg-error text-error-content"> </pre>'),Wt=(t,e,i)=>e.onSendMessage(n(i)),Zt=_('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),Bt=_('<span aria-live="polite"> </span>m',1),zt=(t,e,i)=>e(i()),Qt=_('<button class="btn"> </button>'),Xt=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),Yt=(t,e)=>e("Skip"),$t=_('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),er=(t,e)=>e("Over"),tr=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),rr=_("<option></option>"),ar=_("<option></option>"),nr=_("<!> <option></option>",1),ir=_('<pre class="text-md"> </pre>'),or=_('<pre class="text-md bg-error text-error-content"> </pre>'),sr=(t,e,i)=>e.onSendMessage(n(i)),lr=_('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),cr=_('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function vr(t,e){Ee(e,!0);let i=oe(""),c=oe(0),K=oe(void 0),X=oe(null);const ie=Oe(()=>{var f;return e.remain!==null?e.remain/(((f=e.setting)==null?void 0:f.timeout.action)??6e4)*100:0}),te=Oe(()=>[ce.VOTE,ce.DIVINE,ce.GUARD,ce.ATTACK].includes(e.request));function H(f){var B,O;if(!e.request||!e.setting)return 0;const d=e.request===ce.TALK?e.setting.talk.max_length:e.request===ce.WHISPER?e.setting.whisper.max_length:null;if(!d)return 0;let p=d.base_length??0;if(p+=((B=e.info)==null?void 0:B.remain_length)??0,d.mention_length){for(const M in((O=e.info)==null?void 0:O.status_map)??{})if(f.indexOf("@"+M)!==-1){p+=d.mention_length,p+=tt("@"+M).length;break}}return d.per_talk&&(p=Math.min(p,d.per_talk)),p-=tt(f).length,p}ut(()=>{Q(c,ee(H(n(i))))}),qe(()=>{const f=pe.subscribe(d=>{Q(K,ee(d))});return()=>{f()}});function y(f){var d;Q(i,ee(f)),(d=n(X))==null||d.focus()}function w(f){f.focus()}var J=cr(),u=a(J);{var T=f=>{var d=Zt(),p=Z(d),B=a(p),O=a(B);{var M=h=>{var A=Mt(),E=Z(A),j=a(E,!0);r(E),de(),V(($,se)=>{ge(E,"style",`--value:${$??""};`),ge(E,"aria-label",se),b(j,$)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString()]),s(h,A)};D(O,h=>{e.remain&&e.remain>6e4&&h(M)})}var C=o(O,2),U=a(C,!0);r(C),de(),r(B);var G=o(B,2),P=a(G,!0);r(G),r(p);var N=o(p,2),F=a(N);{var Y=h=>{var A=ve(),E=Z(A);xe(E,17,()=>{var j;return Object.entries(((j=e.info)==null?void 0:j.status_map)??{})},me,(j,$)=>{let se=()=>n($)[0],ae=()=>n($)[1];var le=ve(),fe=Z(le);{var be=_e=>{var ue=Lt();ue.__click=[Ct,y,se];var Me=a(ue,!0);r(ue),V(()=>b(Me,se())),s(_e,ue)};D(fe,_e=>{var ue;ae()===Se.ALIVE&&se()!==((ue=e.info)==null?void 0:ue.agent)&&_e(be)})}s(j,le)}),s(h,A)},g=h=>{var A=Ht(),E=Z(A);{var j=ae=>{var le=Ft();le.__click=[Pt,y];var fe=a(le);ne(fe,"icon","mdi:arrow-u-down-right-bold"),de(),r(le),s(ae,le)};D(E,ae=>{var le;(((le=e.info)==null?void 0:le.remain_skip)??0)>0&&ae(j)})}var $=o(E,2);$.__click=[qt,y];var se=a($);ne(se,"icon","mdi:skip-forward"),de(),r($),s(h,A)};D(F,h=>{n(te)?h(Y):h(g,!1)})}var R=o(F,2);Ae(R),R.__keydown=[at,e,i],Ge(()=>ze(R,()=>n(i),h=>Q(i,h))),Xe(R,h=>w==null?void 0:w(h)),Ue(R,h=>Q(X,h),()=>n(X));var I=o(R,2),z=a(I);{var re=h=>{var A=ve(),E=Z(A);xe(E,17,()=>{var j;return Object.entries(((j=e.info)==null?void 0:j.status_map)??{})},me,(j,$)=>{let se=()=>n($)[0],ae=()=>n($)[1];var le=ve(),fe=Z(le);{var be=_e=>{var ue=Jt(),Me={};V(()=>{Me!==(Me=se())&&(ue.value=(ue.__value=se())==null?"":se())}),s(_e,ue)};D(fe,_e=>{var ue;ae()===Se.ALIVE&&se()!==((ue=e.info)==null?void 0:ue.agent)&&_e(be)})}s(j,le)}),s(h,A)},S=h=>{var A=Vt(),E=Z(A);{var j=se=>{var ae=Gt();ae.value=(ae.__value="Skip")==null?"":"Skip",s(se,ae)};D(E,se=>{var ae;(((ae=e.info)==null?void 0:ae.remain_skip)??0)>0&&se(j)})}var $=o(E,2);$.value=($.__value="Over")==null?"":"Over",s(h,A)};D(z,h=>{n(te)?h(re):h(S,!1)})}r(I);var x=o(I,2);{var k=h=>{var A=Kt(),E=a(A);r(A),V(()=>b(E,`残り${n(c)??""}文字`)),s(h,A)},W=h=>{var A=Ut(),E=a(A);r(A),V(()=>b(E,`${n(c)*-1}文字超過`)),s(h,A)};D(x,h=>{n(c)>=0?h(k):h(W,!1)})}var q=o(x,2);q.__click=[Wt,e,i];var l=a(q);ne(l,"icon","mdi:send"),de(),r(q),r(N);var v=o(N,2),m=a(v);r(v),V((h,A)=>{ge(C,"style",`--value:${h??""};`),ge(C,"aria-label",A),b(U,h),b(P,n(te)?`${Ie[e.request]}対象を選択してください`:`${Ie[e.request??ce.INITIALIZE]}内容を入力してください`),Ne(m,n(ie))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString()]),s(f,d)},L=f=>{var d=lr(),p=Z(d),B=a(p),O=a(B);{var M=l=>{var v=Bt(),m=Z(v),h=a(m,!0);r(m),de(),V((A,E)=>{ge(m,"style",`--value:${A??""};`),ge(m,"aria-label",E),b(h,A)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString()]),s(l,v)};D(O,l=>{e.remain&&e.remain>6e4&&l(M)})}var C=o(O,2),U=a(C,!0);r(C),de(),r(B);var G=o(B,2);{var P=l=>{var v=Xt(),m=Z(v),h=a(m);r(m);var A=o(m,2);xe(A,17,()=>{var E;return Object.entries(((E=e.info)==null?void 0:E.status_map)??{})},me,(E,j)=>{let $=()=>n(j)[0],se=()=>n(j)[1];var ae=ve(),le=Z(ae);{var fe=be=>{var _e=Qt();_e.__click=[zt,y,$];var ue=a(_e,!0);r(_e),V(()=>b(ue,$())),s(be,_e)};D(le,be=>{var _e;se()===Se.ALIVE&&$()!==((_e=e.info)==null?void 0:_e.agent)&&be(fe)})}s(E,ae)}),V(()=>b(h,`${Ie[e.request]??""}対象を選択してください`)),s(l,v)},N=l=>{var v=tr(),m=Z(v),h=a(m);r(m);var A=o(m,2);{var E=se=>{var ae=$t();ae.__click=[Yt,y];var le=a(ae);ne(le,"icon","mdi:arrow-u-down-right-bold"),de(),r(ae),s(se,ae)};D(A,se=>{var ae;(((ae=e.info)==null?void 0:ae.remain_skip)??0)>0&&se(E)})}var j=o(A,2);j.__click=[er,y];var $=a(j);ne($,"icon","mdi:skip-forward"),de(),r(j),V(()=>b(h,`${Ie[e.request??ce.INITIALIZE]??""}内容を入力してください`)),s(l,v)};D(G,l=>{n(te)?l(P):l(N,!1)})}var F=o(G,2);Ae(F),F.__keydown=[at,e,i],Ge(()=>ze(F,()=>n(i),l=>Q(i,l))),Xe(F,l=>w==null?void 0:w(l)),Ue(F,l=>Q(X,l),()=>n(X));var Y=o(F,2),g=a(Y);{var R=l=>{var v=ve(),m=Z(v);xe(m,17,()=>{var h;return Object.entries(((h=e.info)==null?void 0:h.status_map)??{})},me,(h,A)=>{let E=()=>n(A)[0],j=()=>n(A)[1];var $=ve(),se=Z($);{var ae=le=>{var fe=rr(),be={};V(()=>{be!==(be=E())&&(fe.value=(fe.__value=E())==null?"":E())}),s(le,fe)};D(se,le=>{var fe;j()===Se.ALIVE&&E()!==((fe=e.info)==null?void 0:fe.agent)&&le(ae)})}s(h,$)}),s(l,v)},I=l=>{var v=nr(),m=Z(v);{var h=E=>{var j=ar();j.value=(j.__value="Skip")==null?"":"Skip",s(E,j)};D(m,E=>{var j;(((j=e.info)==null?void 0:j.remain_skip)??0)>0&&E(h)})}var A=o(m,2);A.value=(A.__value="Over")==null?"":"Over",s(l,v)};D(g,l=>{n(te)?l(R):l(I,!1)})}r(Y);var z=o(Y,2);{var re=l=>{var v=ir(),m=a(v);r(v),V(()=>b(m,`残り${n(c)??""}文字`)),s(l,v)},S=l=>{var v=or(),m=a(v);r(v),V(()=>b(m,`${n(c)*-1}文字超過`)),s(l,v)};D(z,l=>{n(c)>=0?l(re):l(S,!1)})}var x=o(z,2);x.__click=[sr,e,i];var k=a(x);ne(k,"icon","mdi:send"),de(),r(x),r(p);var W=o(p,2),q=a(W);r(W),V((l,v)=>{ge(C,"style",`--value:${l??""};`),ge(C,"aria-label",v),b(U,l),Ne(q,n(ie))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString()]),s(f,d)};D(u,f=>{var d;(d=n(K))!=null&&d.display.largeScale?f(T):f(L,!1)})}r(J),s(t,J),De()}st(["click","keydown"]);var ur=_('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),_r=_('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),fr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),dr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),gr=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),xr=_('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),mr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),br=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),pr=_('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),hr=_('<div class="grow overflow-y-auto pr-4"><pre class="text-5xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!></div>'),yr=_('<pre class="text-lg text-center"> </pre>'),Ar=_('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),wr=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),kr=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ir=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Sr=_('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),Tr=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Rr=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Or=_('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),Er=_('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),Dr=_('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function Nr(t,e){Ee(e,!0);let i=oe(void 0);qe(()=>{const H=pe.subscribe(y=>{Q(i,ee(y))});je(H)});var c=Dr(),K=a(c),X=a(K);{var ie=H=>{var y=hr(),w=a(y),J=a(w,!0);r(w);var u=o(w,2),T=a(u,!0);r(u);var L=o(u,2);{var f=C=>{var U=ur(),G=a(U,!0);r(U),V(()=>b(G,Ie[e.request])),s(C,U)};D(L,C=>{e.request!==null&&C(f)})}var d=o(L,2);xe(d,17,()=>Object.entries(e.info.status_map??{}),me,(C,U)=>{let G=()=>n(U)[0],P=()=>n(U)[1];var N=ve(),F=Z(N);{var Y=R=>{var I=_r(),z=a(I),re=a(z,!0);r(z);var S=o(z,2),x=a(S,!0);r(S);var k=o(S,2),W=a(k,!0);r(k),r(I),V(()=>{b(re,G()),b(x,ke[(e.info.role_map??{})[G()]]??""),b(W,Ce[P()])}),s(R,I)},g=R=>{var I=fr(),z=a(I),re=a(z,!0);r(z);var S=o(z,2),x=a(S,!0);r(S);var k=o(S,2),W=a(k);r(k),r(I),V(q=>{b(re,G()),b(x,ke[(e.info.role_map??{})[G()]]??""),b(W,`${Ce[P()]??""}${q??""}`)},[()=>e.executedAgents.includes(G())?" (追放)":e.attackedAgents.includes(G())?" (襲撃)":""]),s(R,I)};D(F,R=>{P()===Se.ALIVE?R(Y):R(g,!1)})}s(C,N)});var p=o(d,2);{var B=C=>{var U=xr(),G=o(Z(U),2);xe(G,17,()=>e.mediumResults,me,(P,N)=>{let F=()=>n(N).day,Y=()=>n(N).target,g=()=>n(N).result;var R=ve(),I=Z(R);{var z=S=>{var x=dr(),k=a(x),W=a(k,!0);r(k);var q=o(k,2),l=a(q);r(q);var v=o(q,2),m=a(v,!0);r(v),r(x),V(()=>{b(W,Y()),b(l,`(${F()??""}日目)`),b(m,ye[g()])}),s(S,x)},re=S=>{var x=gr(),k=a(x),W=a(k,!0);r(k);var q=o(k,2),l=a(q);r(q);var v=o(q,2),m=a(v,!0);r(v),r(x),V(()=>{b(W,Y()),b(l,`(${F()??""}日目)`),b(m,ye[g()])}),s(S,x)};D(I,S=>{g()!==Le.HUMAN?S(z):S(re,!1)})}s(P,R)}),s(C,U)};D(p,C=>{e.mediumResults.length>0&&C(B)})}var O=o(p,2);{var M=C=>{var U=pr(),G=o(Z(U),2);xe(G,17,()=>e.divineResults,me,(P,N)=>{let F=()=>n(N).day,Y=()=>n(N).target,g=()=>n(N).result;var R=ve(),I=Z(R);{var z=S=>{var x=mr(),k=a(x),W=a(k,!0);r(k);var q=o(k,2),l=a(q);r(q);var v=o(q,2),m=a(v,!0);r(v),r(x),V(()=>{b(W,Y()),b(l,`(${F()??""}日目)`),b(m,ye[g()])}),s(S,x)},re=S=>{var x=br(),k=a(x),W=a(k,!0);r(k);var q=o(k,2),l=a(q);r(q);var v=o(q,2),m=a(v,!0);r(v),r(x),V(()=>{b(W,Y()),b(l,`(${F()??""}日目)`),b(m,ye[g()])}),s(S,x)};D(I,S=>{g()!==Le.HUMAN?S(z):S(re,!1)})}s(P,R)}),s(C,U)};D(O,C=>{e.divineResults.length>0&&C(M)})}r(y),V(()=>{b(J,e.role!==null?ke[e.role]:"ゲーム外"),b(T,e.info!==null?e.info.day+"日目":"ゲーム外")}),s(H,y)},te=H=>{var y=Er(),w=o(Z(y),2),J=a(w),u=a(J),T=o(a(u),2),L=a(T,!0);r(T),r(u);var f=o(u,2),d=o(a(f),2),p=a(d,!0);r(d),r(f);var B=o(f,2),O=o(a(B),2);{var M=F=>{var Y=yr(),g=a(Y,!0);r(Y),V(()=>b(g,Ie[e.request])),s(F,Y)};D(O,F=>{e.request!==null&&F(M)})}r(B),r(J);var C=o(J,4);xe(C,17,()=>Object.entries(e.info.status_map??{}),me,(F,Y)=>{let g=()=>n(Y)[0],R=()=>n(Y)[1];var I=ve(),z=Z(I);{var re=x=>{var k=Ar(),W=a(k),q=a(W,!0);r(W);var l=o(W,2),v=a(l,!0);r(l);var m=o(l,2),h=a(m,!0);r(m),r(k),V(()=>{b(q,g()),b(v,ke[(e.info.role_map??{})[g()]]??""),b(h,Ce[R()])}),s(x,k)},S=x=>{var k=wr(),W=a(k),q=a(W,!0);r(W);var l=o(W,2),v=a(l,!0);r(l);var m=o(l,2),h=a(m);r(m),r(k),V(A=>{b(q,g()),b(v,ke[(e.info.role_map??{})[g()]]??""),b(h,`${Ce[R()]??""}${A??""}`)},[()=>e.executedAgents.includes(g())?" (追放)":e.attackedAgents.includes(g())?" (襲撃)":""]),s(x,k)};D(z,x=>{R()===Se.ALIVE?x(re):x(S,!1)})}s(F,I)});var U=o(C,2);{var G=F=>{var Y=Sr(),g=o(Z(Y),2);xe(g,17,()=>e.mediumResults,me,(R,I)=>{let z=()=>n(I).day,re=()=>n(I).target,S=()=>n(I).result;var x=ve(),k=Z(x);{var W=l=>{var v=kr(),m=a(v),h=a(m,!0);r(m);var A=o(m,2),E=a(A);r(A);var j=o(A,2),$=a(j,!0);r(j),r(v),V(()=>{b(h,re()),b(E,`(${z()??""}日目)`),b($,ye[S()])}),s(l,v)},q=l=>{var v=Ir(),m=a(v),h=a(m,!0);r(m);var A=o(m,2),E=a(A);r(A);var j=o(A,2),$=a(j,!0);r(j),r(v),V(()=>{b(h,re()),b(E,`(${z()??""}日目)`),b($,ye[S()])}),s(l,v)};D(k,l=>{S()!==Le.HUMAN?l(W):l(q,!1)})}s(R,x)}),s(F,Y)};D(U,F=>{e.mediumResults.length>0&&F(G)})}var P=o(U,2);{var N=F=>{var Y=Or(),g=o(Z(Y),2);xe(g,17,()=>e.divineResults,me,(R,I)=>{let z=()=>n(I).day,re=()=>n(I).target,S=()=>n(I).result;var x=ve(),k=Z(x);{var W=l=>{var v=Tr(),m=a(v),h=a(m,!0);r(m);var A=o(m,2),E=a(A);r(A);var j=o(A,2),$=a(j,!0);r(j),r(v),V(()=>{b(h,re()),b(E,`(${z()??""}日目)`),b($,ye[S()])}),s(l,v)},q=l=>{var v=Rr(),m=a(v),h=a(m,!0);r(m);var A=o(m,2),E=a(A);r(A);var j=o(A,2),$=a(j,!0);r(j),r(v),V(()=>{b(h,re()),b(E,`(${z()??""}日目)`),b($,ye[S()])}),s(l,v)};D(k,l=>{S()!==Le.HUMAN?l(W):l(q,!1)})}s(R,x)}),s(F,Y)};D(P,F=>{e.divineResults.length>0&&F(N)})}r(w),V(()=>{b(L,e.role!==null?ke[e.role]:"ゲーム外"),b(p,e.info!==null?e.info.day+"日目":"ゲーム外")}),s(H,y)};D(X,H=>{var y;(y=n(i))!=null&&y.display.largeScale?H(ie):H(te,!1)})}r(K),r(c),s(t,c),De()}function jr(){Re.connect()}function Mr(){Re.disconnect()}var Cr=_('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Lr=_('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),Pr=_('<div class="status status-error"></div>'),Fr=(t,e)=>e("connection.url",t.currentTarget.value),qr=(t,e)=>e("connection.token",t.currentTarget.value),Hr=(t,e)=>e("team",t.currentTarget.value),Jr=(t,e)=>e("display.largeScale",t.currentTarget.checked),Gr=_('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><h1 class="text-3xl font-bold text-nowrap ml-2">aiwolf-nlp-viewer</h1> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="WebSocket URL"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="Authorization Key"> <span class="badge badge-neutral badge-xs">Optional</span></label> <button class="btn btn-info">接続</button> <button class="btn btn-error">切断</button> <button class="btn">設定</button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold">エージェント設定</h3> <h4 class="text-base font-bold mt-2">チーム名</h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <h3 class="text-lg font-bold mt-4">表示設定</h3> <h4 class="text-base font-bold mt-2">大画面向け</h4> <label class="label cursor-pointer my-2"><span class="label-text">有効</span> <input type="checkbox" class="checkbox"></label></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function Vr(t,e){Ee(e,!0);let i=oe(void 0),c=oe(void 0);const K=pe.subscribe(x=>{Q(i,ee(x))}),X=Re.subscribe(x=>{Q(c,ee(x.status))});je(()=>{K(),X()});function ie(x,k){pe.update(W=>{const q=x.split("."),l=q.pop();let v=W;for(const m of q)m&&(v=v[m]);return v[l]=k,{...W}})}let te;var H=Gr(),y=o(a(H),2),w=a(y),J=a(w);{var u=x=>{var k=Cr();de(2),s(x,k)},T=x=>{var k=ve(),W=Z(k);{var q=v=>{var m=Lr();de(2),s(v,m)},l=v=>{var m=Pr();s(v,m)};D(W,v=>{n(c)==="connecting"?v(q):v(l,!1)},!0)}s(x,k)};D(J,x=>{n(c)==="connected"?x(u):x(T,!1)})}r(w),r(y);var L=o(y,2),f=a(L);ne(f,"class","h-[1em] opacity-50"),ne(f,"inline",!0),ne(f,"icon","mdi:link");var d=o(f,2);Ae(d),d.__input=[Fr,ie],r(L);var p=o(L,2),B=a(p);ne(B,"class","h-[1em] opacity-50"),ne(B,"inline",!0),ne(B,"icon","mdi:key");var O=o(B,2);Ae(O),O.__input=[qr,ie],de(2),r(p);var M=o(p,2);M.__click=[jr];var C=o(M,2);C.__click=[Mr];var U=o(C,2);U.__click=()=>te.showModal();var G=o(U,2),P=a(G),N=a(P),F=o(a(N),4),Y=a(F);ne(Y,"class","h-[1em] opacity-50"),ne(Y,"inline",!0),ne(Y,"icon","mdi:rename");var g=o(Y,2);Ae(g),g.__input=[Hr,ie],r(F);var R=o(F,6),I=o(a(R),2);Ae(I),I.__change=[Jr,ie],r(R),r(N),r(P),de(2),r(G),Ue(G,x=>te=x,()=>te);var z=o(G,2),re=a(z);ne(re,"inline",!0),ne(re,"icon","mdi:white-balance-sunny");var S=o(re,4);ne(S,"inline",!0),ne(S,"icon","mdi:moon-and-stars"),r(z),r(H),V(()=>{var x,k,W,q;Ne(d,(x=n(i))==null?void 0:x.connection.url),Ne(O,(k=n(i))==null?void 0:k.connection.token),M.disabled=n(c)!=="disconnected",C.disabled=n(c)==="disconnected",Ne(g,(W=n(i))==null?void 0:W.team),Ke(I,(q=n(i))==null?void 0:q.display.largeScale)}),s(t,H),De()}st(["input","click","change"]);var Kr=_("<iconify-icon></iconify-icon>",2),Ur=_("<iconify-icon></iconify-icon>",2),Wr=_('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),Zr=_('<div class="chat-image avatar"><div class="w-20 rounded-full"><img></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),Br=_("<iconify-icon></iconify-icon>",2),zr=_("<iconify-icon></iconify-icon>",2),Qr=_('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),Xr=_('<div class="chat-image avatar"><div class="w-10 rounded-full"><img></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),Yr=_('<div class="chat chat-start"><!></div>');function nt(t,e){Ee(e,!0);let i=oe(void 0);qe(()=>{const te=pe.subscribe(H=>{Q(i,ee(H))});je(te)});var c=Yr(),K=a(c);{var X=te=>{var H=Zr(),y=Z(H),w=a(y),J=a(w);r(w),r(y);var u=o(y,2),T=a(u,!0);r(u);var L=o(u,2);{var f=O=>{var M=Kr();ne(M,"inline",!0),ne(M,"icon","mdi:skip-forward"),s(O,M)},d=O=>{var M=ve(),C=Z(M);{var U=P=>{var N=Ur();ne(N,"inline",!0),ne(N,"icon","mdi:arrow-u-down-right-bold"),s(P,N)},G=P=>{var N=Wr(),F=a(N,!0);r(N),V(()=>b(F,e.talk.text)),s(P,N)};D(C,P=>{e.talk.skip?P(U):P(G,!1)},!0)}s(O,M)};D(L,O=>{e.talk.over?O(f):O(d,!1)})}var p=o(L,2),B=a(p);r(p),V(()=>{ge(J,"src",e.isDefaultProfile?`${Qe}${Ve[e.talk.agent]}`:""),ge(J,"alt",e.talk.agent),b(T,e.talk.agent),b(B,`Idx: ${e.talk.idx??""}`)}),s(te,H)},ie=te=>{var H=Xr(),y=Z(H),w=a(y),J=a(w);r(w),r(y);var u=o(y,2),T=a(u,!0);r(u);var L=o(u,2);{var f=O=>{var M=Br();ne(M,"inline",!0),ne(M,"icon","mdi:skip-forward"),s(O,M)},d=O=>{var M=ve(),C=Z(M);{var U=P=>{var N=zr();ne(N,"inline",!0),ne(N,"icon","mdi:arrow-u-down-right-bold"),s(P,N)},G=P=>{var N=Qr(),F=a(N,!0);r(N),V(()=>b(F,e.talk.text)),s(P,N)};D(C,P=>{e.talk.skip?P(U):P(G,!1)},!0)}s(O,M)};D(L,O=>{e.talk.over?O(f):O(d,!1)})}var p=o(L,2),B=a(p);r(p),V(()=>{ge(J,"src",e.isDefaultProfile?`${Qe}${Ve[e.talk.agent]}`:""),ge(J,"alt",e.talk.agent),b(T,e.talk.agent),b(B,`Idx: ${e.talk.idx??""}`)}),s(te,H)};D(K,te=>{var H;(H=n(i))!=null&&H.display.largeScale?te(X):te(ie,!1)})}r(c),s(t,c),De()}var $r=_('<input type="radio" name="talk_days" class="tab text-lg font-bold"> <div class="tab-content my-4"></div>',1),ea=_('<div class="tabs tabs-border"></div>'),ta=_('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),ra=_('<input type="radio" name="talk_days" class="tab"> <div class="tab-content my-4"></div>',1),aa=_('<div class="tabs tabs-border"></div>'),na=_('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),ia=_('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function it(t,e){Ee(e,!0);let i=oe(void 0),c=e.agents.every(y=>Object.keys(Ve).includes(y));qe(()=>{const y=pe.subscribe(w=>{Q(i,ee(w))});je(y)});var K=ia(),X=a(K),ie=a(X);{var te=y=>{var w=ta(),J=Z(w),u=a(J,!0);r(J);var T=o(J,2),L=a(T);{var f=d=>{var p=ea();const B=Oe(()=>[...new Set(e.talks.map(O=>O.day))].sort((O,M)=>M-O));xe(p,21,()=>n(B),me,(O,M)=>{var C=$r(),U=Z(C);Ae(U);var G=o(U,2);xe(G,21,()=>e.talks.filter(P=>P.day===n(M)),me,(P,N)=>{nt(P,{get talk(){return n(N)},get agents(){return e.agents},isDefaultProfile:c})}),r(G),V(()=>{Ke(U,n(M)===n(B)[0]),ge(U,"aria-label",`${n(M)}日目`)}),s(O,C)}),r(p),s(d,p)};D(L,d=>{e.talks.length>0&&d(f)})}r(T),V(()=>b(u,e.header)),s(y,w)},H=y=>{var w=na(),J=Z(w),u=a(J,!0);r(J);var T=o(J,2),L=a(T);{var f=d=>{var p=aa();const B=Oe(()=>[...new Set(e.talks.map(O=>O.day))].sort((O,M)=>M-O));xe(p,21,()=>n(B),me,(O,M)=>{var C=ra(),U=Z(C);Ae(U);var G=o(U,2);xe(G,21,()=>e.talks.filter(P=>P.day===n(M)),me,(P,N)=>{nt(P,{get talk(){return n(N)},get agents(){return e.agents},isDefaultProfile:c})}),r(G),V(()=>{Ke(U,n(M)===n(B)[0]),ge(U,"aria-label",`${n(M)}日目`)}),s(O,C)}),r(p),s(d,p)};D(L,d=>{e.talks.length>0&&d(f)})}r(T),V(()=>b(u,e.header)),s(y,w)};D(ie,y=>{var w;(w=n(i))!=null&&w.display.largeScale?y(te):y(H,!1)})}r(X),r(K),s(t,K),De()}var oa=_('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),sa=_('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none">未接続</pre></div>'),la=_('<div role="alert" class="alert m-4"><span class="text-lg font-bold">未接続</span></div>'),ca=_('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Ta(t,e){Ee(e,!0);let i=oe(void 0),c=oe(""),K=oe(null),X=oe(ee([])),ie=oe(null),te=oe(null),H=oe(null),y=oe(ee([])),w=oe(ee([])),J=oe(null),u=oe(ee([])),T=oe(ee([])),L=oe(ee([])),f=oe(ee([])),d=oe(null),p=oe(null),B=pe.subscribe(g=>{Q(i,ee(g))}),O=Re.subscribe(g=>{Q(c,ee(g.status)),g.deadline?(Q(K,ee(g.deadline.getTime())),C()):(Q(K,null),Q(d,null),n(p)&&(cancelAnimationFrame(n(p)),Q(p,null))),Q(X,ee(g.entries)),Q(ie,ee(g.role)),Q(te,ee(g.request)),Q(H,ee(g.info)),Q(y,ee(g.mediumResults)),Q(w,ee(g.divineResults)),Q(J,ee(g.setting)),Q(u,ee(g.talkHistory)),Q(T,ee(g.whisperHistory)),Q(L,ee(g.executedAgents)),Q(f,ee(g.attackedAgents))});function M(){const g=dt.url.searchParams,R=g.get("url"),I=g.get("token");R&&(pe.update(z=>({...z,connection:{url:R??"",token:I??""}})),Re.connect())}function C(){if(n(K)===null)return;const g=()=>{if(n(K)===null)return;const R=Date.now(),I=Math.max(0,n(K)-R);Q(d,ee(I)),I>0?Q(p,ee(requestAnimationFrame(g))):(Q(d,0),Q(p,null))};n(p)&&cancelAnimationFrame(n(p)),Q(p,ee(requestAnimationFrame(g)))}function U(g){Re.send(g)}{M();const g=I=>{n(c)==="connected"&&I.preventDefault()},R=I=>{n(c)==="connected"&&I.preventDefault()};window.addEventListener("beforeunload",g),window.addEventListener("popstate",R),je(()=>{window.removeEventListener("beforeunload",g),window.removeEventListener("popstate",R),n(p)&&cancelAnimationFrame(n(p)),B(),O()})}var G=ca();ft(g=>{_t.title="aiwolf-nlp-viewer"});var P=a(G);Vr(P,{});var N=o(P,2);{var F=g=>{var R=oa(),I=Z(R),z=a(I);Nr(z,{get role(){return n(ie)},get request(){return n(te)},get info(){return n(H)},get mediumResults(){return n(y)},get divineResults(){return n(w)},get executedAgents(){return n(L)},get attackedAgents(){return n(f)}});var re=o(z,2);const S=Oe(()=>{var l;return Object.keys(((l=n(H))==null?void 0:l.status_map)??{})});it(re,{header:"トーク履歴",get talks(){return n(u)},get agents(){return n(S)}});var x=o(re,2);{var k=l=>{const v=Oe(()=>{var m;return Object.keys(((m=n(H))==null?void 0:m.status_map)??{})});it(l,{header:"囁き履歴",get talks(){return n(T)},get agents(){return n(v)}})};D(x,l=>{n(ie)===gt.WEREWOLF&&l(k)})}r(I);var W=o(I,2);{var q=l=>{vr(l,{get remain(){return n(d)},get setting(){return n(J)},get request(){return n(te)},get info(){return n(H)},onSendMessage:U})};D(W,l=>{n(d)!==null&&l(q)})}s(g,R)},Y=g=>{var R=ve(),I=Z(R);{var z=S=>{var x=sa();s(S,x)},re=S=>{var x=la();s(S,x)};D(I,S=>{var x;(x=n(i))!=null&&x.display.largeScale?S(z):S(re,!1)},!0)}s(g,R)};D(N,g=>{n(H)!==null?g(F):g(Y,!1)})}r(G),s(t,G),De()}export{Ta as component};
