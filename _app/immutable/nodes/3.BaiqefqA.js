import"../chunks/DsnmJJEf.js";import{d as mt,c as Je,s,o as je,h as Rt}from"../chunks/CXarxrny.js";import{y as Xe,u as Et,b2 as xt,p as Ke,av as Ot,j,e as n,aG as ae,f as u,d as a,r as t,b as o,c as Ue,a as K,s as i,aH as Se,aK as be,t as E,as as de,aM as He,i as Ne,ar as Dt}from"../chunks/gOdP3cgH.js";import{i as R}from"../chunks/EwjKq--x.js";import{s as Be,a as Ye}from"../chunks/BMn8AbR4.js";import{p as Nt}from"../chunks/DWvl_ARU.js";import{s as We,a as Pe,S as Ze,R as Ct}from"../chunks/CRtH6DsV.js";import{$ as ze}from"../chunks/Czz4kriX.js";import{r as De,a as se,s as Te,b as qe,L as Mt,c as $e}from"../chunks/DE_gmSFB.js";import{e as he,i as Ae}from"../chunks/B9spI8rE.js";import{b as nt}from"../chunks/CLjv6BVA.js";import{b as et}from"../chunks/9_dtgZNI.js";import{s as Qe}from"../chunks/CZAvBSaL.js";import{b as it}from"../chunks/P5050FmI.js";function lt(r,e,m){Xe(()=>{var C=Et(()=>e(r,m?.())||{});if(C?.destroy)return()=>C.destroy()})}class bt{static fromJson(e){return JSON.parse(e)}static toJson(e){return JSON.stringify(e,null,2)}}const pt="agent-settings",ot={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}};function Lt(){const r=localStorage.getItem(pt);if(r)try{return bt.fromJson(r)}catch(e){console.error("Failed to parse agent settings:",e)}return yt(ot),ot}function yt(r){localStorage.setItem(pt,bt.toJson(r))}const Re=xt(Lt());Re.subscribe(yt);var xe=(r=>(r.NAME="NAME",r.TALK="TALK",r.WHISPER="WHISPER",r.VOTE="VOTE",r.DIVINE="DIVINE",r.GUARD="GUARD",r.ATTACK="ATTACK",r.INITIALIZE="INITIALIZE",r.DAILY_INITIALIZE="DAILY_INITIALIZE",r.DAILY_FINISH="DAILY_FINISH",r.FINISH="FINISH",r))(xe||{});const tt={ミナト:"/images/male/01.png",タクミ:"/images/male/02.png",ケンジ:"/images/male/03.png",リュウジ:"/images/male/04.png",ダイスケ:"/images/male/05.png",シオン:"/images/male/06.png",ベンジャミン:"/images/male/07.png",トシオ:"/images/male/08.png",ジョナサン:"/images/male/09.png",シュンイチ:"/images/male/10.png",ジョージ:"/images/male/11.png",セルヴァス:"/images/male/12.png",サクラ:"/images/female/01.png",リン:"/images/female/02.png",ユミ:"/images/female/03.png",メイ:"/images/female/04.png",ミサキ:"/images/female/05.png",ミオ:"/images/female/06.png",ミヅキ:"/images/female/07.png",ミナコ:"/images/female/08.png",アスカ:"/images/female/09.png",ミドリ:"/images/female/10.png",ヴィクトリア:"/images/female/11.png",シズエ:"/images/female/12.png"},st=()=>({status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});function Ft(){const{subscribe:r,update:e}=xt(st());let m=null,C=null,_=null,U=null;Re.subscribe(k=>{C=k});function ee(){m&&(m.close(),m=null,e(k=>({...k,status:"disconnected"}))),U&&(U.clear(),U=null)}function re(){if(!C)return;m&&e(()=>st()),e(v=>({...v,status:"connecting"}));const k=new URL(C.connection.url);C.connection.token&&k.searchParams.set("token",C.connection.token),m=new WebSocket(k),m.onopen=()=>{e(v=>({...v,status:"connected"}))},m.onclose=()=>{ee()},m.onerror=()=>{ee()},m.onmessage=v=>{try{const x=Date.now(),L=JSON.parse(v.data);e(z=>J(z,L)),te(L,x)}catch(x){console.error("Failed to parse message:",x)}}}function ie(k){if(U&&(U.clear(),U=null,e(v=>({...v,deadline:null}))),m&&m.readyState===WebSocket.OPEN)try{m.send(k),e(v=>{const x=v.entries.slice();return x.push(k),{...v,entries:x}})}catch(v){console.error("Failed to send message:",v)}}function J(k,v){const x={...k,entries:[...k.entries,v],request:v.request};if(v.info){if(x.info=v.info,v.info.medium_result){const L=v.info.medium_result;x.mediumResults.some(z=>z.day===L.day&&z.agent===L.agent)||x.mediumResults.push(L)}if(v.info.divine_result){const L=v.info.divine_result;x.divineResults.some(z=>z.day===L.day&&z.agent===L.agent)||x.divineResults.push(L)}v.info.executed_agent&&x.executedAgents.push(v.info.executed_agent),v.info.attacked_agent&&x.attackedAgents.push(v.info.attacked_agent)}return v.setting&&(x.setting=v.setting,_=v.setting.timeout.action),v.talk_history&&x.talkHistory.push(...v.talk_history),v.whisper_history&&x.whisperHistory.push(...v.whisper_history),v.request===xe.INITIALIZE&&x.info&&(x.agent=x.info.agent,x.role=x.info.role_map[x.info.agent],x.profile=x.info.profile||null),x}function te(k,v){switch(k.request){case xe.NAME:ie(C?.team||"viewer"+Math.floor(Math.random()*1e3));break;case xe.TALK:case xe.WHISPER:case xe.VOTE:case xe.DIVINE:case xe.GUARD:case xe.ATTACK:U&&U.clear(),U=new Ht(()=>{ie("TIMEOUT")},new Date(v+(_??6e4))),e(x=>({...x,deadline:U?.deadline()??null}));break;case xe.FINISH:ee();break}}return{subscribe:r,connect:re,disconnect:ee,send:ie}}const Ge=Ft();class Ht{timeout;_deadline;constructor(e,m){this.timeout=setTimeout(e,m.getTime()-new Date().getTime()),this._deadline=m}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var vt;(function(r){r[r.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",r[r.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",r[r.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",r[r.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",r[r.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",r[r.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",r[r.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",r[r.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",r[r.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",r[r.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",r[r.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",r[r.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",r[r.TAGS_START=917504]="TAGS_START",r[r.TAGS_END=917631]="TAGS_END",r[r.ZWJ=8205]="ZWJ"})(vt||(vt={}));const Pt=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var ct;function ut(r){if(typeof r!="string")throw new TypeError("string cannot be undefined or null");const e=[];let m=0,C=0;for(;m<r.length;)C+=Gt(m+C,r),Zt(r[m+C])&&C++,qt(r[m+C])&&C++,jt(r[m+C])&&C++,Jt(r[m+C])?C++:(e.push(r.substring(m,m+C)),m+=C,C=0);return e}function Gt(r,e){const m=e[r];if(!Kt(m)||r===e.length-1)return 1;const C=m+e[r+1];let _=e.substring(r+2,r+5);return _t(C)&&_t(_)?4:Ut(C)&&Wt(_)?e.slice(r).indexOf(String.fromCodePoint(917631))+2:Vt(_)?4:2}function Kt(r){return r&&Ce(r[0].charCodeAt(0),55296,56319)}function _t(r){return Ce(at(r),127462,127487)}function Ut(r){return Ce(at(r),127988,127988)}function Vt(r){return Ce(at(r),127995,127999)}function qt(r){return typeof r=="string"&&Ce(r.charCodeAt(0),65024,65039)}function jt(r){return typeof r=="string"&&Ce(r.charCodeAt(0),8400,8447)}function Wt(r){const e=r.codePointAt(0);return typeof r=="string"&&typeof e=="number"&&Ce(e,917504,917631)}function Zt(r){return typeof r=="string"&&Pt.includes(r.charCodeAt(0))}function Jt(r){return typeof r=="string"&&r.charCodeAt(0)===8205}function at(r){return(r.charCodeAt(0)-55296<<10)+(r.charCodeAt(1)-56320)+65536}function Ce(r,e,m){return r>=e&&r<=m}(function(r){r[r.unit_1=1]="unit_1",r[r.unit_2=2]="unit_2",r[r.unit_4=4]="unit_4"})(ct||(ct={}));function dt(r,e,m){r.key==="Enter"&&(r.ctrlKey||r.metaKey)&&(r.preventDefault(),e.onSendMessage(n(m)))}var Bt=u('<span aria-live="polite"> </span>m',1),Yt=(r,e,m)=>e(m()),zt=u('<button class="btn btn-xl"> </button>'),Qt=(r,e)=>e("Skip"),Xt=u('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),$t=(r,e)=>e("Over"),ea=u('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),ta=u("<option></option>"),aa=u("<option></option>"),ra=u("<!> <option></option>",1),na=u('<pre class="text-2xl"> </pre>'),ia=u('<pre class="text-2xl bg-error text-error-content"> </pre>'),la=(r,e,m)=>e.onSendMessage(n(m)),oa=u('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"/> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> </button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),sa=u('<span aria-live="polite"> </span>m',1),va=(r,e,m)=>e(m()),ca=u('<button class="btn"> </button>'),ua=u('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),_a=(r,e)=>e("Skip"),da=u('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),fa=(r,e)=>e("Over"),ga=u('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),ma=u("<option></option>"),xa=u("<option></option>"),ba=u("<!> <option></option>",1),pa=u('<pre class="text-md"> </pre>'),ya=u('<pre class="text-md bg-error text-error-content"> </pre>'),ha=(r,e,m)=>e.onSendMessage(n(m)),Aa=u('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"/> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> </button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),Ia=u('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function wa(r,e){Ke(e,!0);const[m,C]=Be(),_=()=>Ye(ze,"$_",m);let U=ae(""),ee=ae(0),re=ae(void 0),ie=ae(null);const J=be(()=>e.remain!==null?e.remain/(e.setting?.timeout.action??6e4)*100:0),te=be(()=>e.remain!==null?Math.floor(e.remain/6e4):0),k=be(()=>e.remain!==null?Math.floor(e.remain%6e4/1e3):0),v=be(()=>[xe.VOTE,xe.DIVINE,xe.GUARD,xe.ATTACK].includes(e.request));function x(h){if(!e.request||!e.setting)return 0;const O=e.request===xe.TALK?e.setting.talk.max_length:e.request===xe.WHISPER?e.setting.whisper.max_length:null;if(!O)return 0;let w=O.base_length??0;if(w+=e.info?.remain_length??0,O.mention_length){for(const Q in e.info?.status_map??{})if(h.indexOf("@"+Q)!==-1){w+=O.mention_length,w+=ut("@"+Q).length;break}}return O.per_talk&&(w=Math.min(w,O.per_talk)),w-=ut(h).length,w}Ot(()=>{j(ee,x(n(U)),!0)}),Je(()=>{const h=Re.subscribe(O=>{j(re,O,!0)});return()=>{h()}});function L(h){j(U,h,!0),n(ie)?.focus()}function z(h){h.focus()}var le=Ia(),ne=a(le);{var ue=h=>{var O=oa(),w=K(O),Q=a(w),M=a(Q);{var X=l=>{var d=Bt(),I=K(d),p=a(I,!0);t(I),Se(),E(Z=>{We(I,`--value:${n(te)??""};`),Te(I,"aria-label",Z),s(p,n(te))},[()=>n(te).toString()]),o(l,d)};R(M,l=>{e.remain&&e.remain>6e4&&l(X)})}var _e=i(M,2),fe=a(_e,!0);t(_e),Se(),t(Q);var B=i(Q,2),$=a(B,!0);t(B),t(w);var ve=i(w,2),Y=a(ve);{var ce=l=>{var d=de(),I=K(d);he(I,17,()=>Object.entries(e.info?.status_map??{}),Ae,(p,Z)=>{var N=be(()=>He(n(Z),2));let G=()=>n(N)[0],oe=()=>n(N)[1];var ge=de(),Ie=K(ge);{var we=pe=>{var ye=zt();ye.__click=[Yt,L,G];var Me=a(ye,!0);t(ye),E(()=>s(Me,G())),o(pe,ye)};R(Ie,pe=>{oe()===Pe.ALIVE&&G()!==e.info?.agent&&pe(we)})}o(p,ge)}),o(l,d)},g=l=>{var d=ea(),I=K(d);{var p=G=>{var oe=Xt();oe.__click=[Qt,L];var ge=a(oe);se(ge,"icon","mdi:arrow-u-down-right-bold"),Se(),t(oe),o(G,oe)};R(I,G=>{(e.info?.remain_skip??0)>0&&G(p)})}var Z=i(I,2);Z.__click=[$t,L];var N=a(Z);se(N,"icon","mdi:skip-forward"),Se(),t(Z),o(l,d)};R(Y,l=>{n(v)?l(ce):l(g,!1)})}var y=i(Y,2);De(y),y.__keydown=[dt,e,U],Xe(()=>nt(y,()=>n(U),l=>j(U,l))),lt(y,l=>z?.(l)),et(y,l=>j(ie,l),()=>n(ie));var T=i(y,2),W=a(T);{var V=l=>{var d=de(),I=K(d);he(I,17,()=>Object.entries(e.info?.status_map??{}),Ae,(p,Z)=>{var N=be(()=>He(n(Z),2));let G=()=>n(N)[0],oe=()=>n(N)[1];var ge=de(),Ie=K(ge);{var we=pe=>{var ye=ta(),Me={};E(()=>{Me!==(Me=G())&&(ye.value=(ye.__value=G())??"")}),o(pe,ye)};R(Ie,pe=>{oe()===Pe.ALIVE&&G()!==e.info?.agent&&pe(we)})}o(p,ge)}),o(l,d)},H=l=>{var d=ra(),I=K(d);{var p=N=>{var G=aa();G.value=G.__value="Skip",o(N,G)};R(I,N=>{(e.info?.remain_skip??0)>0&&N(p)})}var Z=i(I,2);Z.value=Z.__value="Over",o(l,d)};R(W,l=>{n(v)?l(V):l(H,!1)})}t(T);var P=i(T,2);{var D=l=>{var d=na(),I=a(d,!0);t(d),E(p=>s(I,p),[()=>_()("agent.remainingChars",{values:{count:n(ee)}})]),o(l,d)},S=l=>{var d=ia(),I=a(d,!0);t(d),E(p=>s(I,p),[()=>_()("agent.exceededChars",{values:{count:n(ee)*-1}})]),o(l,d)};R(P,l=>{n(ee)>=0?l(D):l(S,!1)})}var A=i(P,2);A.__click=[la,e,U];var q=a(A);se(q,"icon","mdi:send");var c=i(q);t(A),t(ve);var b=i(ve,2),f=a(b);t(b),E((l,d,I)=>{We(_e,`--value:${n(k)??""};`),Te(_e,"aria-label",l),s(fe,n(k)),s($,d),s(c,` ${I??""}`),qe(f,n(J))},[()=>n(k).toString(),()=>n(v)?`${_()(`game.request.${e.request}`)}${_()("agent.selectTarget")}`:`${_()(`game.request.${e.request}`)}${_()("agent.enterContent")}`,()=>_()("agent.send")]),o(h,O)},F=h=>{var O=Aa(),w=K(O),Q=a(w),M=a(Q);{var X=c=>{var b=sa(),f=K(b),l=a(f,!0);t(f),Se(),E((d,I,p)=>{We(f,`--value:${d??""};`),Te(f,"aria-label",I),s(l,p)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),o(c,b)};R(M,c=>{e.remain&&e.remain>6e4&&c(X)})}var _e=i(M,2),fe=a(_e,!0);t(_e),Se(),t(Q);var B=i(Q,2);{var $=c=>{var b=ua(),f=K(b),l=a(f);t(f);var d=i(f,2);he(d,17,()=>Object.entries(e.info?.status_map??{}),Ae,(I,p)=>{var Z=be(()=>He(n(p),2));let N=()=>n(Z)[0],G=()=>n(Z)[1];var oe=de(),ge=K(oe);{var Ie=we=>{var pe=ca();pe.__click=[va,L,N];var ye=a(pe,!0);t(pe),E(()=>s(ye,N())),o(we,pe)};R(ge,we=>{G()===Pe.ALIVE&&N()!==e.info?.agent&&we(Ie)})}o(I,oe)}),E((I,p)=>s(l,`${I??""}${p??""}`),[()=>_()(`game.request.${e.request}`),()=>_()("agent.selectTarget")]),o(c,b)},ve=c=>{var b=ga(),f=K(b),l=a(f);t(f);var d=i(f,2);{var I=N=>{var G=da();G.__click=[_a,L];var oe=a(G);se(oe,"icon","mdi:arrow-u-down-right-bold"),Se(),t(G),o(N,G)};R(d,N=>{(e.info?.remain_skip??0)>0&&N(I)})}var p=i(d,2);p.__click=[fa,L];var Z=a(p);se(Z,"icon","mdi:skip-forward"),Se(),t(p),E((N,G)=>s(l,`${N??""}${G??""}`),[()=>_()(`game.request.${e.request}`),()=>_()("agent.enterContent")]),o(c,b)};R(B,c=>{n(v)?c($):c(ve,!1)})}var Y=i(B,2);De(Y),Y.__keydown=[dt,e,U],Xe(()=>nt(Y,()=>n(U),c=>j(U,c))),lt(Y,c=>z?.(c)),et(Y,c=>j(ie,c),()=>n(ie));var ce=i(Y,2),g=a(ce);{var y=c=>{var b=de(),f=K(b);he(f,17,()=>Object.entries(e.info?.status_map??{}),Ae,(l,d)=>{var I=be(()=>He(n(d),2));let p=()=>n(I)[0],Z=()=>n(I)[1];var N=de(),G=K(N);{var oe=ge=>{var Ie=ma(),we={};E(()=>{we!==(we=p())&&(Ie.value=(Ie.__value=p())??"")}),o(ge,Ie)};R(G,ge=>{Z()===Pe.ALIVE&&p()!==e.info?.agent&&ge(oe)})}o(l,N)}),o(c,b)},T=c=>{var b=ba(),f=K(b);{var l=I=>{var p=xa();p.value=p.__value="Skip",o(I,p)};R(f,I=>{(e.info?.remain_skip??0)>0&&I(l)})}var d=i(f,2);d.value=d.__value="Over",o(c,b)};R(g,c=>{n(v)?c(y):c(T,!1)})}t(ce);var W=i(ce,2);{var V=c=>{var b=pa(),f=a(b,!0);t(b),E(l=>s(f,l),[()=>_()("agent.remainingChars",{values:{count:n(ee)}})]),o(c,b)},H=c=>{var b=ya(),f=a(b,!0);t(b),E(l=>s(f,l),[()=>_()("agent.exceededChars",{values:{count:n(ee)*-1}})]),o(c,b)};R(W,c=>{n(ee)>=0?c(V):c(H,!1)})}var P=i(W,2);P.__click=[ha,e,U];var D=a(P);se(D,"icon","mdi:send");var S=i(D);t(P),t(w);var A=i(w,2),q=a(A);t(A),E((c,b,f,l)=>{We(_e,`--value:${c??""};`),Te(_e,"aria-label",b),s(fe,f),s(S,` ${l??""}`),qe(q,n(J))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>_()("agent.send")]),o(h,O)};R(ne,h=>{n(re)?.display.largeScale?h(ue):h(F,!1)})}t(le),o(r,le),Ue(),C()}mt(["click","keydown"]);var ka=u('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),Ta=u('<pre class="text-md text-pretty break-all my-2"> </pre>'),Sa=u('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ra=u('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ea=u('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Oa=u('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Da=u('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),Na=u('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ca=u('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ma=u('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),La=u('<div class="grow overflow-y-auto pr-4"><pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!> <!></div>'),Fa=u('<pre class="text-lg text-center"> </pre>'),Ha=u('<h2 class="text-lg font-bold text-center">プロフィール</h2> <pre class="text-md text-pretty break-all"> </pre>',1),Pa=u('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ga=u('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ka=u('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ua=u('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Va=u('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),qa=u('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),ja=u('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Wa=u('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),Za=u('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">名前</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <!> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),Ja=u('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function Ba(r,e){Ke(e,!0);const[m,C]=Be(),_=()=>Ye(ze,"$_",m);let U=ae(void 0);Je(()=>{const k=Re.subscribe(v=>{j(U,v,!0)});je(k)});var ee=Ja(),re=a(ee),ie=a(re);{var J=k=>{var v=La(),x=a(v),L=a(x,!0);t(x);var z=i(x,2),le=a(z,!0);t(z);var ne=i(z,2),ue=a(ne,!0);t(ne);var F=i(ne,2);{var h=B=>{var $=ka(),ve=a($,!0);t($),E(Y=>s(ve,Y),[()=>_()(`game.request.${e.request}`)]),o(B,$)};R(F,B=>{e.request&&B(h)})}var O=i(F,2);{var w=B=>{var $=Ta(),ve=a($,!0);t($),E(()=>s(ve,e.profile)),o(B,$)};R(O,B=>{e.profile&&B(w)})}var Q=i(O,2);he(Q,17,()=>Object.entries(e.info.status_map??{}),Ae,(B,$)=>{var ve=be(()=>He(n($),2));let Y=()=>n(ve)[0],ce=()=>n(ve)[1];var g=de(),y=K(g);{var T=V=>{var H=Sa(),P=a(H),D=a(P,!0);t(P);var S=i(P,2),A=a(S,!0);t(S);var q=i(S,2),c=a(q,!0);t(q),t(H),E((b,f)=>{s(D,Y()),s(A,b),s(c,f)},[()=>(e.info.role_map??{})[Y()]?_()(`game.role.${(e.info.role_map??{})[Y()]}`):"",()=>_()(`game.status.${ce()}`)]),o(V,H)},W=V=>{var H=Ra(),P=a(H),D=a(P,!0);t(P);var S=i(P,2),A=a(S,!0);t(S);var q=i(S,2),c=a(q);t(q),t(H),E((b,f,l)=>{s(D,Y()),s(A,b),s(c,`${f??""}${l??""}`)},[()=>(e.info.role_map??{})[Y()]?_()(`game.role.${(e.info.role_map??{})[Y()]}`):"",()=>_()(`game.status.${ce()}`),()=>e.executedAgents.includes(Y())?" (追放)":e.attackedAgents.includes(Y())?" (襲撃)":""]),o(V,H)};R(y,V=>{ce()===Pe.ALIVE?V(T):V(W,!1)})}o(B,g)});var M=i(Q,2);{var X=B=>{var $=Da(),ve=i(K($),2);he(ve,17,()=>e.mediumResults,Ae,(Y,ce)=>{let g=()=>n(ce).day,y=()=>n(ce).target,T=()=>n(ce).result;var W=de(),V=K(W);{var H=D=>{var S=Ea(),A=a(S),q=a(A,!0);t(A);var c=i(A,2),b=a(c);t(c);var f=i(c,2),l=a(f,!0);t(f),t(S),E(d=>{s(q,y()),s(b,`(${g()??""}日目)`),s(l,d)},[()=>_()(`game.species.${T()}`)]),o(D,S)},P=D=>{var S=Oa(),A=a(S),q=a(A,!0);t(A);var c=i(A,2),b=a(c);t(c);var f=i(c,2),l=a(f,!0);t(f),t(S),E(d=>{s(q,y()),s(b,`(${g()??""}日目)`),s(l,d)},[()=>_()(`game.species.${T()}`)]),o(D,S)};R(V,D=>{T()!==Ze.HUMAN?D(H):D(P,!1)})}o(Y,W)}),o(B,$)};R(M,B=>{e.mediumResults.length>0&&B(X)})}var _e=i(M,2);{var fe=B=>{var $=Ma(),ve=i(K($),2);he(ve,17,()=>e.divineResults,Ae,(Y,ce)=>{let g=()=>n(ce).day,y=()=>n(ce).target,T=()=>n(ce).result;var W=de(),V=K(W);{var H=D=>{var S=Na(),A=a(S),q=a(A,!0);t(A);var c=i(A,2),b=a(c);t(c);var f=i(c,2),l=a(f,!0);t(f),t(S),E(d=>{s(q,y()),s(b,`(${g()??""}日目)`),s(l,d)},[()=>_()(`game.species.${T()}`)]),o(D,S)},P=D=>{var S=Ca(),A=a(S),q=a(A,!0);t(A);var c=i(A,2),b=a(c);t(c);var f=i(c,2),l=a(f,!0);t(f),t(S),E(d=>{s(q,y()),s(b,`(${g()??""}日目)`),s(l,d)},[()=>_()(`game.species.${T()}`)]),o(D,S)};R(V,D=>{T()!==Ze.HUMAN?D(H):D(P,!1)})}o(Y,W)}),o(B,$)};R(_e,B=>{e.divineResults.length>0&&B(fe)})}t(v),E(B=>{s(L,e.agent?e.agent:"ゲーム外"),s(le,B),s(ue,e.info?e.info.day+"日目":"ゲーム外")},[()=>e.role?_()(`game.role.${e.role}`):"ゲーム外"]),o(k,v)},te=k=>{var v=Za(),x=i(K(v),2),L=a(x),z=a(L),le=i(a(z),2),ne=a(le,!0);t(le),t(z);var ue=i(z,2),F=i(a(ue),2),h=a(F,!0);t(F),t(ue);var O=i(ue,2),w=i(a(O),2),Q=a(w,!0);t(w),t(O);var M=i(O,2),X=i(a(M),2);{var _e=y=>{var T=Fa(),W=a(T,!0);t(T),E(V=>s(W,V),[()=>_()(`game.request.${e.request}`)]),o(y,T)};R(X,y=>{e.request&&y(_e)})}t(M),t(L);var fe=i(L,2);{var B=y=>{var T=Ha(),W=i(K(T),2),V=a(W,!0);t(W),E(()=>s(V,e.profile)),o(y,T)};R(fe,y=>{e.profile&&y(B)})}var $=i(fe,4);he($,17,()=>Object.entries(e.info.status_map??{}),Ae,(y,T)=>{var W=be(()=>He(n(T),2));let V=()=>n(W)[0],H=()=>n(W)[1];var P=de(),D=K(P);{var S=q=>{var c=Pa(),b=a(c),f=a(b,!0);t(b);var l=i(b,2),d=a(l,!0);t(l);var I=i(l,2),p=a(I,!0);t(I),t(c),E((Z,N)=>{s(f,V()),s(d,Z),s(p,N)},[()=>(e.info.role_map??{})[V()]?_()(`game.role.${(e.info.role_map??{})[V()]}`):"",()=>_()(`game.status.${H()}`)]),o(q,c)},A=q=>{var c=Ga(),b=a(c),f=a(b,!0);t(b);var l=i(b,2),d=a(l,!0);t(l);var I=i(l,2),p=a(I);t(I),t(c),E((Z,N,G)=>{s(f,V()),s(d,Z),s(p,`${N??""}${G??""}`)},[()=>(e.info.role_map??{})[V()]?_()(`game.role.${(e.info.role_map??{})[V()]}`):"",()=>_()(`game.status.${H()}`),()=>e.executedAgents.includes(V())?" (追放)":e.attackedAgents.includes(V())?" (襲撃)":""]),o(q,c)};R(D,q=>{H()===Pe.ALIVE?q(S):q(A,!1)})}o(y,P)});var ve=i($,2);{var Y=y=>{var T=Va(),W=i(K(T),2);he(W,17,()=>e.mediumResults,Ae,(V,H)=>{let P=()=>n(H).day,D=()=>n(H).target,S=()=>n(H).result;var A=de(),q=K(A);{var c=f=>{var l=Ka(),d=a(l),I=a(d,!0);t(d);var p=i(d,2),Z=a(p);t(p);var N=i(p,2),G=a(N,!0);t(N),t(l),E(oe=>{s(I,D()),s(Z,`(${P()??""}日目)`),s(G,oe)},[()=>_()(`game.species.${S()}`)]),o(f,l)},b=f=>{var l=Ua(),d=a(l),I=a(d,!0);t(d);var p=i(d,2),Z=a(p);t(p);var N=i(p,2),G=a(N,!0);t(N),t(l),E(oe=>{s(I,D()),s(Z,`(${P()??""}日目)`),s(G,oe)},[()=>_()(`game.species.${S()}`)]),o(f,l)};R(q,f=>{S()!==Ze.HUMAN?f(c):f(b,!1)})}o(V,A)}),o(y,T)};R(ve,y=>{e.mediumResults.length>0&&y(Y)})}var ce=i(ve,2);{var g=y=>{var T=Wa(),W=i(K(T),2);he(W,17,()=>e.divineResults,Ae,(V,H)=>{let P=()=>n(H).day,D=()=>n(H).target,S=()=>n(H).result;var A=de(),q=K(A);{var c=f=>{var l=qa(),d=a(l),I=a(d,!0);t(d);var p=i(d,2),Z=a(p);t(p);var N=i(p,2),G=a(N,!0);t(N),t(l),E(oe=>{s(I,D()),s(Z,`(${P()??""}日目)`),s(G,oe)},[()=>_()(`game.species.${S()}`)]),o(f,l)},b=f=>{var l=ja(),d=a(l),I=a(d,!0);t(d);var p=i(d,2),Z=a(p);t(p);var N=i(p,2),G=a(N,!0);t(N),t(l),E(oe=>{s(I,D()),s(Z,`(${P()??""}日目)`),s(G,oe)},[()=>_()(`game.species.${S()}`)]),o(f,l)};R(q,f=>{S()!==Ze.HUMAN?f(c):f(b,!1)})}o(V,A)}),o(y,T)};R(ce,y=>{e.divineResults.length>0&&y(g)})}t(x),E(y=>{s(ne,e.agent?e.agent:"ゲーム外"),s(h,y),s(Q,e.info?e.info.day+"日目":"ゲーム外")},[()=>e.role?_()(`game.role.${e.role}`):"ゲーム外"]),o(k,v)};R(ie,k=>{n(U)?.display.largeScale?k(J):k(te,!1)})}t(re),t(ee),o(r,ee),Ue(),C()}function Ya(){Ge.connect()}function za(){Ge.disconnect()}var Qa=u('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Xa=u('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),$a=u('<div class="status status-error"></div>'),er=(r,e)=>e("connection.url",r.currentTarget.value),tr=(r,e)=>e("connection.token",r.currentTarget.value),ar=(r,e)=>e("team",r.currentTarget.value),rr=(r,e)=>e("display.largeScale",r.currentTarget.checked),nr=u('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./"> </a> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow"/></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow"/> <span class="badge badge-neutral badge-xs"> </span></label> <button class="btn btn-info"> </button> <button class="btn btn-error"> </button> <button class="btn"> </button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold"> </h3> <h4 class="text-base font-bold mt-2"> </h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"/></label> <h3 class="text-lg font-bold mt-4"> </h3> <h4 class="text-base font-bold mt-2"> </h4> <label class="label cursor-pointer my-2"><span class="label-text"> </span> <input type="checkbox" class="checkbox"/></label> <h4 class="text-base font-bold mt-2"> </h4> <div class="my-2"><!></div></div></div> <form method="dialog" class="modal-backdrop"><button> </button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"/> <iconify-icon></iconify-icon></label></div>',2);function ir(r,e){Ke(e,!0);const[m,C]=Be(),_=()=>Ye(ze,"$_",m);let U=ae(void 0),ee=ae(void 0);const re=Re.subscribe(me=>{j(U,me,!0)}),ie=Ge.subscribe(me=>{j(ee,me.status,!0)});je(()=>{re(),ie()});function J(me,Ee){Re.update(Le=>{const Fe=me.split("."),Ve=Fe.pop();let ke=Le;for(const Oe of Fe)Oe&&(ke=ke[Oe]);return ke[Ve]=Ee,{...Le}})}let te;var k=nr(),v=a(k),x=a(v,!0);t(v);var L=i(v,2),z=a(L),le=a(z);{var ne=me=>{var Ee=Qa();Se(2),o(me,Ee)},ue=me=>{var Ee=de(),Le=K(Ee);{var Fe=ke=>{var Oe=Xa();Se(2),o(ke,Oe)},Ve=ke=>{var Oe=$a();o(ke,Oe)};R(Le,ke=>{n(ee)==="connecting"?ke(Fe):ke(Ve,!1)},!0)}o(me,Ee)};R(le,me=>{n(ee)==="connected"?me(ne):me(ue,!1)})}t(z),t(L);var F=i(L,2),h=a(F);Qe(h,1,"h-[1em] opacity-50"),se(h,"inline",!0),se(h,"icon","mdi:link");var O=i(h,2);De(O),O.__input=[er,J],t(F);var w=i(F,2),Q=a(w);Qe(Q,1,"h-[1em] opacity-50"),se(Q,"inline",!0),se(Q,"icon","mdi:key");var M=i(Q,2);De(M),M.__input=[tr,J];var X=i(M,2),_e=a(X,!0);t(X),t(w);var fe=i(w,2);fe.__click=[Ya];var B=a(fe,!0);t(fe);var $=i(fe,2);$.__click=[za];var ve=a($,!0);t($);var Y=i($,2);Y.__click=()=>te.showModal();var ce=a(Y,!0);t(Y);var g=i(Y,2),y=a(g),T=a(y),W=a(T),V=a(W,!0);t(W);var H=i(W,2),P=a(H,!0);t(H);var D=i(H,2),S=a(D);Qe(S,1,"h-[1em] opacity-50"),se(S,"inline",!0),se(S,"icon","mdi:rename");var A=i(S,2);De(A),A.__input=[ar,J],t(D);var q=i(D,2),c=a(q,!0);t(q);var b=i(q,2),f=a(b,!0);t(b);var l=i(b,2),d=a(l),I=a(d,!0);t(d);var p=i(d,2);De(p),p.__change=[rr,J],t(l);var Z=i(l,2),N=a(Z,!0);t(Z);var G=i(Z,2),oe=a(G);Mt(oe,{}),t(G),t(T),t(y);var ge=i(y,2),Ie=a(ge),we=a(Ie,!0);t(Ie),t(ge),t(g),et(g,me=>te=me,()=>te);var pe=i(g,2),ye=a(pe);se(ye,"inline",!0),se(ye,"icon","mdi:white-balance-sunny");var Me=i(ye,2),rt=i(Me,2);se(rt,"inline",!0),se(rt,"icon","mdi:moon-and-stars"),t(pe),t(k),E((me,Ee,Le,Fe,Ve,ke,Oe,ht,At,It,wt,kt,Tt,St)=>{s(x,me),Te(O,"placeholder",Ee),qe(O,n(U)?.connection.url),Te(M,"placeholder",Le),qe(M,n(U)?.connection.token),s(_e,Fe),fe.disabled=n(ee)!=="disconnected",s(B,Ve),$.disabled=n(ee)==="disconnected",s(ve,ke),s(ce,Oe),s(V,ht),s(P,At),qe(A,n(U)?.team),s(c,It),s(f,wt),s(I,kt),$e(p,n(U)?.display.largeScale),s(N,Tt),s(we,St)},[()=>_()("appName"),()=>_()("realtime.websocketUrl"),()=>_()("realtime.authKey"),()=>_()("realtime.optional"),()=>_()("realtime.connect"),()=>_()("realtime.disconnect"),()=>_()("realtime.settings"),()=>_()("agent.agentSettings"),()=>_()("agent.teamName"),()=>_()("realtime.displaySettings"),()=>_()("realtime.largeScreen"),()=>_()("realtime.enable"),()=>_()("common.language"),()=>_()("common.close")]),o(r,k),Ue(),C()}mt(["input","click","change"]);var lr=u("<iconify-icon></iconify-icon>",2),or=u("<iconify-icon></iconify-icon>",2),sr=u('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),vr=u('<div class="chat-image avatar"><div class="w-20 rounded-full"><img/></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),cr=u("<iconify-icon></iconify-icon>",2),ur=u("<iconify-icon></iconify-icon>",2),_r=u('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),dr=u('<div class="chat-image avatar"><div class="w-10 rounded-full"><img/></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),fr=u('<div class="chat chat-start"><!></div>');function ft(r,e){Ke(e,!0);let m=ae(void 0);Je(()=>{const re=Re.subscribe(ie=>{j(m,ie,!0)});je(re)});var C=fr(),_=a(C);{var U=re=>{var ie=vr(),J=K(ie),te=a(J),k=a(te);t(te),t(J);var v=i(J,2),x=a(v,!0);t(v);var L=i(v,2);{var z=F=>{var h=lr();se(h,"inline",!0),se(h,"icon","mdi:skip-forward"),o(F,h)},le=F=>{var h=de(),O=K(h);{var w=M=>{var X=or();se(X,"inline",!0),se(X,"icon","mdi:arrow-u-down-right-bold"),o(M,X)},Q=M=>{var X=sr(),_e=a(X,!0);t(X),E(()=>s(_e,e.talk.text)),o(M,X)};R(O,M=>{e.talk.skip?M(w):M(Q,!1)},!0)}o(F,h)};R(L,F=>{e.talk.over?F(z):F(le,!1)})}var ne=i(L,2),ue=a(ne);t(ne),E(()=>{Te(k,"src",e.isDefaultProfile?`${it}${tt[e.talk.agent]}`:""),Te(k,"alt",e.talk.agent),s(x,e.talk.agent),s(ue,`Idx: ${e.talk.idx??""}`)}),o(re,ie)},ee=re=>{var ie=dr(),J=K(ie),te=a(J),k=a(te);t(te),t(J);var v=i(J,2),x=a(v,!0);t(v);var L=i(v,2);{var z=F=>{var h=cr();se(h,"inline",!0),se(h,"icon","mdi:skip-forward"),o(F,h)},le=F=>{var h=de(),O=K(h);{var w=M=>{var X=ur();se(X,"inline",!0),se(X,"icon","mdi:arrow-u-down-right-bold"),o(M,X)},Q=M=>{var X=_r(),_e=a(X,!0);t(X),E(()=>s(_e,e.talk.text)),o(M,X)};R(O,M=>{e.talk.skip?M(w):M(Q,!1)},!0)}o(F,h)};R(L,F=>{e.talk.over?F(z):F(le,!1)})}var ne=i(L,2),ue=a(ne);t(ne),E(()=>{Te(k,"src",e.isDefaultProfile?`${it}${tt[e.talk.agent]}`:""),Te(k,"alt",e.talk.agent),s(x,e.talk.agent),s(ue,`Idx: ${e.talk.idx??""}`)}),o(re,ie)};R(_,re=>{n(m)?.display.largeScale?re(U):re(ee,!1)})}t(C),o(r,C),Ue()}var gr=u('<input type="radio" name="talk_days" class="tab text-lg font-bold"/> <div class="tab-content my-4"></div>',1),mr=u('<div class="tabs tabs-border"></div>'),xr=u('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),br=u('<input type="radio" name="talk_days" class="tab"/> <div class="tab-content my-4"></div>',1),pr=u('<div class="tabs tabs-border"></div>'),yr=u('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),hr=u('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function gt(r,e){Ke(e,!0);let m=ae(void 0),C=e.agents.every(J=>Object.keys(tt).includes(J));Je(()=>{const J=Re.subscribe(te=>{j(m,te,!0)});je(J)});var _=hr(),U=a(_),ee=a(U);{var re=J=>{var te=xr(),k=K(te),v=a(k,!0);t(k);var x=i(k,2),L=a(x);{var z=le=>{var ne=mr();const ue=be(()=>[...new Set(e.talks.map(F=>F.day))].sort((F,h)=>h-F));he(ne,21,()=>n(ue),Ae,(F,h)=>{var O=gr(),w=K(O);De(w);var Q=i(w,2);he(Q,21,()=>e.talks.filter(M=>M.day===n(h)),Ae,(M,X)=>{ft(M,{get talk(){return n(X)},get agents(){return e.agents},get isDefaultProfile(){return C}})}),t(Q),E(()=>{$e(w,n(h)===n(ue)[0]),Te(w,"aria-label",`${n(h)}日目`)}),o(F,O)}),t(ne),o(le,ne)};R(L,le=>{e.talks.length>0&&le(z)})}t(x),E(()=>s(v,e.header)),o(J,te)},ie=J=>{var te=yr(),k=K(te),v=a(k,!0);t(k);var x=i(k,2),L=a(x);{var z=le=>{var ne=pr();const ue=be(()=>[...new Set(e.talks.map(F=>F.day))].sort((F,h)=>h-F));he(ne,21,()=>n(ue),Ae,(F,h)=>{var O=br(),w=K(O);De(w);var Q=i(w,2);he(Q,21,()=>e.talks.filter(M=>M.day===n(h)),Ae,(M,X)=>{ft(M,{get talk(){return n(X)},get agents(){return e.agents},get isDefaultProfile(){return C}})}),t(Q),E(()=>{$e(w,n(h)===n(ue)[0]),Te(w,"aria-label",`${n(h)}日目`)}),o(F,O)}),t(ne),o(le,ne)};R(L,le=>{e.talks.length>0&&le(z)})}t(x),E(()=>s(v,e.header)),o(J,te)};R(ee,J=>{n(m)?.display.largeScale?J(re):J(ie,!1)})}t(U),t(_),o(r,_),Ue()}var Ar=u('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),Ir=u('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none"> </pre></div>'),wr=u('<div role="alert" class="alert m-4"><span class="text-lg font-bold"> </span></div>'),kr=u('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Kr(r,e){Ke(e,!0);const[m,C]=Be(),_=()=>Ye(ze,"$_",m);let U=ae(void 0),ee=ae(""),re=ae(null),ie=ae(Ne([])),J=ae(null),te=ae(null),k=ae(null),v=ae(null),x=ae(null),L=ae(Ne([])),z=ae(Ne([])),le=ae(null),ne=ae(Ne([])),ue=ae(Ne([])),F=ae(Ne([])),h=ae(Ne([])),O=ae(null),w=ae(null),Q=Re.subscribe(g=>{j(U,g,!0)}),M=Ge.subscribe(g=>{j(ee,g.status,!0),g.deadline?(j(re,g.deadline.getTime(),!0),_e()):(j(re,null),j(O,null),n(w)&&(cancelAnimationFrame(n(w)),j(w,null))),j(ie,g.entries,!0),j(J,g.agent,!0),j(te,g.role,!0),j(k,g.profile,!0),j(v,g.request,!0),j(x,g.info,!0),j(L,g.mediumResults,!0),j(z,g.divineResults,!0),j(le,g.setting,!0),j(ne,g.talkHistory,!0),j(ue,g.whisperHistory,!0),j(F,g.executedAgents,!0),j(h,g.attackedAgents,!0)});function X(){const g=Nt.url.searchParams,y=g.get("url"),T=g.get("token");y&&(Re.update(W=>({...W,connection:{url:y??"",token:T??""}})),Ge.connect())}function _e(){if(n(re)===null)return;const g=()=>{if(n(re)===null)return;const y=Date.now(),T=Math.max(0,n(re)-y);j(O,T,!0),T>0?j(w,requestAnimationFrame(g),!0):(j(O,0),j(w,null))};n(w)&&cancelAnimationFrame(n(w)),j(w,requestAnimationFrame(g),!0)}function fe(g){Ge.send(g)}{X();const g=T=>{n(ee)==="connected"&&T.preventDefault()},y=T=>{n(ee)==="connected"&&T.preventDefault()};window.addEventListener("beforeunload",g),window.addEventListener("popstate",y),je(()=>{window.removeEventListener("beforeunload",g),window.removeEventListener("popstate",y),n(w)&&cancelAnimationFrame(n(w)),Q(),M()})}var B=kr();Rt(g=>{Dt.title="aiwolf-nlp-viewer"});var $=a(B);ir($,{});var ve=i($,2);{var Y=g=>{var y=Ar(),T=K(y),W=a(T);Ba(W,{get agent(){return n(J)},get role(){return n(te)},get profile(){return n(k)},get request(){return n(v)},get info(){return n(x)},get mediumResults(){return n(L)},get divineResults(){return n(z)},get executedAgents(){return n(F)},get attackedAgents(){return n(h)}});var V=i(W,2);{let A=be(()=>_()("agent.talkHistory")),q=be(()=>Object.keys(n(x)?.status_map??{}));gt(V,{get header(){return n(A)},get talks(){return n(ne)},get agents(){return n(q)}})}var H=i(V,2);{var P=A=>{{let q=be(()=>_()("agent.whisperHistory")),c=be(()=>Object.keys(n(x)?.status_map??{}));gt(A,{get header(){return n(q)},get talks(){return n(ue)},get agents(){return n(c)}})}};R(H,A=>{n(te)===Ct.WEREWOLF&&A(P)})}t(T);var D=i(T,2);{var S=A=>{wa(A,{get remain(){return n(O)},get setting(){return n(le)},get request(){return n(v)},get info(){return n(x)},onSendMessage:fe})};R(D,A=>{n(O)!==null&&A(S)})}o(g,y)},ce=g=>{var y=de(),T=K(y);{var W=H=>{var P=Ir(),D=a(P),S=a(D,!0);t(D),t(P),E(A=>s(S,A),[()=>_()("agent.notConnected")]),o(H,P)},V=H=>{var P=wr(),D=a(P),S=a(D,!0);t(D),t(P),E(A=>s(S,A),[()=>_()("agent.notConnected")]),o(H,P)};R(T,H=>{n(U)?.display.largeScale?H(W):H(V,!1)},!0)}o(g,y)};R(ve,g=>{n(x)!==null?g(Y):g(ce,!1)})}t(B),o(r,B),Ue(),C()}export{Kr as component};
