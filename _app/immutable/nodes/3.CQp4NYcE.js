var Le=Object.defineProperty;var He=(t,e,n)=>e in t?Le(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Bt=(t,e,n)=>He(t,typeof e!="symbol"?e+"":e,n);import{t as _,a as u,c as Ut}from"../chunks/CQIKem6B.js";import{p as me,h as Kt,s,t as R,a as ge,aG as Ct,c as a,g as c,r,aI as yt,f as ut,$ as Re,y as ue}from"../chunks/DJzILnW5.js";import{d as be,s as S}from"../chunks/bj5TrsLi.js";import{i as U}from"../chunks/bGcRSTrU.js";import{e as lt,i as ct}from"../chunks/n8ULSs76.js";import{h as je}from"../chunks/74kPUpG4.js";import{a as X,r as St,c as Wt,s as pt,d as de}from"../chunks/BBBnxr-X.js";import{b as Me}from"../chunks/CjNUzvzv.js";import{p as Mt}from"../chunks/BaREKndI.js";import{b as he}from"../chunks/D1AgY69q.js";import{s as $e,a as Q,b as $t}from"../chunks/BiPIVzBk.js";import{p as Je}from"../chunks/CTe_BcGp.js";import{w as C}from"../chunks/B7xs7M_3.js";import{a as xe,o as Fe}from"../chunks/CSRI-F4q.js";/* empty css                */class Qt{static fromJson(e){return We(JSON.parse(e),ee("AgentSettings"))}static toJson(e){return JSON.stringify(Pe(e,ee("AgentSettings")),null,2)}}function _t(t,e,n,b=""){const j=te(t),D=b?` on ${b}`:"",k=n?` for key "${n}"`:"";throw Error(`Invalid value${k}${D}. Expected ${j} but got ${JSON.stringify(e)}`)}function te(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${te(t[1])}`:`one of [${t.map(e=>te(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function Ve(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(n=>e[n.json]={key:n.js,typ:n.typ}),t.jsonToJS=e}return t.jsonToJS}function Ue(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(n=>e[n.js]={key:n.json,typ:n.typ}),t.jsToJSON=e}return t.jsToJSON}function kt(t,e,n,b="",j=""){function D(o,h){return typeof o==typeof h?h:_t(o,h,b,j)}function k(o,h){const I=o.length;for(let p=0;p<I;p++){const x=o[p];try{return kt(h,x,n)}catch{}}return _t(o,h,b,j)}function dt(o,h){return o.indexOf(h)!==-1?h:_t(o.map(I=>Ft(I)),h,b,j)}function G(o,h){return Array.isArray(h)?h.map(I=>kt(I,o,n)):_t(Ft("array"),h,b,j)}function W(o){if(o===null)return null;const h=new Date(o);return isNaN(h.valueOf())?_t(Ft("Date"),o,b,j):h}function M(o,h,I){if(I===null||typeof I!="object"||Array.isArray(I))return _t(Ft(Y||"object"),I,b,j);const p={};return Object.getOwnPropertyNames(o).forEach(x=>{const $=o[x],vt=Object.prototype.hasOwnProperty.call(I,x)?I[x]:void 0;p[$.key]=kt(vt,$.typ,n,x,Y)}),Object.getOwnPropertyNames(I).forEach(x=>{Object.prototype.hasOwnProperty.call(o,x)||(p[x]=kt(I[x],h,n,x,Y))}),p}if(e==="any")return t;if(e===null)return t===null?t:_t(e,t,b,j);if(e===!1)return _t(e,t,b,j);let Y;for(;typeof e=="object"&&e.ref!==void 0;)Y=e.ref,e=Ke[e.ref];return Array.isArray(e)?dt(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?k(e.unionMembers,t):e.hasOwnProperty("arrayItems")?G(e.arrayItems,t):e.hasOwnProperty("props")?M(n(e),e.additional,t):_t(e,t,b,j):e===Date&&typeof t!="number"?W(t):D(e,t)}function We(t,e){return kt(t,e,Ve)}function Pe(t,e){return kt(t,e,Ue)}function Ft(t){return{literal:t}}function ve(t,e){return{props:t,additional:e}}function ee(t){return{ref:t}}const Ke={AgentSettings:ve([{json:"connection",js:"connection",typ:ee("Connection")},{json:"team",js:"team",typ:""}],!1),Connection:ve([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1)},fe={connection:{url:"ws://localhost:8080/ws",token:""},team:"default"};function Ce(){const t=localStorage.getItem("agent-settings");if(t)try{return Qt.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",Qt.toJson(fe)),fe}const Tt=C(Ce());Tt.subscribe(t=>{localStorage.setItem("agent-settings",Qt.toJson(t))});var nt=(t=>(t.NAME="NAME",t.TALK="TALK",t.WHISPER="WHISPER",t.VOTE="VOTE",t.DIVINE="DIVINE",t.GUARD="GUARD",t.ATTACK="ATTACK",t.INITIALIZE="INITIALIZE",t.DAILY_INITIALIZE="DAILY_INITIALIZE",t.DAILY_FINISH="DAILY_FINISH",t.FINISH="FINISH",t))(nt||{});const Ge={NAME:"名前",TALK:"トーク",WHISPER:"囁き",VOTE:"投票",DIVINE:"占い",GUARD:"護衛",ATTACK:"襲撃",INITIALIZE:"ゲーム開始",DAILY_INITIALIZE:"昼開始",DAILY_FINISH:"昼終了",FINISH:"ゲーム終了"};var ne=(t=>(t.HUMAN="HUMAN",t.WEREWOLF="WEREWOLF",t))(ne||{});const Vt={HUMAN:"人間",WEREWOLF:"人狼"};var Pt=(t=>(t.ALIVE="ALIVE",t.DEAD="DEAD",t))(Pt||{});const _e={ALIVE:"生存",DEAD:"死亡"},pe={WEREWOLF:"人狼",POSSESSED:"狂人",SEER:"占い師",BODYGUARD:"騎士",VILLAGER:"村人",MEDIUM:"霊媒師"};function Ye(){const{subscribe:t,update:e}=C({status:"disconnected",deadline:null,entries:[],role:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let n=null,b=null,j=null,D=null;Tt.subscribe(W=>{b=W});function k(){n&&(n.close(),n=null),D&&(D.clear(),D=null),e(W=>({...W,status:"disconnected",deadline:null,entries:[],role:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]}))}function dt(){if(!b)return;n&&k(),e(M=>({...M,status:"connecting"}));const W=new URL(b.connection.url);b.connection.token&&W.searchParams.set("token",b.connection.token),n=new WebSocket(W),n.onopen=()=>{e(M=>({...M,status:"connected"}))},n.onclose=()=>{k()},n.onerror=()=>{k()},n.onmessage=M=>{try{const Y=Date.now(),o=JSON.parse(M.data);switch(e(h=>{const I=h.entries.slice();I.push(o);const p={...h,entries:I,request:o.request};if(o.info){if(p.info=o.info,o.info.mediumResult){const x=o.info.mediumResult;p.mediumResults.findIndex($=>$.day===x.day&&$.agent===x.agent)<0&&p.mediumResults.push(o.info.mediumResult)}if(o.info.divineResult){const x=o.info.divineResult;p.divineResults.findIndex($=>$.day===x.day&&$.agent===x.agent)<0&&p.divineResults.push(o.info.divineResult)}o.info.executedAgent&&p.executedAgents.push(o.info.executedAgent),o.info.attackedAgent&&p.attackedAgents.push(o.info.attackedAgent)}return o.setting&&(p.setting=o.setting,j=o.setting.actionTimeout),o.talkHistory&&p.talkHistory.push(...o.talkHistory),o.whisperHistory&&p.whisperHistory.push(...o.whisperHistory),o.request===nt.INITIALIZE&&p.info&&p.info.roleMap&&p.info.agent&&(p.role=p.info.roleMap[p.info.agent]),p}),o.request){case nt.NAME:G((b==null?void 0:b.team)||"viewer"+Math.floor(Math.random()*1e3));break;case nt.TALK:case nt.WHISPER:case nt.VOTE:case nt.DIVINE:case nt.GUARD:case nt.ATTACK:D&&D.clear(),D=new Ze(()=>{G("TIMEOUT")},new Date(Y+(j??6e4))),e(h=>({...h,deadline:(D==null?void 0:D.deadline())??null}));break;case nt.FINISH:k();break}}catch(Y){console.error("Failed to parse message:",Y)}}}function G(W){if(D&&(D.clear(),D=null,e(M=>({...M,deadline:null}))),n&&n.readyState===WebSocket.OPEN)try{n.send(W),e(M=>{const Y=M.entries.slice();return Y.push(W),{...M,entries:Y}})}catch(M){console.error("Failed to send message:",M)}}return{subscribe:t,connect:dt,disconnect:k,send:G}}const Nt=Ye();class Ze{constructor(e,n){Bt(this,"timeout");Bt(this,"_deadline");this.timeout=setTimeout(e,n.getTime()-new Date().getTime()),this._deadline=n}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}function qe(){Nt.connect()}function ze(){Nt.disconnect()}var Xe=_('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Be=_('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),Qe=_('<div class="status status-error"></div>'),tn=(t,e)=>e("connection.url",t.currentTarget.value),en=(t,e)=>e("connection.token",t.currentTarget.value),nn=(t,e)=>e("team",t.currentTarget.value),rn=_('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><h1 class="text-3xl font-bold text-nowrap ml-2">aiwolf-nlp-viewer</h1> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="WebSocket URL"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="Authorization Key"> <span class="badge badge-neutral badge-xs">Optional</span></label> <button class="btn btn-info">接続</button> <button class="btn btn-error">切断</button> <button class="btn">設定</button> <dialog class="modal"><div class="modal-box"><div class="form-control"><h3 class="text-lg font-bold mt-2">エージェント設定</h3> <h4 class="text-base font-bold mt-4">チーム名</h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function an(t,e){me(e,!0);let n=Ct(void 0),b=Ct(void 0);const j=Tt.subscribe(N=>{Kt(n,Mt(N))}),D=Nt.subscribe(N=>{Kt(b,Mt(N.status))});xe(()=>{j(),D()});function k(N,Z){Tt.update(ft=>{const rt=N.split("."),ht=rt.pop();let tt=ft;for(const it of rt)it&&(tt=tt[it]);return tt[ht]=Z,{...ft}})}let dt;var G=rn(),W=s(a(G),2),M=a(W),Y=a(M);{var o=N=>{var Z=Xe();yt(2),u(N,Z)},h=N=>{var Z=Ut(),ft=ut(Z);{var rt=tt=>{var it=Be();yt(2),u(tt,it)},ht=tt=>{var it=Qe();u(tt,it)};U(ft,tt=>{c(b)==="connecting"?tt(rt):tt(ht,!1)},!0)}u(N,Z)};U(Y,N=>{c(b)==="connected"?N(o):N(h,!1)})}r(M),r(W);var I=s(W,2),p=a(I);X(p,"class","h-[1em] opacity-50"),X(p,"inline",!0),X(p,"icon","mdi:link");var x=s(p,2);St(x),x.__input=[tn,k],r(I);var $=s(I,2),vt=a($);X(vt,"class","h-[1em] opacity-50"),X(vt,"inline",!0),X(vt,"icon","mdi:key");var wt=s(vt,2);St(wt),wt.__input=[en,k],yt(2),r($);var mt=s($,2);mt.__click=[qe];var At=s(mt,2);At.__click=[ze];var Dt=s(At,2);Dt.__click=()=>dt.showModal();var gt=s(Dt,2),Ot=a(gt),Lt=a(Ot),Ht=s(a(Lt),4),bt=a(Ht);X(bt,"class","h-[1em] opacity-50"),X(bt,"inline",!0),X(bt,"icon","mdi:rename");var It=s(bt,2);St(It),It.__input=[nn,k],r(Ht),r(Lt),r(Ot),yt(2),r(gt),he(gt,N=>dt=N,()=>dt);var Rt=s(gt,2),Et=a(Rt);X(Et,"inline",!0),X(Et,"icon","mdi:white-balance-sunny");var jt=s(Et,4);X(jt,"inline",!0),X(jt,"icon","mdi:moon-and-stars"),r(Rt),r(G),R(()=>{var N,Z,ft;Wt(x,(N=c(n))==null?void 0:N.connection.url),Wt(wt,(Z=c(n))==null?void 0:Z.connection.token),mt.disabled=c(b)!=="disconnected",At.disabled=c(b)==="disconnected",Wt(It,(ft=c(n))==null?void 0:ft.team)}),u(t,G),ge()}be(["input","click"]);var on=_('<pre class="bg-primary text-primary-content p-2"> </pre>'),sn=_('<pre class="font-bold bg-info text-info-content ml-auto"> </pre>'),ln=_('<pre class="font-bold bg-error text-error-content ml-auto"> </pre>'),cn=_('<div class="flex flex-row gap-2"><pre> </pre> <pre> </pre> <!></div>'),un=_('<pre class="font-bold bg-success text-success-content ml-auto"> </pre>'),dn=_('<pre class="font-bold bg-error text-error-content ml-auto"> </pre>'),vn=_('<div class="flex flex-row gap-2"><pre> </pre> <pre> </pre> <!></div>'),fn=_('<div class="p-2"><h2 class="font-bold text-lg">霊能結果</h2> <!></div>'),_n=_('<pre class="font-bold bg-info text-info-content ml-auto"> </pre>'),pn=_('<pre class="font-bold bg-error text-error-content ml-auto"> </pre>'),mn=_('<div class="flex flex-row gap-2"><pre> </pre> <pre> </pre> <!></div>'),gn=_('<div class="p-2"><h2 class="font-bold text-lg">占い結果</h2> <!></div>'),bn=_('<div class="p-2"></div> <!> <!>',1),hn=_('<div class="chat chat-start"><div class="chat-image avatar avatar-placeholder"><div class="bg-neutral text-neutral-content w-12 rounded-full"><span class="text-2xl"> </span></div></div> <div class="chat-header"></div> <div class="chat-bubble bg-base-100 text-pretty break-all"> </div> <pre class="chat-footer opacity-50"> </pre></div>'),xn=_('<input type="radio" name="talk_days" class="tab"> <div class="tab-content bg-base-200 p-2 max-h-96 overflow-y-auto"></div>',1),yn=_('<div class="tabs tabs-border"></div>'),wn=_('<div class="p-2"><h2 class="font-bold text-lg">トーク履歴</h2> <!></div>'),An=_('<div class="chat chat-start"><div class="chat-image avatar avatar-placeholder"><div class="bg-neutral text-neutral-content w-12 rounded-full"><span class="text-2xl"> </span></div></div> <div class="chat-header"></div> <div class="chat-bubble bg-base-100 text-pretty break-all"> </div> <pre class="chat-footer opacity-50"> </pre></div>'),In=_('<input type="radio" name="whisper_days" class="tab"> <div class="tab-content bg-base-200 p-2 max-h-96 overflow-y-auto"></div>',1),En=_('<div class="tabs tabs-border"></div>'),kn=_('<div class="p-2"><h2 class="font-bold text-lg">囁き履歴</h2> <!></div>'),Sn=_('<pre class="overflow-x-auto"> </pre> <div class="divider"></div>',1),Tn=_('<span aria-live="polite"> </span>m',1),Nn=(t,e,n,b)=>$t(n,Mt(b())),Dn=_('<button class="btn"> </button>'),On=(t,e,n)=>$t(n,"Skip"),Ln=_('<button class="btn btn-square" aria-label="Skip"><iconify-icon></iconify-icon></button>',2),Hn=(t,e,n)=>$t(n,"Over"),Rn=_('<!> <button class="btn btn-square" aria-label="Over"><iconify-icon></iconify-icon></button>',3),jn=_("<option></option>"),Mn=(t,e,n)=>{Nt.send(e()),$t(n,"")},$n=_('<div class="m-4"><div class="flex gap-2 items-center"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input flex-1" list="agents"> <datalist id="agents"></datalist> <button class="btn btn-square" aria-label="Send"><iconify-icon></iconify-icon></button></div> <progress class="progress" max="100"></progress></div>',2),Jn=_('<main class="h-screen flex flex-col"><!> <div class="flex flex-1 overflow-hidden w-full flex-col"><div class="flex-auto bg-base-300 h-full overflow-hidden"><div class="flex flex-row h-full"><div class="overflow-y-auto px-2 h-full"><pre class="font-bold text-xl p-2"> </pre> <!> <!> <!> <!></div> <button class="cursor-ew-resize w-2 rounded bg-gray-300 hover:bg-gray-400 active:bg-gray-500 transition-colors border-0 my-2" aria-label="Resize"></button> <div class="overflow-y-auto pl-2 h-full"></div></div></div> <!></div></main>');function er(t,e){me(e,!0);const[n,b]=$e(),j=()=>Q(mt,"$deadline",n),D=()=>Q(wt,"$status",n),k=()=>Q(Ot,"$info",n),dt=()=>Q(Dt,"$role",n),G=()=>Q(gt,"$request",n),W=()=>Q(Et,"$executedAgents",n),M=()=>Q(jt,"$attackedAgents",n),Y=()=>Q(Lt,"$mediumResults",n),o=()=>Q(Ht,"$divineResults",n),h=()=>Q(It,"$talkHistory",n),I=()=>Q(Rt,"$whisperHistory",n),p=()=>Q(At,"$entries",n),x=()=>Q(N,"$remain",n),$=()=>Q(Z,"$message",n),vt=()=>Q(bt,"$setting",n),wt=C(""),mt=C(null),At=C([]),Dt=C(null),gt=C(null),Ot=C(null),Lt=C([]),Ht=C([]),bt=C(null),It=C([]),Rt=C([]),Et=C([]),jt=C([]),N=C(null),Z=C("");let ft=Ct(void 0),rt,ht=Ct(50),tt=!1,it=null;function ye(){{const l=Je.url.searchParams,d=l.get("url"),i=l.get("token");d&&(Tt.update(J=>({...J,connection:{url:d??"",token:i??""}})),Nt.connect())}}function we(l){if(!tt||!it)return;const d=it.getBoundingClientRect(),i=l-d.left,J=d.width;Kt(ht,Mt(Math.min(90,Math.max(10,i/J*100))))}function re(){tt=!0,document.body.style.cursor="ew-resize",document.body.style.userSelect="none";const l=i=>{const J=i instanceof MouseEvent?i.clientX:i.touches[0].clientX;we(J)},d=()=>{tt=!1,document.body.style.cursor="",document.body.style.userSelect="",window.removeEventListener("mousemove",l),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",d),window.removeEventListener("touchend",d)};window.addEventListener("mousemove",l),window.addEventListener("touchmove",l),window.addEventListener("mouseup",d),window.addEventListener("touchend",d)}function ae(){if(j()!==null){const l=Date.now(),d=Math.max(0,j()-l);N.set(d),d>0?rt=requestAnimationFrame(ae):N.set(0)}return()=>{rt&&cancelAnimationFrame(rt)}}Fe(()=>{ye();const l=Nt.subscribe(i=>{wt.set(i.status),i.deadline?(mt.set(i.deadline.getTime()),rt&&cancelAnimationFrame(rt),rt=requestAnimationFrame(ae)):(mt.set(null),N.set(null)),At.set(i.entries),Dt.set(i.role),gt.set(i.request),Ot.set(i.info),Lt.set(i.mediumResults),Ht.set(i.divineResults),bt.set(i.setting),It.set(i.talkHistory),Rt.set(i.whisperHistory),Et.set(i.executedAgents),jt.set(i.attackedAgents)}),d=Tt.subscribe(i=>{Kt(ft,Mt(i))});xe(()=>{l(),d(),rt&&cancelAnimationFrame(rt)}),window.addEventListener("beforeunload",i=>{D()==="connected"&&i.preventDefault()}),window.addEventListener("popstate",i=>{D()==="connected"&&i.preventDefault()})});var Gt=Jn();je(l=>{Re.title="aiwolf-nlp-viewer"});var oe=a(Gt);an(oe,{});var se=s(oe,2),Yt=a(se),Zt=a(Yt),Jt=a(Zt),qt=a(Jt),Ae=a(qt);r(qt);var ie=s(qt,2);{var Ie=l=>{var d=on(),i=a(d);r(d),R(()=>S(i,`${(k()!==null?k().day+"日目":"ゲーム外")??""} ${Ge[G()]??""}`)),u(l,d)};U(ie,l=>{G()!==null&&l(Ie)})}var le=s(ie,2);{var Ee=l=>{var d=bn(),i=ut(d);lt(i,5,()=>Object.entries(k().statusMap??{}),ct,(T,E)=>{let q=()=>c(E)[0],F=()=>c(E)[1];var O=cn(),V=a(O),P=a(V,!0);r(V);var K=s(V,2),B=a(K,!0);r(K);var f=s(K,2);{var w=A=>{var y=sn(),L=a(y,!0);r(y),R(()=>S(L,_e[F()])),u(A,y)},v=A=>{var y=ln(),L=a(y);r(y),R(H=>S(L,`${_e[F()]??""}${H??""}`),[()=>W().includes(q())?" (追放)":M().includes(q())?" (襲撃)":""]),u(A,y)};U(f,A=>{F()===Pt.ALIVE?A(w):A(v,!1)})}r(O),R(()=>{S(P,q()),S(B,pe[(k().roleMap??{})[q()]]??"-")}),u(T,O)}),r(i);var J=s(i,2);{var et=T=>{var E=fn(),q=s(a(E),2);lt(q,1,Y,ct,(F,O)=>{let V=()=>c(O).day,P=()=>c(O).target,K=()=>c(O).result;var B=vn(),f=a(B),w=a(f,!0);r(f);var v=s(f,2),A=a(v);r(v);var y=s(v,2);{var L=m=>{var g=un(),z=a(g,!0);r(g),R(()=>S(z,Vt[K()])),u(m,g)},H=m=>{var g=dn(),z=a(g,!0);r(g),R(()=>S(z,Vt[K()])),u(m,g)};U(y,m=>{K()===ne.HUMAN?m(L):m(H,!1)})}r(B),R(()=>{S(w,P()),S(A,`(Day${V()??""})`)}),u(F,B)}),r(E),u(T,E)};U(J,T=>{Y().length>0&&T(et)})}var at=s(J,2);{var st=T=>{var E=gn(),q=s(a(E),2);lt(q,1,o,ct,(F,O)=>{let V=()=>c(O).day,P=()=>c(O).target,K=()=>c(O).result;var B=mn(),f=a(B),w=a(f,!0);r(f);var v=s(f,2),A=a(v);r(v);var y=s(v,2);{var L=m=>{var g=_n(),z=a(g,!0);r(g),R(()=>S(z,Vt[K()])),u(m,g)},H=m=>{var g=pn(),z=a(g,!0);r(g),R(()=>S(z,Vt[K()])),u(m,g)};U(y,m=>{K()===ne.HUMAN?m(L):m(H,!1)})}r(B),R(()=>{S(w,P()),S(A,`(Day${V()??""})`)}),u(F,B)}),r(E),u(T,E)};U(at,T=>{o().length>0&&T(st)})}u(l,d)};U(le,l=>{k()!==null&&l(Ee)})}var ce=s(le,2);{var ke=l=>{var d=wn(),i=s(a(d),2);{var J=et=>{var at=yn();const st=ue(()=>[...new Set(h().map(T=>T.day))].sort((T,E)=>E-T));lt(at,21,()=>c(st),ct,(T,E)=>{var q=xn(),F=ut(q);St(F);var O=s(F,2);lt(O,5,()=>h().filter(V=>V.day===c(E)),ct,(V,P)=>{let K=()=>c(P).agent,B=()=>c(P).idx,f=()=>c(P).text;var w=hn(),v=a(w),A=a(v),y=a(A),L=a(y,!0);r(y),r(A),r(v);var H=s(v,4),m=a(H,!0);r(H);var g=s(H,2),z=a(g,!0);r(g),r(w),R(ot=>{S(L,ot),S(m,f()),S(z,B())},[()=>{var ot;return Number((ot=K().match(/Agent\[(\d+)\]/))==null?void 0:ot[1])??""}]),u(V,w)}),r(O),R(()=>{de(F,c(E)===c(st)[0]),pt(F,"aria-label",`${c(E)}日目`)}),u(T,q)}),r(at),u(et,at)};U(i,et=>{h().length>0&&et(J)})}r(d),u(l,d)};U(ce,l=>{h().length>0&&l(ke)})}var Se=s(ce,2);{var Te=l=>{var d=kn(),i=s(a(d),2);{var J=et=>{var at=En();const st=ue(()=>[...new Set(I().map(T=>T.day))].sort((T,E)=>E-T));lt(at,21,()=>c(st),ct,(T,E)=>{var q=In(),F=ut(q);St(F);var O=s(F,2);lt(O,5,()=>I().filter(V=>V.day===c(E)),ct,(V,P)=>{let K=()=>c(P).agent,B=()=>c(P).idx,f=()=>c(P).text;var w=An(),v=a(w),A=a(v),y=a(A),L=a(y,!0);r(y),r(A),r(v);var H=s(v,4),m=a(H,!0);r(H);var g=s(H,2),z=a(g,!0);r(g),r(w),R(ot=>{S(L,ot),S(m,f()),S(z,B())},[()=>{var ot;return Number((ot=K().match(/Agent\[(\d+)\]/))==null?void 0:ot[1])??""}]),u(V,w)}),r(O),R(()=>{de(F,c(E)===c(st)[0]),pt(F,"aria-label",`${c(E)}日目`)}),u(T,q)}),r(at),u(et,at)};U(i,et=>{I().length>0&&et(J)})}r(d),u(l,d)};U(Se,l=>{I().length>0&&l(Te)})}r(Jt);var zt=s(Jt,2);zt.__mousedown=re,zt.__touchstart=re;var Xt=s(zt,2);lt(Xt,5,()=>[...p()].reverse(),ct,(l,d)=>{var i=Sn(),J=ut(i),et=a(J,!0);r(J),yt(2),R(at=>S(et,at),[()=>JSON.stringify(c(d),null,2)]),u(l,i)}),r(Xt),r(Zt),he(Zt,l=>it=l,()=>it),r(Yt);var Ne=s(Yt,2);{var De=l=>{var d=$n(),i=a(d),J=a(i),et=a(J);{var at=f=>{var w=Tn(),v=ut(w),A=a(v,!0);r(v),yt(),R((y,L)=>{pt(v,"style",`--value:${y??""};`),pt(v,"aria-label",L),S(A,y)},[()=>Math.floor(x()/6e4),()=>Math.floor(x()/6e4).toString()]),u(f,w)};U(et,f=>{x()>6e4&&f(at)})}var st=s(et,2),T=a(st,!0);r(st),yt(),r(J);var E=s(J,2);{var q=f=>{var w=Ut(),v=ut(w);lt(v,1,()=>{var A;return Object.entries(((A=k())==null?void 0:A.statusMap)??{})},ct,(A,y)=>{let L=()=>c(y)[0],H=()=>c(y)[1];var m=Ut(),g=ut(m);{var z=ot=>{var xt=Dn();xt.__click=[Nn,$,Z,L];var Oe=a(xt,!0);r(xt),R(()=>S(Oe,L())),u(ot,xt)};U(g,ot=>{var xt;H()===Pt.ALIVE&&L()!==((xt=k())==null?void 0:xt.agent)&&ot(z)})}u(A,m)}),u(f,w)},F=f=>{var w=Rn(),v=ut(w);{var A=H=>{var m=Ln();m.__click=[On,$,Z];var g=a(m);X(g,"icon","mdi:arrow-u-down-right-bold"),r(m),u(H,m)};U(v,H=>{var m;(((m=vt())==null?void 0:m.maxSkip)??!1)&&H(A)})}var y=s(v,2);y.__click=[Hn,$,Z];var L=a(y);X(L,"icon","mdi:skip-forward"),r(y),u(f,w)};U(E,f=>{G()===nt.VOTE||G()===nt.DIVINE||G()===nt.GUARD||G()===nt.ATTACK?f(q):f(F,!1)})}var O=s(E,2);St(O);var V=s(O,2);lt(V,5,()=>{var f;return Object.entries(((f=k())==null?void 0:f.statusMap)??{})},ct,(f,w)=>{let v=()=>c(w)[0],A=()=>c(w)[1];var y=Ut(),L=ut(y);{var H=m=>{var g=jn(),z={};R(()=>{z!==(z=v())&&(g.value=(g.__value=v())==null?"":v())}),u(m,g)};U(L,m=>{var g;A()===Pt.ALIVE&&v()!==((g=k())==null?void 0:g.agent)&&m(H)})}u(f,y)}),r(V);var P=s(V,2);P.__click=[Mn,$,Z];var K=a(P);X(K,"icon","mdi:send"),r(P),r(i);var B=s(i,2);r(d),R((f,w)=>{var v;pt(st,"style",`--value:${f??""};`),pt(st,"aria-label",w),S(T,f),Wt(B,x()!==null?x()/(((v=vt())==null?void 0:v.actionTimeout)??6e4)*100:0)},[()=>Math.floor(x()%6e4/1e3),()=>Math.floor(x()%6e4/1e3).toString()]),Me(O,$,f=>$t(Z,f)),u(l,d)};U(Ne,l=>{x()!==null&&l(De)})}r(se),r(Gt),R(()=>{var l;pt(Jt,"style",`width: ${c(ht)??""}%`),S(Ae,`${((l=k())==null?void 0:l.agent)??"未接続"} ${pe[dt()]??""}`),pt(Xt,"style",`width: ${100-c(ht)-.5}%;`)}),u(t,Gt),ge(),b()}be(["mousedown","touchstart","click"]);export{er as component};
