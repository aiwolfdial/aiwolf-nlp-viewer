var Lt=Object.defineProperty;var Ht=(t,e,v)=>e in t?Lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:v}):t[e]=v;var et=(t,e,v)=>Ht(t,typeof e!="symbol"?e+"":e,v);import{t as d,a as l,c as Ae}from"../chunks/B_DQ3xhi.js";import{y as rt,u as Ft,aA as kt,p as Ke,ah as Pt,i as Y,b as n,aB as oe,c as r,r as a,a as Ge,f as z,s as i,aC as we,aH as ke,t as K,h as je,$ as Vt}from"../chunks/CQrlQ-zA.js";import{d as St,s,h as Kt}from"../chunks/CboX5FNv.js";import{i as j}from"../chunks/CZFajD8L.js";import{s as ze,a as Qe}from"../chunks/CxJIPVeE.js";import{p as Gt}from"../chunks/CiWdP0TE.js";import{s as We,a as He,S as Ze,R as Ut}from"../chunks/DQeXEJ-t.js";import{o as Xe,a as Je}from"../chunks/TZ93pTPT.js";import{$ as $e}from"../chunks/DTZtGpg6.js";import{r as Ne,a as ce,s as Ie,b as Ue,L as Jt,c as nt}from"../chunks/C4rOHzAt.js";import{e as be,i as he}from"../chunks/C679Stw7.js";import{b as gt}from"../chunks/DrtuEJ5w.js";import{b as it}from"../chunks/BBb02nhJ.js";import{s as tt}from"../chunks/9Z4grmEM.js";import{b as mt}from"../chunks/VBa4cnPR.js";function xt(t,e,v){rt(()=>{var x=Ft(()=>e(t,v==null?void 0:v())||{});if(x!=null&&x.destroy)return()=>x.destroy()})}class ot{static fromJson(e){return Zt(JSON.parse(e),Ye("AgentSettings"))}static toJson(e){return JSON.stringify(Bt(e,Ye("AgentSettings")),null,2)}}function Ee(t,e,v,x=""){const _=st(t),M=x?` on ${x}`:"",Q=v?` for key "${v}"`:"";throw Error(`Invalid value${Q}${M}. Expected ${_} but got ${JSON.stringify(e)}`)}function st(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${st(t[1])}`:`one of [${t.map(e=>st(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function qt(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(v=>e[v.json]={key:v.js,typ:v.typ}),t.jsonToJS=e}return t.jsonToJS}function Wt(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(v=>e[v.js]={key:v.json,typ:v.typ}),t.jsToJSON=e}return t.jsToJSON}function Fe(t,e,v,x="",_=""){function M(c,T){return typeof c==typeof T?T:Ee(c,T,x,_)}function Q(c,T){const E=c.length;for(let p=0;p<E;p++){const P=c[p];try{return Fe(T,P,v)}catch{}}return Ee(c,T,x,_)}function ie(c,T){return c.indexOf(T)!==-1?T:Ee(c.map(E=>Be(E)),T,x,_)}function re(c,T){return Array.isArray(T)?T.map(E=>Fe(E,c,v)):Ee(Be("array"),T,x,_)}function F(c){if(c===null)return null;const T=new Date(c);return isNaN(T.valueOf())?Ee(Be("Date"),c,x,_):T}function R(c,T,E){if(E===null||typeof E!="object"||Array.isArray(E))return Ee(Be(C||"object"),E,x,_);const p={};return Object.getOwnPropertyNames(c).forEach(P=>{const B=c[P],le=Object.prototype.hasOwnProperty.call(E,P)?E[P]:void 0;p[B.key]=Fe(le,B.typ,v,P,C)}),Object.getOwnPropertyNames(E).forEach(P=>{Object.prototype.hasOwnProperty.call(c,P)||(p[P]=Fe(E[P],T,v,P,C))}),p}if(e==="any")return t;if(e===null)return t===null?t:Ee(e,t,x,_);if(e===!1)return Ee(e,t,x,_);let C;for(;typeof e=="object"&&e.ref!==void 0;)C=e.ref,e=Yt[e.ref];return Array.isArray(e)?ie(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?Q(e.unionMembers,t):e.hasOwnProperty("arrayItems")?re(e.arrayItems,t):e.hasOwnProperty("props")?R(v(e),e.additional,t):Ee(e,t,x,_):e===Date&&typeof t!="number"?F(t):M(e,t)}function Zt(t,e){return Fe(t,e,qt)}function Bt(t,e){return Fe(t,e,Wt)}function Be(t){return{literal:t}}function at(t,e){return{props:t,additional:e}}function Ye(t){return{ref:t}}const Yt={AgentSettings:at([{json:"connection",js:"connection",typ:Ye("Connection")},{json:"team",js:"team",typ:""},{json:"display",js:"display",typ:Ye("Display")}],!1),Connection:at([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1),Display:at([{json:"largeScale",js:"largeScale",typ:!0}],!1)},pt={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}};function zt(){const t=localStorage.getItem("agent-settings");if(t)try{return ot.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",ot.toJson(pt)),pt}const Se=kt(zt());Se.subscribe(t=>{localStorage.setItem("agent-settings",ot.toJson(t))});var pe=(t=>(t.NAME="NAME",t.TALK="TALK",t.WHISPER="WHISPER",t.VOTE="VOTE",t.DIVINE="DIVINE",t.GUARD="GUARD",t.ATTACK="ATTACK",t.INITIALIZE="INITIALIZE",t.DAILY_INITIALIZE="DAILY_INITIALIZE",t.DAILY_FINISH="DAILY_FINISH",t.FINISH="FINISH",t))(pe||{});const Pe={NAME:"名前",TALK:"トーク",WHISPER:"囁き",VOTE:"投票",DIVINE:"占い",GUARD:"護衛",ATTACK:"襲撃",INITIALIZE:"ゲーム開始",DAILY_INITIALIZE:"昼開始",DAILY_FINISH:"昼終了",FINISH:"ゲーム終了"},lt={ミナト:"/images/male/01.png",タクミ:"/images/male/02.png",ケンジ:"/images/male/03.png",リュウジ:"/images/male/04.png",ダイスケ:"/images/male/05.png",シオン:"/images/male/06.png",ベンジャミン:"/images/male/07.png",トシオ:"/images/male/08.png",ジョナサン:"/images/male/09.png",シュンイチ:"/images/male/10.png",ジョージ:"/images/male/11.png",セルヴァス:"/images/male/12.png",サクラ:"/images/female/01.png",リン:"/images/female/02.png",ユミ:"/images/female/03.png",メイ:"/images/female/04.png",ミサキ:"/images/female/05.png",ミオ:"/images/female/06.png",ミヅキ:"/images/female/07.png",ミナコ:"/images/female/08.png",アスカ:"/images/female/09.png",ミドリ:"/images/female/10.png",ヴィクトリア:"/images/female/11.png",シズエ:"/images/female/12.png"};function Qt(){const{subscribe:t,update:e}=kt({status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let v=null,x=null,_=null,M=null;Se.subscribe(F=>{x=F});function Q(){v&&(v.close(),v=null,e(F=>({...F,status:"disconnected"}))),M&&(M.clear(),M=null)}function ie(){if(!x)return;v&&e(R=>({...R,status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]})),e(R=>({...R,status:"connecting"}));const F=new URL(x.connection.url);x.connection.token&&F.searchParams.set("token",x.connection.token),v=new WebSocket(F),v.onopen=()=>{e(R=>({...R,status:"connected"}))},v.onclose=()=>{Q()},v.onerror=()=>{Q()},v.onmessage=R=>{try{const C=Date.now(),c=JSON.parse(R.data);switch(e(T=>{const E=T.entries.slice();E.push(c);const p={...T,entries:E,request:c.request};if(c.info){if(p.info=c.info,c.info.medium_result){const P=c.info.medium_result;p.mediumResults.findIndex(B=>B.day===P.day&&B.agent===P.agent)<0&&p.mediumResults.push(c.info.medium_result)}if(c.info.divine_result){const P=c.info.divine_result;p.divineResults.findIndex(B=>B.day===P.day&&B.agent===P.agent)<0&&p.divineResults.push(c.info.divine_result)}c.info.executed_agent&&p.executedAgents.push(c.info.executed_agent),c.info.attacked_agent&&p.attackedAgents.push(c.info.attacked_agent)}return c.setting&&(p.setting=c.setting,_=c.setting.timeout.action),c.talk_history&&p.talkHistory.push(...c.talk_history),c.whisper_history&&p.whisperHistory.push(...c.whisper_history),c.request===pe.INITIALIZE&&p.info&&(p.agent=p.info.agent,p.role=p.info.role_map[p.info.agent],p.profile=p.info.profile||null),p}),c.request){case pe.NAME:re((x==null?void 0:x.team)||"viewer"+Math.floor(Math.random()*1e3));break;case pe.TALK:case pe.WHISPER:case pe.VOTE:case pe.DIVINE:case pe.GUARD:case pe.ATTACK:M&&M.clear(),M=new Xt(()=>{re("TIMEOUT")},new Date(C+(_??6e4))),e(T=>({...T,deadline:(M==null?void 0:M.deadline())??null}));break;case pe.FINISH:Q();break}}catch(C){console.error("Failed to parse message:",C)}}}function re(F){if(M&&(M.clear(),M=null,e(R=>({...R,deadline:null}))),v&&v.readyState===WebSocket.OPEN)try{v.send(F),e(R=>{const C=R.entries.slice();return C.push(F),{...R,entries:C}})}catch(R){console.error("Failed to send message:",R)}}return{subscribe:t,connect:ie,disconnect:Q,send:re}}const Ve=Qt();class Xt{constructor(e,v){et(this,"timeout");et(this,"_deadline");this.timeout=setTimeout(e,v.getTime()-new Date().getTime()),this._deadline=v}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var bt;(function(t){t[t.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",t[t.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",t[t.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",t[t.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",t[t.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",t[t.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",t[t.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",t[t.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",t[t.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",t[t.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",t[t.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",t[t.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",t[t.TAGS_START=917504]="TAGS_START",t[t.TAGS_END=917631]="TAGS_END",t[t.ZWJ=8205]="ZWJ"})(bt||(bt={}));const $t=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var ht;function yt(t){if(typeof t!="string")throw new TypeError("string cannot be undefined or null");const e=[];let v=0,x=0;for(;v<t.length;)x+=ea(v+x,t),sa(t[v+x])&&x++,na(t[v+x])&&x++,ia(t[v+x])&&x++,la(t[v+x])?x++:(e.push(t.substring(v,v+x)),v+=x,x=0);return e}function ea(t,e){const v=e[t];if(!ta(v)||t===e.length-1)return 1;const x=v+e[t+1];let _=e.substring(t+2,t+5);return At(x)&&At(_)?4:aa(x)&&oa(_)?e.slice(t).indexOf(String.fromCodePoint(917631))+2:ra(_)?4:2}function ta(t){return t&&Ce(t[0].charCodeAt(0),55296,56319)}function At(t){return Ce(ct(t),127462,127487)}function aa(t){return Ce(ct(t),127988,127988)}function ra(t){return Ce(ct(t),127995,127999)}function na(t){return typeof t=="string"&&Ce(t.charCodeAt(0),65024,65039)}function ia(t){return typeof t=="string"&&Ce(t.charCodeAt(0),8400,8447)}function oa(t){const e=t.codePointAt(0);return typeof t=="string"&&typeof e=="number"&&Ce(e,917504,917631)}function sa(t){return typeof t=="string"&&$t.includes(t.charCodeAt(0))}function la(t){return typeof t=="string"&&t.charCodeAt(0)===8205}function ct(t){return(t.charCodeAt(0)-55296<<10)+(t.charCodeAt(1)-56320)+65536}function Ce(t,e,v){return t>=e&&t<=v}(function(t){t[t.unit_1=1]="unit_1",t[t.unit_2=2]="unit_2",t[t.unit_4=4]="unit_4"})(ht||(ht={}));function It(t,e,v){t.key==="Enter"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.onSendMessage(n(v)))}var ca=d('<span aria-live="polite"> </span>m',1),va=(t,e,v)=>e(v()),ua=d('<button class="btn btn-xl"> </button>'),_a=(t,e)=>e("Skip"),fa=d('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),da=(t,e)=>e("Over"),ga=d('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),ma=d("<option></option>"),xa=d("<option></option>"),pa=d("<!> <option></option>",1),ba=d('<pre class="text-2xl"> </pre>'),ha=d('<pre class="text-2xl bg-error text-error-content"> </pre>'),ya=(t,e,v)=>e.onSendMessage(n(v)),Aa=d('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> </button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),Ia=d('<span aria-live="polite"> </span>m',1),Ta=(t,e,v)=>e(v()),wa=d('<button class="btn"> </button>'),ka=d('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),Sa=(t,e)=>e("Skip"),Ra=d('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),Ea=(t,e)=>e("Over"),Oa=d('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),Na=d("<option></option>"),Da=d("<option></option>"),ja=d("<!> <option></option>",1),Ca=d('<pre class="text-md"> </pre>'),Ma=d('<pre class="text-md bg-error text-error-content"> </pre>'),La=(t,e,v)=>e.onSendMessage(n(v)),Ha=d('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> </button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),Fa=d('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function Pa(t,e){Ke(e,!0);const[v,x]=ze(),_=()=>Qe($e,"$_",v);let M=oe(""),Q=oe(0),ie=oe(void 0),re=oe(null);const F=ke(()=>{var h;return e.remain!==null?e.remain/(((h=e.setting)==null?void 0:h.timeout.action)??6e4)*100:0}),R=ke(()=>e.remain!==null?Math.floor(e.remain/6e4):0),C=ke(()=>e.remain!==null?Math.floor(e.remain%6e4/1e3):0),c=ke(()=>[pe.VOTE,pe.DIVINE,pe.GUARD,pe.ATTACK].includes(e.request));function T(h){var G,N;if(!e.request||!e.setting)return 0;const S=e.request===pe.TALK?e.setting.talk.max_length:e.request===pe.WHISPER?e.setting.whisper.max_length:null;if(!S)return 0;let w=S.base_length??0;if(w+=((G=e.info)==null?void 0:G.remain_length)??0,S.mention_length){for(const ve in((N=e.info)==null?void 0:N.status_map)??{})if(h.indexOf("@"+ve)!==-1){w+=S.mention_length,w+=yt("@"+ve).length;break}}return S.per_talk&&(w=Math.min(w,S.per_talk)),w-=yt(h).length,w}Pt(()=>{Y(Q,T(n(M)),!0)}),Xe(()=>{const h=Se.subscribe(S=>{Y(ie,S,!0)});return()=>{h()}});function E(h){var S;Y(M,h,!0),(S=n(re))==null||S.focus()}function p(h){h.focus()}var P=Fa(),B=r(P);{var le=h=>{var S=Aa(),w=z(S),G=r(w),N=r(G);{var ve=o=>{var f=ca(),I=z(f),m=r(I,!0);a(I),we(),K(J=>{We(I,`--value:${n(R)??""};`),Ie(I,"aria-label",J),s(m,n(R))},[()=>n(R).toString()]),l(o,f)};j(N,o=>{e.remain&&e.remain>6e4&&o(ve)})}var fe=i(N,2),me=r(fe,!0);a(fe),we(),a(G);var $=i(G,2),ee=r($,!0);a($),a(w);var ne=i(w,2),se=r(ne);{var ue=o=>{var f=Ae(),I=z(f);be(I,17,()=>{var m;return Object.entries(((m=e.info)==null?void 0:m.status_map)??{})},he,(m,J)=>{let q=()=>n(J)[0],W=()=>n(J)[1];var ae=Ae(),de=z(ae);{var ye=ge=>{var _e=ua();_e.__click=[va,E,q];var Oe=r(_e,!0);a(_e),K(()=>s(Oe,q())),l(ge,_e)};j(de,ge=>{var _e;W()===He.ALIVE&&q()!==((_e=e.info)==null?void 0:_e.agent)&&ge(ye)})}l(m,ae)}),l(o,f)},b=o=>{var f=ga(),I=z(f);{var m=W=>{var ae=fa();ae.__click=[_a,E];var de=r(ae);ce(de,"icon","mdi:arrow-u-down-right-bold"),we(),a(ae),l(W,ae)};j(I,W=>{var ae;(((ae=e.info)==null?void 0:ae.remain_skip)??0)>0&&W(m)})}var J=i(I,2);J.__click=[da,E];var q=r(J);ce(q,"icon","mdi:skip-forward"),we(),a(J),l(o,f)};j(se,o=>{n(c)?o(ue):o(b,!1)})}var y=i(se,2);Ne(y),y.__keydown=[It,e,M],rt(()=>gt(y,()=>n(M),o=>Y(M,o))),xt(y,o=>p==null?void 0:p(o)),it(y,o=>Y(re,o),()=>n(re));var k=i(y,2),D=r(k);{var Z=o=>{var f=Ae(),I=z(f);be(I,17,()=>{var m;return Object.entries(((m=e.info)==null?void 0:m.status_map)??{})},he,(m,J)=>{let q=()=>n(J)[0],W=()=>n(J)[1];var ae=Ae(),de=z(ae);{var ye=ge=>{var _e=ma(),Oe={};K(()=>{Oe!==(Oe=q())&&(_e.value=(_e.__value=q())??"")}),l(ge,_e)};j(de,ge=>{var _e;W()===He.ALIVE&&q()!==((_e=e.info)==null?void 0:_e.agent)&&ge(ye)})}l(m,ae)}),l(o,f)},V=o=>{var f=pa(),I=z(f);{var m=q=>{var W=xa();W.value=W.__value="Skip",l(q,W)};j(I,q=>{var W;(((W=e.info)==null?void 0:W.remain_skip)??0)>0&&q(m)})}var J=i(I,2);J.value=J.__value="Over",l(o,f)};j(D,o=>{n(c)?o(Z):o(V,!1)})}a(k);var te=i(k,2);{var L=o=>{var f=ba(),I=r(f,!0);a(f),K(m=>s(I,m),[()=>_()("agent.remainingChars",{values:{count:n(Q)}})]),l(o,f)},H=o=>{var f=ha(),I=r(f,!0);a(f),K(m=>s(I,m),[()=>_()("agent.exceededChars",{values:{count:n(Q)*-1}})]),l(o,f)};j(te,o=>{n(Q)>=0?o(L):o(H,!1)})}var O=i(te,2);O.__click=[ya,e,M];var X=r(O);ce(X,"icon","mdi:send");var u=i(X);a(O),a(ne);var A=i(ne,2),g=r(A);a(A),K((o,f,I)=>{We(fe,`--value:${n(C)??""};`),Ie(fe,"aria-label",o),s(me,n(C)),s(ee,f),s(u,` ${I??""}`),Ue(g,n(F))},[()=>n(C).toString(),()=>n(c)?`${Pe[e.request]}${_()("agent.selectTarget")}`:`${Pe[e.request]}${_()("agent.enterContent")}`,()=>_()("agent.send")]),l(h,S)},U=h=>{var S=Ha(),w=z(S),G=r(w),N=r(G);{var ve=u=>{var A=Ia(),g=z(A),o=r(g,!0);a(g),we(),K((f,I,m)=>{We(g,`--value:${f??""};`),Ie(g,"aria-label",I),s(o,m)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),l(u,A)};j(N,u=>{e.remain&&e.remain>6e4&&u(ve)})}var fe=i(N,2),me=r(fe,!0);a(fe),we(),a(G);var $=i(G,2);{var ee=u=>{var A=ka(),g=z(A),o=r(g);a(g);var f=i(g,2);be(f,17,()=>{var I;return Object.entries(((I=e.info)==null?void 0:I.status_map)??{})},he,(I,m)=>{let J=()=>n(m)[0],q=()=>n(m)[1];var W=Ae(),ae=z(W);{var de=ye=>{var ge=wa();ge.__click=[Ta,E,J];var _e=r(ge,!0);a(ge),K(()=>s(_e,J())),l(ye,ge)};j(ae,ye=>{var ge;q()===He.ALIVE&&J()!==((ge=e.info)==null?void 0:ge.agent)&&ye(de)})}l(I,W)}),K(I=>s(o,`${Pe[e.request]??""}${I??""}`),[()=>_()("agent.selectTarget")]),l(u,A)},ne=u=>{var A=Oa(),g=z(A),o=r(g);a(g);var f=i(g,2);{var I=q=>{var W=Ra();W.__click=[Sa,E];var ae=r(W);ce(ae,"icon","mdi:arrow-u-down-right-bold"),we(),a(W),l(q,W)};j(f,q=>{var W;(((W=e.info)==null?void 0:W.remain_skip)??0)>0&&q(I)})}var m=i(f,2);m.__click=[Ea,E];var J=r(m);ce(J,"icon","mdi:skip-forward"),we(),a(m),K(q=>s(o,`${Pe[e.request]??""}${q??""}`),[()=>_()("agent.enterContent")]),l(u,A)};j($,u=>{n(c)?u(ee):u(ne,!1)})}var se=i($,2);Ne(se),se.__keydown=[It,e,M],rt(()=>gt(se,()=>n(M),u=>Y(M,u))),xt(se,u=>p==null?void 0:p(u)),it(se,u=>Y(re,u),()=>n(re));var ue=i(se,2),b=r(ue);{var y=u=>{var A=Ae(),g=z(A);be(g,17,()=>{var o;return Object.entries(((o=e.info)==null?void 0:o.status_map)??{})},he,(o,f)=>{let I=()=>n(f)[0],m=()=>n(f)[1];var J=Ae(),q=z(J);{var W=ae=>{var de=Na(),ye={};K(()=>{ye!==(ye=I())&&(de.value=(de.__value=I())??"")}),l(ae,de)};j(q,ae=>{var de;m()===He.ALIVE&&I()!==((de=e.info)==null?void 0:de.agent)&&ae(W)})}l(o,J)}),l(u,A)},k=u=>{var A=ja(),g=z(A);{var o=I=>{var m=Da();m.value=m.__value="Skip",l(I,m)};j(g,I=>{var m;(((m=e.info)==null?void 0:m.remain_skip)??0)>0&&I(o)})}var f=i(g,2);f.value=f.__value="Over",l(u,A)};j(b,u=>{n(c)?u(y):u(k,!1)})}a(ue);var D=i(ue,2);{var Z=u=>{var A=Ca(),g=r(A,!0);a(A),K(o=>s(g,o),[()=>_()("agent.remainingChars",{values:{count:n(Q)}})]),l(u,A)},V=u=>{var A=Ma(),g=r(A,!0);a(A),K(o=>s(g,o),[()=>_()("agent.exceededChars",{values:{count:n(Q)*-1}})]),l(u,A)};j(D,u=>{n(Q)>=0?u(Z):u(V,!1)})}var te=i(D,2);te.__click=[La,e,M];var L=r(te);ce(L,"icon","mdi:send");var H=i(L);a(te),a(w);var O=i(w,2),X=r(O);a(O),K((u,A,g,o)=>{We(fe,`--value:${u??""};`),Ie(fe,"aria-label",A),s(me,g),s(H,` ${o??""}`),Ue(X,n(F))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>_()("agent.send")]),l(h,S)};j(B,h=>{var S;(S=n(ie))!=null&&S.display.largeScale?h(le):h(U,!1)})}a(P),l(t,P),Ge(),x()}St(["click","keydown"]);var Va=d('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),Ka=d('<pre class="text-md text-pretty break-all my-2"> </pre>'),Ga=d('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ua=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ja=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),qa=d('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Wa=d('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),Za=d('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ba=d('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ya=d('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),za=d('<div class="grow overflow-y-auto pr-4"><pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!> <!></div>'),Qa=d('<pre class="text-lg text-center"> </pre>'),Xa=d('<h2 class="text-lg font-bold text-center">プロフィール</h2> <pre class="text-md text-pretty break-all"> </pre>',1),$a=d('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),er=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),tr=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),ar=d('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),rr=d('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),nr=d('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),ir=d('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),or=d('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),sr=d('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">名前</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <!> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),lr=d('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function cr(t,e){Ke(e,!0);const[v,x]=ze(),_=()=>Qe($e,"$_",v);let M=oe(void 0);Xe(()=>{const C=Se.subscribe(c=>{Y(M,c,!0)});Je(C)});var Q=lr(),ie=r(Q),re=r(ie);{var F=C=>{var c=za(),T=r(c),E=r(T,!0);a(T);var p=i(T,2),P=r(p,!0);a(p);var B=i(p,2),le=r(B,!0);a(B);var U=i(B,2);{var h=$=>{var ee=Va(),ne=r(ee,!0);a(ee),K(()=>s(ne,Pe[e.request])),l($,ee)};j(U,$=>{e.request&&$(h)})}var S=i(U,2);{var w=$=>{var ee=Ka(),ne=r(ee,!0);a(ee),K(()=>s(ne,e.profile)),l($,ee)};j(S,$=>{e.profile&&$(w)})}var G=i(S,2);be(G,17,()=>Object.entries(e.info.status_map??{}),he,($,ee)=>{let ne=()=>n(ee)[0],se=()=>n(ee)[1];var ue=Ae(),b=z(ue);{var y=D=>{var Z=Ga(),V=r(Z),te=r(V,!0);a(V);var L=i(V,2),H=r(L,!0);a(L);var O=i(L,2),X=r(O,!0);a(O),a(Z),K((u,A)=>{s(te,ne()),s(H,u),s(X,A)},[()=>(e.info.role_map??{})[ne()]?_()(`game.role.${(e.info.role_map??{})[ne()]}`):"",()=>_()(`game.status.${se()}`)]),l(D,Z)},k=D=>{var Z=Ua(),V=r(Z),te=r(V,!0);a(V);var L=i(V,2),H=r(L,!0);a(L);var O=i(L,2),X=r(O);a(O),a(Z),K((u,A,g)=>{s(te,ne()),s(H,u),s(X,`${A??""}${g??""}`)},[()=>(e.info.role_map??{})[ne()]?_()(`game.role.${(e.info.role_map??{})[ne()]}`):"",()=>_()(`game.status.${se()}`),()=>e.executedAgents.includes(ne())?" (追放)":e.attackedAgents.includes(ne())?" (襲撃)":""]),l(D,Z)};j(b,D=>{se()===He.ALIVE?D(y):D(k,!1)})}l($,ue)});var N=i(G,2);{var ve=$=>{var ee=Wa(),ne=i(z(ee),2);be(ne,17,()=>e.mediumResults,he,(se,ue)=>{let b=()=>n(ue).day,y=()=>n(ue).target,k=()=>n(ue).result;var D=Ae(),Z=z(D);{var V=L=>{var H=Ja(),O=r(H),X=r(O,!0);a(O);var u=i(O,2),A=r(u);a(u);var g=i(u,2),o=r(g,!0);a(g),a(H),K(f=>{s(X,y()),s(A,`(${b()??""}日目)`),s(o,f)},[()=>_()(`game.species.${k()}`)]),l(L,H)},te=L=>{var H=qa(),O=r(H),X=r(O,!0);a(O);var u=i(O,2),A=r(u);a(u);var g=i(u,2),o=r(g,!0);a(g),a(H),K(f=>{s(X,y()),s(A,`(${b()??""}日目)`),s(o,f)},[()=>_()(`game.species.${k()}`)]),l(L,H)};j(Z,L=>{k()!==Ze.HUMAN?L(V):L(te,!1)})}l(se,D)}),l($,ee)};j(N,$=>{e.mediumResults.length>0&&$(ve)})}var fe=i(N,2);{var me=$=>{var ee=Ya(),ne=i(z(ee),2);be(ne,17,()=>e.divineResults,he,(se,ue)=>{let b=()=>n(ue).day,y=()=>n(ue).target,k=()=>n(ue).result;var D=Ae(),Z=z(D);{var V=L=>{var H=Za(),O=r(H),X=r(O,!0);a(O);var u=i(O,2),A=r(u);a(u);var g=i(u,2),o=r(g,!0);a(g),a(H),K(f=>{s(X,y()),s(A,`(${b()??""}日目)`),s(o,f)},[()=>_()(`game.species.${k()}`)]),l(L,H)},te=L=>{var H=Ba(),O=r(H),X=r(O,!0);a(O);var u=i(O,2),A=r(u);a(u);var g=i(u,2),o=r(g,!0);a(g),a(H),K(f=>{s(X,y()),s(A,`(${b()??""}日目)`),s(o,f)},[()=>_()(`game.species.${k()}`)]),l(L,H)};j(Z,L=>{k()!==Ze.HUMAN?L(V):L(te,!1)})}l(se,D)}),l($,ee)};j(fe,$=>{e.divineResults.length>0&&$(me)})}a(c),K($=>{s(E,e.agent?e.agent:"ゲーム外"),s(P,$),s(le,e.info?e.info.day+"日目":"ゲーム外")},[()=>e.role?_()(`game.role.${e.role}`):"ゲーム外"]),l(C,c)},R=C=>{var c=sr(),T=i(z(c),2),E=r(T),p=r(E),P=i(r(p),2),B=r(P,!0);a(P),a(p);var le=i(p,2),U=i(r(le),2),h=r(U,!0);a(U),a(le);var S=i(le,2),w=i(r(S),2),G=r(w,!0);a(w),a(S);var N=i(S,2),ve=i(r(N),2);{var fe=y=>{var k=Qa(),D=r(k,!0);a(k),K(()=>s(D,Pe[e.request])),l(y,k)};j(ve,y=>{e.request&&y(fe)})}a(N),a(E);var me=i(E,2);{var $=y=>{var k=Xa(),D=i(z(k),2),Z=r(D,!0);a(D),K(()=>s(Z,e.profile)),l(y,k)};j(me,y=>{e.profile&&y($)})}var ee=i(me,4);be(ee,17,()=>Object.entries(e.info.status_map??{}),he,(y,k)=>{let D=()=>n(k)[0],Z=()=>n(k)[1];var V=Ae(),te=z(V);{var L=O=>{var X=$a(),u=r(X),A=r(u,!0);a(u);var g=i(u,2),o=r(g,!0);a(g);var f=i(g,2),I=r(f,!0);a(f),a(X),K((m,J)=>{s(A,D()),s(o,m),s(I,J)},[()=>(e.info.role_map??{})[D()]?_()(`game.role.${(e.info.role_map??{})[D()]}`):"",()=>_()(`game.status.${Z()}`)]),l(O,X)},H=O=>{var X=er(),u=r(X),A=r(u,!0);a(u);var g=i(u,2),o=r(g,!0);a(g);var f=i(g,2),I=r(f);a(f),a(X),K((m,J,q)=>{s(A,D()),s(o,m),s(I,`${J??""}${q??""}`)},[()=>(e.info.role_map??{})[D()]?_()(`game.role.${(e.info.role_map??{})[D()]}`):"",()=>_()(`game.status.${Z()}`),()=>e.executedAgents.includes(D())?" (追放)":e.attackedAgents.includes(D())?" (襲撃)":""]),l(O,X)};j(te,O=>{Z()===He.ALIVE?O(L):O(H,!1)})}l(y,V)});var ne=i(ee,2);{var se=y=>{var k=rr(),D=i(z(k),2);be(D,17,()=>e.mediumResults,he,(Z,V)=>{let te=()=>n(V).day,L=()=>n(V).target,H=()=>n(V).result;var O=Ae(),X=z(O);{var u=g=>{var o=tr(),f=r(o),I=r(f,!0);a(f);var m=i(f,2),J=r(m);a(m);var q=i(m,2),W=r(q,!0);a(q),a(o),K(ae=>{s(I,L()),s(J,`(${te()??""}日目)`),s(W,ae)},[()=>_()(`game.species.${H()}`)]),l(g,o)},A=g=>{var o=ar(),f=r(o),I=r(f,!0);a(f);var m=i(f,2),J=r(m);a(m);var q=i(m,2),W=r(q,!0);a(q),a(o),K(ae=>{s(I,L()),s(J,`(${te()??""}日目)`),s(W,ae)},[()=>_()(`game.species.${H()}`)]),l(g,o)};j(X,g=>{H()!==Ze.HUMAN?g(u):g(A,!1)})}l(Z,O)}),l(y,k)};j(ne,y=>{e.mediumResults.length>0&&y(se)})}var ue=i(ne,2);{var b=y=>{var k=or(),D=i(z(k),2);be(D,17,()=>e.divineResults,he,(Z,V)=>{let te=()=>n(V).day,L=()=>n(V).target,H=()=>n(V).result;var O=Ae(),X=z(O);{var u=g=>{var o=nr(),f=r(o),I=r(f,!0);a(f);var m=i(f,2),J=r(m);a(m);var q=i(m,2),W=r(q,!0);a(q),a(o),K(ae=>{s(I,L()),s(J,`(${te()??""}日目)`),s(W,ae)},[()=>_()(`game.species.${H()}`)]),l(g,o)},A=g=>{var o=ir(),f=r(o),I=r(f,!0);a(f);var m=i(f,2),J=r(m);a(m);var q=i(m,2),W=r(q,!0);a(q),a(o),K(ae=>{s(I,L()),s(J,`(${te()??""}日目)`),s(W,ae)},[()=>_()(`game.species.${H()}`)]),l(g,o)};j(X,g=>{H()!==Ze.HUMAN?g(u):g(A,!1)})}l(Z,O)}),l(y,k)};j(ue,y=>{e.divineResults.length>0&&y(b)})}a(T),K(y=>{s(B,e.agent?e.agent:"ゲーム外"),s(h,y),s(G,e.info?e.info.day+"日目":"ゲーム外")},[()=>e.role?_()(`game.role.${e.role}`):"ゲーム外"]),l(C,c)};j(re,C=>{var c;(c=n(M))!=null&&c.display.largeScale?C(F):C(R,!1)})}a(ie),a(Q),l(t,Q),Ge(),x()}function vr(){Ve.connect()}function ur(){Ve.disconnect()}var _r=d('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),fr=d('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),dr=d('<div class="status status-error"></div>'),gr=(t,e)=>e("connection.url",t.currentTarget.value),mr=(t,e)=>e("connection.token",t.currentTarget.value),xr=(t,e)=>e("team",t.currentTarget.value),pr=(t,e)=>e("display.largeScale",t.currentTarget.checked),br=d('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./"> </a> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow"> <span class="badge badge-neutral badge-xs"> </span></label> <button class="btn btn-info"> </button> <button class="btn btn-error"> </button> <button class="btn"> </button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold"> </h3> <h4 class="text-base font-bold mt-2"> </h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <h3 class="text-lg font-bold mt-4"> </h3> <h4 class="text-base font-bold mt-2"> </h4> <label class="label cursor-pointer my-2"><span class="label-text"> </span> <input type="checkbox" class="checkbox"></label> <h4 class="text-base font-bold mt-2"> </h4> <div class="my-2"><!></div></div></div> <form method="dialog" class="modal-backdrop"><button> </button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function hr(t,e){Ke(e,!0);const[v,x]=ze(),_=()=>Qe($e,"$_",v);let M=oe(void 0),Q=oe(void 0);const ie=Se.subscribe(xe=>{Y(M,xe,!0)}),re=Ve.subscribe(xe=>{Y(Q,xe.status,!0)});Je(()=>{ie(),re()});function F(xe,De){Se.update(Me=>{const Le=xe.split("."),Te=Le.pop();let Re=Me;for(const qe of Le)qe&&(Re=Re[qe]);return Re[Te]=De,{...Me}})}let R;var C=br(),c=r(C),T=r(c,!0);a(c);var E=i(c,2),p=r(E),P=r(p);{var B=xe=>{var De=_r();we(2),l(xe,De)},le=(xe,De)=>{{var Me=Te=>{var Re=fr();we(2),l(Te,Re)},Le=Te=>{var Re=dr();l(Te,Re)};j(xe,Te=>{n(Q)==="connecting"?Te(Me):Te(Le,!1)},De)}};j(P,xe=>{n(Q)==="connected"?xe(B):xe(le,!1)})}a(p),a(E);var U=i(E,2),h=r(U);tt(h,1,"h-[1em] opacity-50"),ce(h,"inline",!0),ce(h,"icon","mdi:link");var S=i(h,2);Ne(S),S.__input=[gr,F],a(U);var w=i(U,2),G=r(w);tt(G,1,"h-[1em] opacity-50"),ce(G,"inline",!0),ce(G,"icon","mdi:key");var N=i(G,2);Ne(N),N.__input=[mr,F];var ve=i(N,2),fe=r(ve,!0);a(ve),a(w);var me=i(w,2);me.__click=[vr];var $=r(me,!0);a(me);var ee=i(me,2);ee.__click=[ur];var ne=r(ee,!0);a(ee);var se=i(ee,2);se.__click=()=>R.showModal();var ue=r(se,!0);a(se);var b=i(se,2),y=r(b),k=r(y),D=r(k),Z=r(D,!0);a(D);var V=i(D,2),te=r(V,!0);a(V);var L=i(V,2),H=r(L);tt(H,1,"h-[1em] opacity-50"),ce(H,"inline",!0),ce(H,"icon","mdi:rename");var O=i(H,2);Ne(O),O.__input=[xr,F],a(L);var X=i(L,2),u=r(X,!0);a(X);var A=i(X,2),g=r(A,!0);a(A);var o=i(A,2),f=r(o),I=r(f,!0);a(f);var m=i(f,2);Ne(m),m.__change=[pr,F],a(o);var J=i(o,2),q=r(J,!0);a(J);var W=i(J,2),ae=r(W);Jt(ae,{}),a(W),a(k),a(y);var de=i(y,2),ye=r(de),ge=r(ye,!0);a(ye),a(de),a(b),it(b,xe=>R=xe,()=>R);var _e=i(b,2),Oe=r(_e);ce(Oe,"inline",!0),ce(Oe,"icon","mdi:white-balance-sunny");var Rt=i(Oe,2),vt=i(Rt,2);ce(vt,"inline",!0),ce(vt,"icon","mdi:moon-and-stars"),a(_e),a(C),K((xe,De,Me,Le,Te,Re,qe,Et,Ot,Nt,Dt,jt,Ct,Mt)=>{var ut,_t,ft,dt;s(T,xe),Ie(S,"placeholder",De),Ue(S,(ut=n(M))==null?void 0:ut.connection.url),Ie(N,"placeholder",Me),Ue(N,(_t=n(M))==null?void 0:_t.connection.token),s(fe,Le),me.disabled=n(Q)!=="disconnected",s($,Te),ee.disabled=n(Q)==="disconnected",s(ne,Re),s(ue,qe),s(Z,Et),s(te,Ot),Ue(O,(ft=n(M))==null?void 0:ft.team),s(u,Nt),s(g,Dt),s(I,jt),nt(m,(dt=n(M))==null?void 0:dt.display.largeScale),s(q,Ct),s(ge,Mt)},[()=>_()("appName"),()=>_()("realtime.websocketUrl"),()=>_()("realtime.authKey"),()=>_()("realtime.optional"),()=>_()("realtime.connect"),()=>_()("realtime.disconnect"),()=>_()("realtime.settings"),()=>_()("agent.agentSettings"),()=>_()("agent.teamName"),()=>_()("realtime.displaySettings"),()=>_()("realtime.largeScreen"),()=>_()("realtime.enable"),()=>_()("common.language"),()=>_()("common.close")]),l(t,C),Ge(),x()}St(["input","click","change"]);var yr=d("<iconify-icon></iconify-icon>",2),Ar=d("<iconify-icon></iconify-icon>",2),Ir=d('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),Tr=d('<div class="chat-image avatar"><div class="w-20 rounded-full"><img></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),wr=d("<iconify-icon></iconify-icon>",2),kr=d("<iconify-icon></iconify-icon>",2),Sr=d('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),Rr=d('<div class="chat-image avatar"><div class="w-10 rounded-full"><img></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),Er=d('<div class="chat chat-start"><!></div>');function Tt(t,e){Ke(e,!0);let v=oe(void 0);Xe(()=>{const ie=Se.subscribe(re=>{Y(v,re,!0)});Je(ie)});var x=Er(),_=r(x);{var M=ie=>{var re=Tr(),F=z(re),R=r(F),C=r(R);a(R),a(F);var c=i(F,2),T=r(c,!0);a(c);var E=i(c,2);{var p=U=>{var h=yr();ce(h,"inline",!0),ce(h,"icon","mdi:skip-forward"),l(U,h)},P=(U,h)=>{{var S=G=>{var N=Ar();ce(N,"inline",!0),ce(N,"icon","mdi:arrow-u-down-right-bold"),l(G,N)},w=G=>{var N=Ir(),ve=r(N,!0);a(N),K(()=>s(ve,e.talk.text)),l(G,N)};j(U,G=>{e.talk.skip?G(S):G(w,!1)},h)}};j(E,U=>{e.talk.over?U(p):U(P,!1)})}var B=i(E,2),le=r(B);a(B),K(()=>{Ie(C,"src",e.isDefaultProfile?`${mt}${lt[e.talk.agent]}`:""),Ie(C,"alt",e.talk.agent),s(T,e.talk.agent),s(le,`Idx: ${e.talk.idx??""}`)}),l(ie,re)},Q=ie=>{var re=Rr(),F=z(re),R=r(F),C=r(R);a(R),a(F);var c=i(F,2),T=r(c,!0);a(c);var E=i(c,2);{var p=U=>{var h=wr();ce(h,"inline",!0),ce(h,"icon","mdi:skip-forward"),l(U,h)},P=(U,h)=>{{var S=G=>{var N=kr();ce(N,"inline",!0),ce(N,"icon","mdi:arrow-u-down-right-bold"),l(G,N)},w=G=>{var N=Sr(),ve=r(N,!0);a(N),K(()=>s(ve,e.talk.text)),l(G,N)};j(U,G=>{e.talk.skip?G(S):G(w,!1)},h)}};j(E,U=>{e.talk.over?U(p):U(P,!1)})}var B=i(E,2),le=r(B);a(B),K(()=>{Ie(C,"src",e.isDefaultProfile?`${mt}${lt[e.talk.agent]}`:""),Ie(C,"alt",e.talk.agent),s(T,e.talk.agent),s(le,`Idx: ${e.talk.idx??""}`)}),l(ie,re)};j(_,ie=>{var re;(re=n(v))!=null&&re.display.largeScale?ie(M):ie(Q,!1)})}a(x),l(t,x),Ge()}var Or=d('<input type="radio" name="talk_days" class="tab text-lg font-bold"> <div class="tab-content my-4"></div>',1),Nr=d('<div class="tabs tabs-border"></div>'),Dr=d('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),jr=d('<input type="radio" name="talk_days" class="tab"> <div class="tab-content my-4"></div>',1),Cr=d('<div class="tabs tabs-border"></div>'),Mr=d('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),Lr=d('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function wt(t,e){Ke(e,!0);let v=oe(void 0),x=e.agents.every(F=>Object.keys(lt).includes(F));Xe(()=>{const F=Se.subscribe(R=>{Y(v,R,!0)});Je(F)});var _=Lr(),M=r(_),Q=r(M);{var ie=F=>{var R=Dr(),C=z(R),c=r(C,!0);a(C);var T=i(C,2),E=r(T);{var p=P=>{var B=Nr();const le=ke(()=>[...new Set(e.talks.map(U=>U.day))].sort((U,h)=>h-U));be(B,21,()=>n(le),he,(U,h)=>{var S=Or(),w=z(S);Ne(w);var G=i(w,2);be(G,21,()=>e.talks.filter(N=>N.day===n(h)),he,(N,ve)=>{Tt(N,{get talk(){return n(ve)},get agents(){return e.agents},isDefaultProfile:x})}),a(G),K(()=>{nt(w,n(h)===n(le)[0]),Ie(w,"aria-label",`${n(h)}日目`)}),l(U,S)}),a(B),l(P,B)};j(E,P=>{e.talks.length>0&&P(p)})}a(T),K(()=>s(c,e.header)),l(F,R)},re=F=>{var R=Mr(),C=z(R),c=r(C,!0);a(C);var T=i(C,2),E=r(T);{var p=P=>{var B=Cr();const le=ke(()=>[...new Set(e.talks.map(U=>U.day))].sort((U,h)=>h-U));be(B,21,()=>n(le),he,(U,h)=>{var S=jr(),w=z(S);Ne(w);var G=i(w,2);be(G,21,()=>e.talks.filter(N=>N.day===n(h)),he,(N,ve)=>{Tt(N,{get talk(){return n(ve)},get agents(){return e.agents},isDefaultProfile:x})}),a(G),K(()=>{nt(w,n(h)===n(le)[0]),Ie(w,"aria-label",`${n(h)}日目`)}),l(U,S)}),a(B),l(P,B)};j(E,P=>{e.talks.length>0&&P(p)})}a(T),K(()=>s(c,e.header)),l(F,R)};j(Q,F=>{var R;(R=n(v))!=null&&R.display.largeScale?F(ie):F(re,!1)})}a(M),a(_),l(t,_),Ge()}var Hr=d('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),Fr=d('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none"> </pre></div>'),Pr=d('<div role="alert" class="alert m-4"><span class="text-lg font-bold"> </span></div>'),Vr=d('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function rn(t,e){Ke(e,!0);const[v,x]=ze(),_=()=>Qe($e,"$_",v);let M=oe(void 0),Q=oe(""),ie=oe(null),re=oe(je([])),F=oe(null),R=oe(null),C=oe(null),c=oe(null),T=oe(null),E=oe(je([])),p=oe(je([])),P=oe(null),B=oe(je([])),le=oe(je([])),U=oe(je([])),h=oe(je([])),S=oe(null),w=oe(null),G=Se.subscribe(b=>{Y(M,b,!0)}),N=Ve.subscribe(b=>{Y(Q,b.status,!0),b.deadline?(Y(ie,b.deadline.getTime(),!0),fe()):(Y(ie,null),Y(S,null),n(w)&&(cancelAnimationFrame(n(w)),Y(w,null))),Y(re,b.entries,!0),Y(F,b.agent,!0),Y(R,b.role,!0),Y(C,b.profile,!0),Y(c,b.request,!0),Y(T,b.info,!0),Y(E,b.mediumResults,!0),Y(p,b.divineResults,!0),Y(P,b.setting,!0),Y(B,b.talkHistory,!0),Y(le,b.whisperHistory,!0),Y(U,b.executedAgents,!0),Y(h,b.attackedAgents,!0)});function ve(){const b=Gt.url.searchParams,y=b.get("url"),k=b.get("token");y&&(Se.update(D=>({...D,connection:{url:y??"",token:k??""}})),Ve.connect())}function fe(){if(n(ie)===null)return;const b=()=>{if(n(ie)===null)return;const y=Date.now(),k=Math.max(0,n(ie)-y);Y(S,k,!0),k>0?Y(w,requestAnimationFrame(b),!0):(Y(S,0),Y(w,null))};n(w)&&cancelAnimationFrame(n(w)),Y(w,requestAnimationFrame(b),!0)}function me(b){Ve.send(b)}{ve();const b=k=>{n(Q)==="connected"&&k.preventDefault()},y=k=>{n(Q)==="connected"&&k.preventDefault()};window.addEventListener("beforeunload",b),window.addEventListener("popstate",y),Je(()=>{window.removeEventListener("beforeunload",b),window.removeEventListener("popstate",y),n(w)&&cancelAnimationFrame(n(w)),G(),N()})}var $=Vr();Kt(b=>{Vt.title="aiwolf-nlp-viewer"});var ee=r($);hr(ee,{});var ne=i(ee,2);{var se=b=>{var y=Hr(),k=z(y),D=r(k);cr(D,{get agent(){return n(F)},get role(){return n(R)},get profile(){return n(C)},get request(){return n(c)},get info(){return n(T)},get mediumResults(){return n(E)},get divineResults(){return n(p)},get executedAgents(){return n(U)},get attackedAgents(){return n(h)}});var Z=i(D,2);const V=ke(()=>_()("agent.talkHistory")),te=ke(()=>{var u;return Object.keys(((u=n(T))==null?void 0:u.status_map)??{})});wt(Z,{get header(){return n(V)},get talks(){return n(B)},get agents(){return n(te)}});var L=i(Z,2);{var H=u=>{const A=ke(()=>_()("agent.whisperHistory")),g=ke(()=>{var o;return Object.keys(((o=n(T))==null?void 0:o.status_map)??{})});wt(u,{get header(){return n(A)},get talks(){return n(le)},get agents(){return n(g)}})};j(L,u=>{n(R)===Ut.WEREWOLF&&u(H)})}a(k);var O=i(k,2);{var X=u=>{Pa(u,{get remain(){return n(S)},get setting(){return n(P)},get request(){return n(c)},get info(){return n(T)},onSendMessage:me})};j(O,u=>{n(S)!==null&&u(X)})}l(b,y)},ue=(b,y)=>{{var k=Z=>{var V=Fr(),te=r(V),L=r(te,!0);a(te),a(V),K(H=>s(L,H),[()=>_()("agent.notConnected")]),l(Z,V)},D=Z=>{var V=Pr(),te=r(V),L=r(te,!0);a(te),a(V),K(H=>s(L,H),[()=>_()("agent.notConnected")]),l(Z,V)};j(b,Z=>{var V;(V=n(M))!=null&&V.display.largeScale?Z(k):Z(D,!1)},y)}};j(ne,b=>{n(T)!==null?b(se):b(ue,!1)})}a($),l(t,$),Ge(),x()}export{rn as component};
