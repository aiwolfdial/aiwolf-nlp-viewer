var vt=Object.defineProperty;var ut=(t,e,o)=>e in t?vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var Je=(t,e,o)=>ut(t,typeof e!="symbol"?e+"":e,o);import{t as _,a as s,c as ge}from"../chunks/Dhw87SHn.js";import{e as Ke,u as ft,p as Ee,aE as ae,aG as Oe,j as _t,d as B,g as n,c as a,r,a as De,f as z,s as i,aH as fe,t as P,ae as Ae,$ as dt}from"../chunks/BOtI2AQT.js";import{h as gt}from"../chunks/uGJCHHHe.js";import{i as N}from"../chunks/DOjvVc5q.js";import{o as He,a as je}from"../chunks/BzesmMMy.js";import{p as xt}from"../chunks/DjEOiCT6.js";import{w as st}from"../chunks/CVZ_vLBR.js";import{a as se,s as Ce,b as Ie,c as Se,d as we,e as Le,f as Pe,S as he,D as Ue,g as mt}from"../chunks/Cguwj11f.js";/* empty css                */import{d as ct,s as b}from"../chunks/rIR5awjR.js";import{e as _e,i as de}from"../chunks/DglHXIJX.js";import{r as ye,s as oe,a as me,c as Ne,d as We}from"../chunks/bp46B8nJ.js";import{b as Xe}from"../chunks/C-B37evS.js";import{b as Ze}from"../chunks/Dbazzlnb.js";import{s as Ge}from"../chunks/BeOeQHln.js";import{b as Ye}from"../chunks/Cc3peBMt.js";function $e(t,e,o){Ke(()=>{var v=ft(()=>e(t,o==null?void 0:o())||{});if(v!=null&&v.destroy)return()=>v.destroy()})}class Be{static fromJson(e){return ht(JSON.parse(e),qe("AgentSettings"))}static toJson(e){return JSON.stringify(yt(e,qe("AgentSettings")),null,2)}}function pe(t,e,o,v=""){const H=ze(t),X=v?` on ${v}`:"",te=o?` for key "${o}"`:"";throw Error(`Invalid value${te}${X}. Expected ${H} but got ${JSON.stringify(e)}`)}function ze(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${ze(t[1])}`:`one of [${t.map(e=>ze(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function bt(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(o=>e[o.json]={key:o.js,typ:o.typ}),t.jsonToJS=e}return t.jsonToJS}function pt(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(o=>e[o.js]={key:o.json,typ:o.typ}),t.jsToJSON=e}return t.jsToJSON}function Te(t,e,o,v="",H=""){function X(f,D){return typeof f==typeof D?D:pe(f,D,v,H)}function te(f,D){const L=f.length;for(let x=0;x<L;x++){const p=f[x];try{return Te(D,p,o)}catch{}}return pe(f,D,v,H)}function ee(f,D){return f.indexOf(D)!==-1?D:pe(f.map(L=>Fe(L)),D,v,H)}function J(f,D){return Array.isArray(D)?D.map(L=>Te(L,f,o)):pe(Fe("array"),D,v,H)}function h(f){if(f===null)return null;const D=new Date(f);return isNaN(D.valueOf())?pe(Fe("Date"),f,v,H):D}function k(f,D,L){if(L===null||typeof L!="object"||Array.isArray(L))return pe(Fe(F||"object"),L,v,H);const x={};return Object.getOwnPropertyNames(f).forEach(p=>{const w=f[p],C=Object.prototype.hasOwnProperty.call(L,p)?L[p]:void 0;x[w.key]=Te(C,w.typ,o,p,F)}),Object.getOwnPropertyNames(L).forEach(p=>{Object.prototype.hasOwnProperty.call(f,p)||(x[p]=Te(L[p],D,o,p,F))}),x}if(e==="any")return t;if(e===null)return t===null?t:pe(e,t,v,H);if(e===!1)return pe(e,t,v,H);let F;for(;typeof e=="object"&&e.ref!==void 0;)F=e.ref,e=At[e.ref];return Array.isArray(e)?ee(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?te(e.unionMembers,t):e.hasOwnProperty("arrayItems")?J(e.arrayItems,t):e.hasOwnProperty("props")?k(o(e),e.additional,t):pe(e,t,v,H):e===Date&&typeof t!="number"?h(t):X(e,t)}function ht(t,e){return Te(t,e,bt)}function yt(t,e){return Te(t,e,pt)}function Fe(t){return{literal:t}}function Ve(t,e){return{props:t,additional:e}}function qe(t){return{ref:t}}const At={AgentSettings:Ve([{json:"connection",js:"connection",typ:qe("Connection")},{json:"team",js:"team",typ:""},{json:"display",js:"display",typ:qe("Display")}],!1),Connection:Ve([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1),Display:Ve([{json:"largeScale",js:"largeScale",typ:!0}],!1)},et={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}};function kt(){const t=localStorage.getItem("agent-settings");if(t)try{return Be.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",Be.toJson(et)),et}const be=st(kt());be.subscribe(t=>{localStorage.setItem("agent-settings",Be.toJson(t))});function wt(){const{subscribe:t,update:e}=st({status:"disconnected",deadline:null,entries:[],role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let o=null,v=null,H=null,X=null;be.subscribe(h=>{v=h});function te(){o&&(o.close(),o=null,e(h=>({...h,status:"disconnected"}))),X&&(X.clear(),X=null)}function ee(){if(!v)return;o&&e(k=>({...k,status:"disconnected",deadline:null,entries:[],role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]})),e(k=>({...k,status:"connecting"}));const h=new URL(v.connection.url);v.connection.token&&h.searchParams.set("token",v.connection.token),o=new WebSocket(h),o.onopen=()=>{e(k=>({...k,status:"connected"}))},o.onclose=()=>{te()},o.onerror=()=>{te()},o.onmessage=k=>{try{const F=Date.now(),f=JSON.parse(k.data);switch(e(D=>{const L=D.entries.slice();L.push(f);const x={...D,entries:L,request:f.request};if(f.info){if(x.info=f.info,f.info.medium_result){const p=f.info.medium_result;x.mediumResults.findIndex(w=>w.day===p.day&&w.agent===p.agent)<0&&x.mediumResults.push(f.info.medium_result)}if(f.info.divine_result){const p=f.info.divine_result;x.divineResults.findIndex(w=>w.day===p.day&&w.agent===p.agent)<0&&x.divineResults.push(f.info.divine_result)}f.info.executed_agent&&x.executedAgents.push(f.info.executed_agent),f.info.attacked_agent&&x.attackedAgents.push(f.info.attacked_agent)}return f.setting&&(x.setting=f.setting,H=f.setting.timeout.action),f.talk_history&&x.talkHistory.push(...f.talk_history),f.whisper_history&&x.whisperHistory.push(...f.whisper_history),f.request===se.INITIALIZE&&x.info&&(x.role=x.info.role_map[x.info.agent],x.profile=x.info.profile||null),x}),f.request){case se.NAME:J((v==null?void 0:v.team)||"viewer"+Math.floor(Math.random()*1e3));break;case se.TALK:case se.WHISPER:case se.VOTE:case se.DIVINE:case se.GUARD:case se.ATTACK:X&&X.clear(),X=new It(()=>{J("TIMEOUT")},new Date(F+(H??6e4))),e(D=>({...D,deadline:(X==null?void 0:X.deadline())??null}));break;case se.FINISH:te();break}}catch(F){console.error("Failed to parse message:",F)}}}function J(h){if(X&&(X.clear(),X=null,e(k=>({...k,deadline:null}))),o&&o.readyState===WebSocket.OPEN)try{o.send(h),e(k=>{const F=k.entries.slice();return F.push(h),{...k,entries:F}})}catch(k){console.error("Failed to send message:",k)}}return{subscribe:t,connect:ee,disconnect:te,send:J}}const Re=wt();class It{constructor(e,o){Je(this,"timeout");Je(this,"_deadline");this.timeout=setTimeout(e,o.getTime()-new Date().getTime()),this._deadline=o}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var tt;(function(t){t[t.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",t[t.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",t[t.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",t[t.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",t[t.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",t[t.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",t[t.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",t[t.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",t[t.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",t[t.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",t[t.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",t[t.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",t[t.TAGS_START=917504]="TAGS_START",t[t.TAGS_END=917631]="TAGS_END",t[t.ZWJ=8205]="ZWJ"})(tt||(tt={}));const St=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var rt;function at(t){if(typeof t!="string")throw new TypeError("string cannot be undefined or null");const e=[];let o=0,v=0;for(;o<t.length;)v+=Tt(o+v,t),Mt(t[o+v])&&v++,Dt(t[o+v])&&v++,Nt(t[o+v])&&v++,Ct(t[o+v])?v++:(e.push(t.substring(o,o+v)),o+=v,v=0);return e}function Tt(t,e){const o=e[t];if(!Rt(o)||t===e.length-1)return 1;const v=o+e[t+1];let H=e.substring(t+2,t+5);return nt(v)&&nt(H)?4:Ot(v)&&jt(H)?e.slice(t).indexOf(String.fromCodePoint(917631))+2:Et(H)?4:2}function Rt(t){return t&&ke(t[0].charCodeAt(0),55296,56319)}function nt(t){return ke(Qe(t),127462,127487)}function Ot(t){return ke(Qe(t),127988,127988)}function Et(t){return ke(Qe(t),127995,127999)}function Dt(t){return typeof t=="string"&&ke(t.charCodeAt(0),65024,65039)}function Nt(t){return typeof t=="string"&&ke(t.charCodeAt(0),8400,8447)}function jt(t){const e=t.codePointAt(0);return typeof t=="string"&&typeof e=="number"&&ke(e,917504,917631)}function Mt(t){return typeof t=="string"&&St.includes(t.charCodeAt(0))}function Ct(t){return typeof t=="string"&&t.charCodeAt(0)===8205}function Qe(t){return(t.charCodeAt(0)-55296<<10)+(t.charCodeAt(1)-56320)+65536}function ke(t,e,o){return t>=e&&t<=o}(function(t){t[t.unit_1=1]="unit_1",t[t.unit_2=2]="unit_2",t[t.unit_4=4]="unit_4"})(rt||(rt={}));function it(t,e,o){t.key==="Enter"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.onSendMessage(n(o)))}var Lt=_('<span aria-live="polite"> </span>m',1),Pt=(t,e,o)=>e(o()),Ft=_('<button class="btn btn-xl"> </button>'),qt=(t,e)=>e("Skip"),Ht=_('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),Jt=(t,e)=>e("Over"),Gt=_('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),Vt=_("<option></option>"),Kt=_("<option></option>"),Ut=_("<!> <option></option>",1),Wt=_('<pre class="text-2xl"> </pre>'),Zt=_('<pre class="text-2xl bg-error text-error-content"> </pre>'),Bt=(t,e,o)=>e.onSendMessage(n(o)),zt=_('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),Qt=_('<span aria-live="polite"> </span>m',1),Xt=(t,e,o)=>e(o()),Yt=_('<button class="btn"> </button>'),$t=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),er=(t,e)=>e("Skip"),tr=_('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),rr=(t,e)=>e("Over"),ar=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),nr=_("<option></option>"),ir=_("<option></option>"),or=_("<!> <option></option>",1),lr=_('<pre class="text-md"> </pre>'),sr=_('<pre class="text-md bg-error text-error-content"> </pre>'),cr=(t,e,o)=>e.onSendMessage(n(o)),vr=_('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),ur=_('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function fr(t,e){Ee(e,!0);let o=ae(""),v=ae(0),H=ae(void 0),X=ae(null);const te=Oe(()=>{var x;return e.remain!==null?e.remain/(((x=e.setting)==null?void 0:x.timeout.action)??6e4)*100:0}),ee=Oe(()=>[se.VOTE,se.DIVINE,se.GUARD,se.ATTACK].includes(e.request));function J(x){var C,j;if(!e.request||!e.setting)return 0;const p=e.request===se.TALK?e.setting.talk.max_length:e.request===se.WHISPER?e.setting.whisper.max_length:null;if(!p)return 0;let w=p.base_length??0;if(w+=((C=e.info)==null?void 0:C.remain_length)??0,p.mention_length){for(const q in((j=e.info)==null?void 0:j.status_map)??{})if(x.indexOf("@"+q)!==-1){w+=p.mention_length,w+=at("@"+q).length;break}}return p.per_talk&&(w=Math.min(w,p.per_talk)),w-=at(x).length,w}_t(()=>{B(v,J(n(o)),!0)}),He(()=>{const x=be.subscribe(p=>{B(H,p,!0)});return()=>{x()}});function h(x){var p;B(o,x,!0),(p=n(X))==null||p.focus()}function k(x){x.focus()}var F=ur(),f=a(F);{var D=x=>{var p=zt(),w=z(p),C=a(w),j=a(C);{var q=l=>{var g=Lt(),T=z(g),S=a(T,!0);r(T),fe(),P((Y,U,V)=>{Ce(T,`--value:${Y??""};`),me(T,"aria-label",U),b(S,V)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),s(l,g)};N(j,l=>{e.remain&&e.remain>6e4&&l(q)})}var $=i(j,2),re=a($,!0);r($),fe(),r(C);var I=i(C,2),A=a(I,!0);r(I),r(w);var K=i(w,2),ne=a(K);{var ie=l=>{var g=ge(),T=z(g);_e(T,17,()=>{var S;return Object.entries(((S=e.info)==null?void 0:S.status_map)??{})},de,(S,Y)=>{let U=()=>n(Y)[0],V=()=>n(Y)[1];var le=ge(),ue=z(le);{var xe=ve=>{var ce=Ft();ce.__click=[Pt,h,U];var Me=a(ce,!0);r(ce),P(()=>b(Me,U())),s(ve,ce)};N(ue,ve=>{var ce;V()===Se.ALIVE&&U()!==((ce=e.info)==null?void 0:ce.agent)&&ve(xe)})}s(S,le)}),s(l,g)},W=l=>{var g=Gt(),T=z(g);{var S=V=>{var le=Ht();le.__click=[qt,h];var ue=a(le);oe(ue,"icon","mdi:arrow-u-down-right-bold"),fe(),r(le),s(V,le)};N(T,V=>{var le;(((le=e.info)==null?void 0:le.remain_skip)??0)>0&&V(S)})}var Y=i(T,2);Y.__click=[Jt,h];var U=a(Y);oe(U,"icon","mdi:skip-forward"),fe(),r(Y),s(l,g)};N(ne,l=>{n(ee)?l(ie):l(W,!1)})}var u=i(ne,2);ye(u),u.__keydown=[it,e,o],Ke(()=>Xe(u,()=>n(o),l=>B(o,l))),$e(u,l=>k==null?void 0:k(l)),Ze(u,l=>B(X,l),()=>n(X));var O=i(u,2),M=a(O);{var G=l=>{var g=ge(),T=z(g);_e(T,17,()=>{var S;return Object.entries(((S=e.info)==null?void 0:S.status_map)??{})},de,(S,Y)=>{let U=()=>n(Y)[0],V=()=>n(Y)[1];var le=ge(),ue=z(le);{var xe=ve=>{var ce=Vt(),Me={};P(()=>{Me!==(Me=U())&&(ce.value=(ce.__value=U())==null?"":U())}),s(ve,ce)};N(ue,ve=>{var ce;V()===Se.ALIVE&&U()!==((ce=e.info)==null?void 0:ce.agent)&&ve(xe)})}s(S,le)}),s(l,g)},Z=l=>{var g=Ut(),T=z(g);{var S=U=>{var V=Kt();V.value=(V.__value="Skip")==null?"":"Skip",s(U,V)};N(T,U=>{var V;(((V=e.info)==null?void 0:V.remain_skip)??0)>0&&U(S)})}var Y=i(T,2);Y.value=(Y.__value="Over")==null?"":"Over",s(l,g)};N(M,l=>{n(ee)?l(G):l(Z,!1)})}r(O);var Q=i(O,2);{var y=l=>{var g=Wt(),T=a(g);r(g),P(()=>b(T,`残り${n(v)??""}文字`)),s(l,g)},E=l=>{var g=Zt(),T=a(g);r(g),P(()=>b(T,`${n(v)*-1}文字超過`)),s(l,g)};N(Q,l=>{n(v)>=0?l(y):l(E,!1)})}var R=i(Q,2);R.__click=[Bt,e,o];var d=a(R);oe(d,"icon","mdi:send"),fe(),r(R),r(K);var c=i(K,2),m=a(c);r(c),P((l,g,T)=>{Ce($,`--value:${l??""};`),me($,"aria-label",g),b(re,T),b(A,n(ee)?`${Ie[e.request]}対象を選択してください`:`${Ie[e.request??se.INITIALIZE]}内容を入力してください`),Ne(m,n(te))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),s(x,p)},L=x=>{var p=vr(),w=z(p),C=a(w),j=a(C);{var q=d=>{var c=Qt(),m=z(c),l=a(m,!0);r(m),fe(),P((g,T,S)=>{Ce(m,`--value:${g??""};`),me(m,"aria-label",T),b(l,S)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),s(d,c)};N(j,d=>{e.remain&&e.remain>6e4&&d(q)})}var $=i(j,2),re=a($,!0);r($),fe(),r(C);var I=i(C,2);{var A=d=>{var c=$t(),m=z(c),l=a(m);r(m);var g=i(m,2);_e(g,17,()=>{var T;return Object.entries(((T=e.info)==null?void 0:T.status_map)??{})},de,(T,S)=>{let Y=()=>n(S)[0],U=()=>n(S)[1];var V=ge(),le=z(V);{var ue=xe=>{var ve=Yt();ve.__click=[Xt,h,Y];var ce=a(ve,!0);r(ve),P(()=>b(ce,Y())),s(xe,ve)};N(le,xe=>{var ve;U()===Se.ALIVE&&Y()!==((ve=e.info)==null?void 0:ve.agent)&&xe(ue)})}s(T,V)}),P(()=>b(l,`${Ie[e.request]??""}対象を選択してください`)),s(d,c)},K=d=>{var c=ar(),m=z(c),l=a(m);r(m);var g=i(m,2);{var T=U=>{var V=tr();V.__click=[er,h];var le=a(V);oe(le,"icon","mdi:arrow-u-down-right-bold"),fe(),r(V),s(U,V)};N(g,U=>{var V;(((V=e.info)==null?void 0:V.remain_skip)??0)>0&&U(T)})}var S=i(g,2);S.__click=[rr,h];var Y=a(S);oe(Y,"icon","mdi:skip-forward"),fe(),r(S),P(()=>b(l,`${Ie[e.request??se.INITIALIZE]??""}内容を入力してください`)),s(d,c)};N(I,d=>{n(ee)?d(A):d(K,!1)})}var ne=i(I,2);ye(ne),ne.__keydown=[it,e,o],Ke(()=>Xe(ne,()=>n(o),d=>B(o,d))),$e(ne,d=>k==null?void 0:k(d)),Ze(ne,d=>B(X,d),()=>n(X));var ie=i(ne,2),W=a(ie);{var u=d=>{var c=ge(),m=z(c);_e(m,17,()=>{var l;return Object.entries(((l=e.info)==null?void 0:l.status_map)??{})},de,(l,g)=>{let T=()=>n(g)[0],S=()=>n(g)[1];var Y=ge(),U=z(Y);{var V=le=>{var ue=nr(),xe={};P(()=>{xe!==(xe=T())&&(ue.value=(ue.__value=T())==null?"":T())}),s(le,ue)};N(U,le=>{var ue;S()===Se.ALIVE&&T()!==((ue=e.info)==null?void 0:ue.agent)&&le(V)})}s(l,Y)}),s(d,c)},O=d=>{var c=or(),m=z(c);{var l=T=>{var S=ir();S.value=(S.__value="Skip")==null?"":"Skip",s(T,S)};N(m,T=>{var S;(((S=e.info)==null?void 0:S.remain_skip)??0)>0&&T(l)})}var g=i(m,2);g.value=(g.__value="Over")==null?"":"Over",s(d,c)};N(W,d=>{n(ee)?d(u):d(O,!1)})}r(ie);var M=i(ie,2);{var G=d=>{var c=lr(),m=a(c);r(c),P(()=>b(m,`残り${n(v)??""}文字`)),s(d,c)},Z=d=>{var c=sr(),m=a(c);r(c),P(()=>b(m,`${n(v)*-1}文字超過`)),s(d,c)};N(M,d=>{n(v)>=0?d(G):d(Z,!1)})}var Q=i(M,2);Q.__click=[cr,e,o];var y=a(Q);oe(y,"icon","mdi:send"),fe(),r(Q),r(w);var E=i(w,2),R=a(E);r(E),P((d,c,m)=>{Ce($,`--value:${d??""};`),me($,"aria-label",c),b(re,m),Ne(R,n(te))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),s(x,p)};N(f,x=>{var p;(p=n(H))!=null&&p.display.largeScale?x(D):x(L,!1)})}r(F),s(t,F),De()}ct(["click","keydown"]);var _r=_('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),dr=_('<pre class="text-md text-pretty break-all my-2"> </pre>'),gr=_('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),xr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),mr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),br=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),pr=_('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),hr=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),yr=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ar=_('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),kr=_('<div class="grow overflow-y-auto pr-4"><pre class="text-5xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!> <!></div>'),wr=_('<pre class="text-lg text-center"> </pre>'),Ir=_('<h2 class="text-lg font-bold text-center">プロフィール</h2> <pre class="text-md text-pretty break-all"> </pre>',1),Sr=_('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Tr=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Rr=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Or=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Er=_('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),Dr=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Nr=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),jr=_('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),Mr=_('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <!> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),Cr=_('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function Lr(t,e){Ee(e,!0);let o=ae(void 0);He(()=>{const J=be.subscribe(h=>{B(o,h,!0)});je(J)});var v=Cr(),H=a(v),X=a(H);{var te=J=>{var h=kr(),k=a(h),F=a(k,!0);r(k);var f=i(k,2),D=a(f,!0);r(f);var L=i(f,2);{var x=I=>{var A=_r(),K=a(A,!0);r(A),P(()=>b(K,Ie[e.request])),s(I,A)};N(L,I=>{e.request&&I(x)})}var p=i(L,2);{var w=I=>{var A=dr(),K=a(A,!0);r(A),P(()=>b(K,e.profile)),s(I,A)};N(p,I=>{e.profile&&I(w)})}var C=i(p,2);_e(C,17,()=>Object.entries(e.info.status_map??{}),de,(I,A)=>{let K=()=>n(A)[0],ne=()=>n(A)[1];var ie=ge(),W=z(ie);{var u=M=>{var G=gr(),Z=a(G),Q=a(Z,!0);r(Z);var y=i(Z,2),E=a(y,!0);r(y);var R=i(y,2),d=a(R,!0);r(R),r(G),P(()=>{b(Q,K()),b(E,we[(e.info.role_map??{})[K()]]??""),b(d,Le[ne()])}),s(M,G)},O=M=>{var G=xr(),Z=a(G),Q=a(Z,!0);r(Z);var y=i(Z,2),E=a(y,!0);r(y);var R=i(y,2),d=a(R);r(R),r(G),P(c=>{b(Q,K()),b(E,we[(e.info.role_map??{})[K()]]??""),b(d,`${Le[ne()]??""}${c??""}`)},[()=>e.executedAgents.includes(K())?" (追放)":e.attackedAgents.includes(K())?" (襲撃)":""]),s(M,G)};N(W,M=>{ne()===Se.ALIVE?M(u):M(O,!1)})}s(I,ie)});var j=i(C,2);{var q=I=>{var A=pr(),K=i(z(A),2);_e(K,17,()=>e.mediumResults,de,(ne,ie)=>{let W=()=>n(ie).day,u=()=>n(ie).target,O=()=>n(ie).result;var M=ge(),G=z(M);{var Z=y=>{var E=mr(),R=a(E),d=a(R,!0);r(R);var c=i(R,2),m=a(c);r(c);var l=i(c,2),g=a(l,!0);r(l),r(E),P(()=>{b(d,u()),b(m,`(${W()??""}日目)`),b(g,he[O()])}),s(y,E)},Q=y=>{var E=br(),R=a(E),d=a(R,!0);r(R);var c=i(R,2),m=a(c);r(c);var l=i(c,2),g=a(l,!0);r(l),r(E),P(()=>{b(d,u()),b(m,`(${W()??""}日目)`),b(g,he[O()])}),s(y,E)};N(G,y=>{O()!==Pe.HUMAN?y(Z):y(Q,!1)})}s(ne,M)}),s(I,A)};N(j,I=>{e.mediumResults.length>0&&I(q)})}var $=i(j,2);{var re=I=>{var A=Ar(),K=i(z(A),2);_e(K,17,()=>e.divineResults,de,(ne,ie)=>{let W=()=>n(ie).day,u=()=>n(ie).target,O=()=>n(ie).result;var M=ge(),G=z(M);{var Z=y=>{var E=hr(),R=a(E),d=a(R,!0);r(R);var c=i(R,2),m=a(c);r(c);var l=i(c,2),g=a(l,!0);r(l),r(E),P(()=>{b(d,u()),b(m,`(${W()??""}日目)`),b(g,he[O()])}),s(y,E)},Q=y=>{var E=yr(),R=a(E),d=a(R,!0);r(R);var c=i(R,2),m=a(c);r(c);var l=i(c,2),g=a(l,!0);r(l),r(E),P(()=>{b(d,u()),b(m,`(${W()??""}日目)`),b(g,he[O()])}),s(y,E)};N(G,y=>{O()!==Pe.HUMAN?y(Z):y(Q,!1)})}s(ne,M)}),s(I,A)};N($,I=>{e.divineResults.length>0&&I(re)})}r(h),P(()=>{b(F,e.role?we[e.role]:"ゲーム外"),b(D,e.info?e.info.day+"日目":"ゲーム外")}),s(J,h)},ee=J=>{var h=Mr(),k=i(z(h),2),F=a(k),f=a(F),D=i(a(f),2),L=a(D,!0);r(D),r(f);var x=i(f,2),p=i(a(x),2),w=a(p,!0);r(p),r(x);var C=i(x,2),j=i(a(C),2);{var q=W=>{var u=wr(),O=a(u,!0);r(u),P(()=>b(O,Ie[e.request])),s(W,u)};N(j,W=>{e.request&&W(q)})}r(C),r(F);var $=i(F,2);{var re=W=>{var u=Ir(),O=i(z(u),2),M=a(O,!0);r(O),P(()=>b(M,e.profile)),s(W,u)};N($,W=>{e.profile&&W(re)})}var I=i($,4);_e(I,17,()=>Object.entries(e.info.status_map??{}),de,(W,u)=>{let O=()=>n(u)[0],M=()=>n(u)[1];var G=ge(),Z=z(G);{var Q=E=>{var R=Sr(),d=a(R),c=a(d,!0);r(d);var m=i(d,2),l=a(m,!0);r(m);var g=i(m,2),T=a(g,!0);r(g),r(R),P(()=>{b(c,O()),b(l,we[(e.info.role_map??{})[O()]]??""),b(T,Le[M()])}),s(E,R)},y=E=>{var R=Tr(),d=a(R),c=a(d,!0);r(d);var m=i(d,2),l=a(m,!0);r(m);var g=i(m,2),T=a(g);r(g),r(R),P(S=>{b(c,O()),b(l,we[(e.info.role_map??{})[O()]]??""),b(T,`${Le[M()]??""}${S??""}`)},[()=>e.executedAgents.includes(O())?" (追放)":e.attackedAgents.includes(O())?" (襲撃)":""]),s(E,R)};N(Z,E=>{M()===Se.ALIVE?E(Q):E(y,!1)})}s(W,G)});var A=i(I,2);{var K=W=>{var u=Er(),O=i(z(u),2);_e(O,17,()=>e.mediumResults,de,(M,G)=>{let Z=()=>n(G).day,Q=()=>n(G).target,y=()=>n(G).result;var E=ge(),R=z(E);{var d=m=>{var l=Rr(),g=a(l),T=a(g,!0);r(g);var S=i(g,2),Y=a(S);r(S);var U=i(S,2),V=a(U,!0);r(U),r(l),P(()=>{b(T,Q()),b(Y,`(${Z()??""}日目)`),b(V,he[y()])}),s(m,l)},c=m=>{var l=Or(),g=a(l),T=a(g,!0);r(g);var S=i(g,2),Y=a(S);r(S);var U=i(S,2),V=a(U,!0);r(U),r(l),P(()=>{b(T,Q()),b(Y,`(${Z()??""}日目)`),b(V,he[y()])}),s(m,l)};N(R,m=>{y()!==Pe.HUMAN?m(d):m(c,!1)})}s(M,E)}),s(W,u)};N(A,W=>{e.mediumResults.length>0&&W(K)})}var ne=i(A,2);{var ie=W=>{var u=jr(),O=i(z(u),2);_e(O,17,()=>e.divineResults,de,(M,G)=>{let Z=()=>n(G).day,Q=()=>n(G).target,y=()=>n(G).result;var E=ge(),R=z(E);{var d=m=>{var l=Dr(),g=a(l),T=a(g,!0);r(g);var S=i(g,2),Y=a(S);r(S);var U=i(S,2),V=a(U,!0);r(U),r(l),P(()=>{b(T,Q()),b(Y,`(${Z()??""}日目)`),b(V,he[y()])}),s(m,l)},c=m=>{var l=Nr(),g=a(l),T=a(g,!0);r(g);var S=i(g,2),Y=a(S);r(S);var U=i(S,2),V=a(U,!0);r(U),r(l),P(()=>{b(T,Q()),b(Y,`(${Z()??""}日目)`),b(V,he[y()])}),s(m,l)};N(R,m=>{y()!==Pe.HUMAN?m(d):m(c,!1)})}s(M,E)}),s(W,u)};N(ne,W=>{e.divineResults.length>0&&W(ie)})}r(k),P(()=>{b(L,e.role?we[e.role]:"ゲーム外"),b(w,e.info?e.info.day+"日目":"ゲーム外")}),s(J,h)};N(X,J=>{var h;(h=n(o))!=null&&h.display.largeScale?J(te):J(ee,!1)})}r(H),r(v),s(t,v),De()}function Pr(){Re.connect()}function Fr(){Re.disconnect()}var qr=_('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Hr=_('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),Jr=_('<div class="status status-error"></div>'),Gr=(t,e)=>e("connection.url",t.currentTarget.value),Vr=(t,e)=>e("connection.token",t.currentTarget.value),Kr=(t,e)=>e("team",t.currentTarget.value),Ur=(t,e)=>e("display.largeScale",t.currentTarget.checked),Wr=_('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./">aiwolf-nlp-viewer</a> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="WebSocket URL"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="Authorization Key"> <span class="badge badge-neutral badge-xs">Optional</span></label> <button class="btn btn-info">接続</button> <button class="btn btn-error">切断</button> <button class="btn">設定</button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold">エージェント設定</h3> <h4 class="text-base font-bold mt-2">チーム名</h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <h3 class="text-lg font-bold mt-4">表示設定</h3> <h4 class="text-base font-bold mt-2">大画面向け</h4> <label class="label cursor-pointer my-2"><span class="label-text">有効</span> <input type="checkbox" class="checkbox"></label></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function Zr(t,e){Ee(e,!0);let o=ae(void 0),v=ae(void 0);const H=be.subscribe(y=>{B(o,y,!0)}),X=Re.subscribe(y=>{B(v,y.status,!0)});je(()=>{H(),X()});function te(y,E){be.update(R=>{const d=y.split("."),c=d.pop();let m=R;for(const l of d)l&&(m=m[l]);return m[c]=E,{...R}})}let ee;var J=Wr(),h=i(a(J),2),k=a(h),F=a(k);{var f=y=>{var E=qr();fe(2),s(y,E)},D=(y,E)=>{{var R=c=>{var m=Hr();fe(2),s(c,m)},d=c=>{var m=Jr();s(c,m)};N(y,c=>{n(v)==="connecting"?c(R):c(d,!1)},E)}};N(F,y=>{n(v)==="connected"?y(f):y(D,!1)})}r(k),r(h);var L=i(h,2),x=a(L);Ge(x,1,"h-[1em] opacity-50"),oe(x,"inline",!0),oe(x,"icon","mdi:link");var p=i(x,2);ye(p),p.__input=[Gr,te],r(L);var w=i(L,2),C=a(w);Ge(C,1,"h-[1em] opacity-50"),oe(C,"inline",!0),oe(C,"icon","mdi:key");var j=i(C,2);ye(j),j.__input=[Vr,te],fe(2),r(w);var q=i(w,2);q.__click=[Pr];var $=i(q,2);$.__click=[Fr];var re=i($,2);re.__click=()=>ee.showModal();var I=i(re,2),A=a(I),K=a(A),ne=i(a(K),4),ie=a(ne);Ge(ie,1,"h-[1em] opacity-50"),oe(ie,"inline",!0),oe(ie,"icon","mdi:rename");var W=i(ie,2);ye(W),W.__input=[Kr,te],r(ne);var u=i(ne,6),O=i(a(u),2);ye(O),O.__change=[Ur,te],r(u),r(K),r(A),fe(2),r(I),Ze(I,y=>ee=y,()=>ee);var M=i(I,2),G=a(M);oe(G,"inline",!0),oe(G,"icon","mdi:white-balance-sunny");var Z=i(G,2),Q=i(Z,2);oe(Q,"inline",!0),oe(Q,"icon","mdi:moon-and-stars"),r(M),r(J),P(()=>{var y,E,R,d;Ne(p,(y=n(o))==null?void 0:y.connection.url),Ne(j,(E=n(o))==null?void 0:E.connection.token),q.disabled=n(v)!=="disconnected",$.disabled=n(v)==="disconnected",Ne(W,(R=n(o))==null?void 0:R.team),We(O,(d=n(o))==null?void 0:d.display.largeScale)}),s(t,J),De()}ct(["input","click","change"]);var Br=_("<iconify-icon></iconify-icon>",2),zr=_("<iconify-icon></iconify-icon>",2),Qr=_('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),Xr=_('<div class="chat-image avatar"><div class="w-20 rounded-full"><img></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),Yr=_("<iconify-icon></iconify-icon>",2),$r=_("<iconify-icon></iconify-icon>",2),ea=_('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),ta=_('<div class="chat-image avatar"><div class="w-10 rounded-full"><img></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),ra=_('<div class="chat chat-start"><!></div>');function ot(t,e){Ee(e,!0);let o=ae(void 0);He(()=>{const ee=be.subscribe(J=>{B(o,J,!0)});je(ee)});var v=ra(),H=a(v);{var X=ee=>{var J=Xr(),h=z(J),k=a(h),F=a(k);r(k),r(h);var f=i(h,2),D=a(f,!0);r(f);var L=i(f,2);{var x=j=>{var q=Br();oe(q,"inline",!0),oe(q,"icon","mdi:skip-forward"),s(j,q)},p=(j,q)=>{{var $=I=>{var A=zr();oe(A,"inline",!0),oe(A,"icon","mdi:arrow-u-down-right-bold"),s(I,A)},re=I=>{var A=Qr(),K=a(A,!0);r(A),P(()=>b(K,e.talk.text)),s(I,A)};N(j,I=>{e.talk.skip?I($):I(re,!1)},q)}};N(L,j=>{e.talk.over?j(x):j(p,!1)})}var w=i(L,2),C=a(w);r(w),P(()=>{me(F,"src",e.isDefaultProfile?`${Ye}${Ue[e.talk.agent]}`:""),me(F,"alt",e.talk.agent),b(D,e.talk.agent),b(C,`Idx: ${e.talk.idx??""}`)}),s(ee,J)},te=ee=>{var J=ta(),h=z(J),k=a(h),F=a(k);r(k),r(h);var f=i(h,2),D=a(f,!0);r(f);var L=i(f,2);{var x=j=>{var q=Yr();oe(q,"inline",!0),oe(q,"icon","mdi:skip-forward"),s(j,q)},p=(j,q)=>{{var $=I=>{var A=$r();oe(A,"inline",!0),oe(A,"icon","mdi:arrow-u-down-right-bold"),s(I,A)},re=I=>{var A=ea(),K=a(A,!0);r(A),P(()=>b(K,e.talk.text)),s(I,A)};N(j,I=>{e.talk.skip?I($):I(re,!1)},q)}};N(L,j=>{e.talk.over?j(x):j(p,!1)})}var w=i(L,2),C=a(w);r(w),P(()=>{me(F,"src",e.isDefaultProfile?`${Ye}${Ue[e.talk.agent]}`:""),me(F,"alt",e.talk.agent),b(D,e.talk.agent),b(C,`Idx: ${e.talk.idx??""}`)}),s(ee,J)};N(H,ee=>{var J;(J=n(o))!=null&&J.display.largeScale?ee(X):ee(te,!1)})}r(v),s(t,v),De()}var aa=_('<input type="radio" name="talk_days" class="tab text-lg font-bold"> <div class="tab-content my-4"></div>',1),na=_('<div class="tabs tabs-border"></div>'),ia=_('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),oa=_('<input type="radio" name="talk_days" class="tab"> <div class="tab-content my-4"></div>',1),la=_('<div class="tabs tabs-border"></div>'),sa=_('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),ca=_('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function lt(t,e){Ee(e,!0);let o=ae(void 0),v=e.agents.every(h=>Object.keys(Ue).includes(h));He(()=>{const h=be.subscribe(k=>{B(o,k,!0)});je(h)});var H=ca(),X=a(H),te=a(X);{var ee=h=>{var k=ia(),F=z(k),f=a(F,!0);r(F);var D=i(F,2),L=a(D);{var x=p=>{var w=na();const C=Oe(()=>[...new Set(e.talks.map(j=>j.day))].sort((j,q)=>q-j));_e(w,21,()=>n(C),de,(j,q)=>{var $=aa(),re=z($);ye(re);var I=i(re,2);_e(I,21,()=>e.talks.filter(A=>A.day===n(q)),de,(A,K)=>{ot(A,{get talk(){return n(K)},get agents(){return e.agents},isDefaultProfile:v})}),r(I),P(()=>{We(re,n(q)===n(C)[0]),me(re,"aria-label",`${n(q)}日目`)}),s(j,$)}),r(w),s(p,w)};N(L,p=>{e.talks.length>0&&p(x)})}r(D),P(()=>b(f,e.header)),s(h,k)},J=h=>{var k=sa(),F=z(k),f=a(F,!0);r(F);var D=i(F,2),L=a(D);{var x=p=>{var w=la();const C=Oe(()=>[...new Set(e.talks.map(j=>j.day))].sort((j,q)=>q-j));_e(w,21,()=>n(C),de,(j,q)=>{var $=oa(),re=z($);ye(re);var I=i(re,2);_e(I,21,()=>e.talks.filter(A=>A.day===n(q)),de,(A,K)=>{ot(A,{get talk(){return n(K)},get agents(){return e.agents},isDefaultProfile:v})}),r(I),P(()=>{We(re,n(q)===n(C)[0]),me(re,"aria-label",`${n(q)}日目`)}),s(j,$)}),r(w),s(p,w)};N(L,p=>{e.talks.length>0&&p(x)})}r(D),P(()=>b(f,e.header)),s(h,k)};N(te,h=>{var k;(k=n(o))!=null&&k.display.largeScale?h(ee):h(J,!1)})}r(X),r(H),s(t,H),De()}var va=_('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),ua=_('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none">未接続</pre></div>'),fa=_('<div role="alert" class="alert m-4"><span class="text-lg font-bold">未接続</span></div>'),_a=_('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Da(t,e){Ee(e,!0);let o=ae(void 0),v=ae(""),H=ae(null),X=ae(Ae([])),te=ae(null),ee=ae(null),J=ae(null),h=ae(null),k=ae(Ae([])),F=ae(Ae([])),f=ae(null),D=ae(Ae([])),L=ae(Ae([])),x=ae(Ae([])),p=ae(Ae([])),w=ae(null),C=ae(null),j=be.subscribe(u=>{B(o,u,!0)}),q=Re.subscribe(u=>{B(v,u.status,!0),u.deadline?(B(H,u.deadline.getTime(),!0),re()):(B(H,null),B(w,null),n(C)&&(cancelAnimationFrame(n(C)),B(C,null))),B(X,u.entries,!0),B(te,u.role,!0),B(ee,u.profile,!0),B(J,u.request,!0),B(h,u.info,!0),B(k,u.mediumResults,!0),B(F,u.divineResults,!0),B(f,u.setting,!0),B(D,u.talkHistory,!0),B(L,u.whisperHistory,!0),B(x,u.executedAgents,!0),B(p,u.attackedAgents,!0)});function $(){const u=xt.url.searchParams,O=u.get("url"),M=u.get("token");O&&(be.update(G=>({...G,connection:{url:O??"",token:M??""}})),Re.connect())}function re(){if(n(H)===null)return;const u=()=>{if(n(H)===null)return;const O=Date.now(),M=Math.max(0,n(H)-O);B(w,M,!0),M>0?B(C,requestAnimationFrame(u),!0):(B(w,0),B(C,null))};n(C)&&cancelAnimationFrame(n(C)),B(C,requestAnimationFrame(u),!0)}function I(u){Re.send(u)}{$();const u=M=>{n(v)==="connected"&&M.preventDefault()},O=M=>{n(v)==="connected"&&M.preventDefault()};window.addEventListener("beforeunload",u),window.addEventListener("popstate",O),je(()=>{window.removeEventListener("beforeunload",u),window.removeEventListener("popstate",O),n(C)&&cancelAnimationFrame(n(C)),j(),q()})}var A=_a();gt(u=>{dt.title="aiwolf-nlp-viewer"});var K=a(A);Zr(K,{});var ne=i(K,2);{var ie=u=>{var O=va(),M=z(O),G=a(M);Lr(G,{get role(){return n(te)},get profile(){return n(ee)},get request(){return n(J)},get info(){return n(h)},get mediumResults(){return n(k)},get divineResults(){return n(F)},get executedAgents(){return n(x)},get attackedAgents(){return n(p)}});var Z=i(G,2);const Q=Oe(()=>{var c;return Object.keys(((c=n(h))==null?void 0:c.status_map)??{})});lt(Z,{header:"トーク履歴",get talks(){return n(D)},get agents(){return n(Q)}});var y=i(Z,2);{var E=c=>{const m=Oe(()=>{var l;return Object.keys(((l=n(h))==null?void 0:l.status_map)??{})});lt(c,{header:"囁き履歴",get talks(){return n(L)},get agents(){return n(m)}})};N(y,c=>{n(te)===mt.WEREWOLF&&c(E)})}r(M);var R=i(M,2);{var d=c=>{fr(c,{get remain(){return n(w)},get setting(){return n(f)},get request(){return n(J)},get info(){return n(h)},onSendMessage:I})};N(R,c=>{n(w)!==null&&c(d)})}s(u,O)},W=(u,O)=>{{var M=Z=>{var Q=ua();s(Z,Q)},G=Z=>{var Q=fa();s(Z,Q)};N(u,Z=>{var Q;(Q=n(o))!=null&&Q.display.largeScale?Z(M):Z(G,!1)},O)}};N(ne,u=>{n(h)!==null?u(ie):u(W,!1)})}r(A),s(t,A),De()}export{Da as component};
