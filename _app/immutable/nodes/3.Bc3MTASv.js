var _t=Object.defineProperty;var ft=(t,e,o)=>e in t?_t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var Ge=(t,e,o)=>ft(t,typeof e!="symbol"?e+"":e,o);import{t as _,a as l,c as xe}from"../chunks/Bv48rMI7.js";import{e as qe,u as dt,p as Ne,h as gt,a9 as B,k as n,aJ as ie,c as r,r as a,a as je,f as Y,s as i,n as de,aL as Ie,t as V,ab as Te,$ as mt}from"../chunks/BLD2HZBz.js";import{h as xt}from"../chunks/CiEWJ2Hx.js";import{i as E}from"../chunks/ChEpjkx1.js";import{w as vt,o as Ke,a as Le}from"../chunks/Bvk-F0ob.js";import{p as bt}from"../chunks/BzhVg_5d.js";import{s as Fe,a as Re,b as Se,c as He,S as Pe,d as Ae,R as pt}from"../chunks/DaFWf78t.js";import{r as we,a as se,s as pe,b as Me,c as Ze}from"../chunks/D1tQ9SG9.js";import{d as ut,s as f}from"../chunks/Db1UEeB2.js";import{e as ge,i as me}from"../chunks/Be071FMb.js";import{b as $e}from"../chunks/DqJKPpg3.js";import{b as Be}from"../chunks/DM_AG1PP.js";import{s as Ue}from"../chunks/veg5TpEX.js";import{b as et}from"../chunks/BN59vk0k.js";function tt(t,e,o){qe(()=>{var u=dt(()=>e(t,o==null?void 0:o())||{});if(u!=null&&u.destroy)return()=>u.destroy()})}class Ye{static fromJson(e){return At(JSON.parse(e),Je("AgentSettings"))}static toJson(e){return JSON.stringify(It(e,Je("AgentSettings")),null,2)}}function ye(t,e,o,u=""){const U=ze(t),z=u?` on ${u}`:"",oe=o?` for key "${o}"`:"";throw Error(`Invalid value${oe}${z}. Expected ${U} but got ${JSON.stringify(e)}`)}function ze(t){return Array.isArray(t)?t.length===2&&t[0]===void 0?`an optional ${ze(t[1])}`:`one of [${t.map(e=>ze(e)).join(", ")}]`:typeof t=="object"&&t.literal!==void 0?t.literal:typeof t}function ht(t){if(t.jsonToJS===void 0){const e={};t.props.forEach(o=>e[o.json]={key:o.js,typ:o.typ}),t.jsonToJS=e}return t.jsonToJS}function yt(t){if(t.jsToJSON===void 0){const e={};t.props.forEach(o=>e[o.js]={key:o.json,typ:o.typ}),t.jsToJSON=e}return t.jsToJSON}function Ee(t,e,o,u="",U=""){function z(v,R){return typeof v==typeof R?R:ye(v,R,u,U)}function oe(v,R){const F=v.length;for(let I=0;I<F;I++){const N=v[I];try{return Ee(R,N,o)}catch{}}return ye(v,R,u,U)}function ne(v,R){return v.indexOf(R)!==-1?R:ye(v.map(F=>Ve(F)),R,u,U)}function W(v,R){return Array.isArray(R)?R.map(F=>Ee(F,v,o)):ye(Ve("array"),R,u,U)}function b(v){if(v===null)return null;const R=new Date(v);return isNaN(R.valueOf())?ye(Ve("Date"),v,u,U):R}function A(v,R,F){if(F===null||typeof F!="object"||Array.isArray(F))return ye(Ve(L||"object"),F,u,U);const I={};return Object.getOwnPropertyNames(v).forEach(N=>{const h=v[N],T=Object.prototype.hasOwnProperty.call(F,N)?F[N]:void 0;I[h.key]=Ee(T,h.typ,o,N,L)}),Object.getOwnPropertyNames(F).forEach(N=>{Object.prototype.hasOwnProperty.call(v,N)||(I[N]=Ee(F[N],R,o,N,L))}),I}if(e==="any")return t;if(e===null)return t===null?t:ye(e,t,u,U);if(e===!1)return ye(e,t,u,U);let L;for(;typeof e=="object"&&e.ref!==void 0;)L=e.ref,e=wt[e.ref];return Array.isArray(e)?ne(e,t):typeof e=="object"?e.hasOwnProperty("unionMembers")?oe(e.unionMembers,t):e.hasOwnProperty("arrayItems")?W(e.arrayItems,t):e.hasOwnProperty("props")?A(o(e),e.additional,t):ye(e,t,u,U):e===Date&&typeof t!="number"?b(t):z(e,t)}function At(t,e){return Ee(t,e,ht)}function It(t,e){return Ee(t,e,yt)}function Ve(t){return{literal:t}}function We(t,e){return{props:t,additional:e}}function Je(t){return{ref:t}}const wt={AgentSettings:We([{json:"connection",js:"connection",typ:Je("Connection")},{json:"team",js:"team",typ:""},{json:"display",js:"display",typ:Je("Display")}],!1),Connection:We([{json:"url",js:"url",typ:""},{json:"token",js:"token",typ:""}],!1),Display:We([{json:"largeScale",js:"largeScale",typ:!0}],!1)},at={connection:{url:"ws://localhost:8080/ws",token:""},team:"aiwolf-nlp-viewer",display:{largeScale:!1}};function Tt(){const t=localStorage.getItem("agent-settings");if(t)try{return Ye.fromJson(t)}catch(e){console.error(e)}return localStorage.setItem("agent-settings",Ye.toJson(at)),at}const he=vt(Tt());he.subscribe(t=>{localStorage.setItem("agent-settings",Ye.toJson(t))});var ue=(t=>(t.NAME="NAME",t.TALK="TALK",t.WHISPER="WHISPER",t.VOTE="VOTE",t.DIVINE="DIVINE",t.GUARD="GUARD",t.ATTACK="ATTACK",t.INITIALIZE="INITIALIZE",t.DAILY_INITIALIZE="DAILY_INITIALIZE",t.DAILY_FINISH="DAILY_FINISH",t.FINISH="FINISH",t))(ue||{});const Oe={NAME:"名前",TALK:"トーク",WHISPER:"囁き",VOTE:"投票",DIVINE:"占い",GUARD:"護衛",ATTACK:"襲撃",INITIALIZE:"ゲーム開始",DAILY_INITIALIZE:"昼開始",DAILY_FINISH:"昼終了",FINISH:"ゲーム終了"},Qe={ミナト:"/images/male/01.png",タクミ:"/images/male/02.png",ケンジ:"/images/male/03.png",リュウジ:"/images/male/04.png",ダイスケ:"/images/male/05.png",シオン:"/images/male/06.png",ベンジャミン:"/images/male/07.png",トシオ:"/images/male/08.png",ジョナサン:"/images/male/09.png",シュンイチ:"/images/male/10.png",ジョージ:"/images/male/11.png",セルヴァス:"/images/male/12.png",サクラ:"/images/female/01.png",リン:"/images/female/02.png",ユミ:"/images/female/03.png",メイ:"/images/female/04.png",ミサキ:"/images/female/05.png",ミオ:"/images/female/06.png",ミヅキ:"/images/female/07.png",ミナコ:"/images/female/08.png",アスカ:"/images/female/09.png",ミドリ:"/images/female/10.png",ヴィクトリア:"/images/female/11.png",シズエ:"/images/female/12.png"};function kt(){const{subscribe:t,update:e}=vt({status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]});let o=null,u=null,U=null,z=null;he.subscribe(b=>{u=b});function oe(){o&&(o.close(),o=null,e(b=>({...b,status:"disconnected"}))),z&&(z.clear(),z=null)}function ne(){if(!u)return;o&&e(A=>({...A,status:"disconnected",deadline:null,entries:[],agent:null,role:null,profile:null,request:null,info:null,mediumResults:[],divineResults:[],setting:null,talkHistory:[],whisperHistory:[],executedAgents:[],attackedAgents:[]})),e(A=>({...A,status:"connecting"}));const b=new URL(u.connection.url);u.connection.token&&b.searchParams.set("token",u.connection.token),o=new WebSocket(b),o.onopen=()=>{e(A=>({...A,status:"connected"}))},o.onclose=()=>{oe()},o.onerror=()=>{oe()},o.onmessage=A=>{try{const L=Date.now(),v=JSON.parse(A.data);switch(e(R=>{const F=R.entries.slice();F.push(v);const I={...R,entries:F,request:v.request};if(v.info){if(I.info=v.info,v.info.medium_result){const N=v.info.medium_result;I.mediumResults.findIndex(h=>h.day===N.day&&h.agent===N.agent)<0&&I.mediumResults.push(v.info.medium_result)}if(v.info.divine_result){const N=v.info.divine_result;I.divineResults.findIndex(h=>h.day===N.day&&h.agent===N.agent)<0&&I.divineResults.push(v.info.divine_result)}v.info.executed_agent&&I.executedAgents.push(v.info.executed_agent),v.info.attacked_agent&&I.attackedAgents.push(v.info.attacked_agent)}return v.setting&&(I.setting=v.setting,U=v.setting.timeout.action),v.talk_history&&I.talkHistory.push(...v.talk_history),v.whisper_history&&I.whisperHistory.push(...v.whisper_history),v.request===ue.INITIALIZE&&I.info&&(I.agent=I.info.agent,I.role=I.info.role_map[I.info.agent],I.profile=I.info.profile||null),I}),v.request){case ue.NAME:W((u==null?void 0:u.team)||"viewer"+Math.floor(Math.random()*1e3));break;case ue.TALK:case ue.WHISPER:case ue.VOTE:case ue.DIVINE:case ue.GUARD:case ue.ATTACK:z&&z.clear(),z=new St(()=>{W("TIMEOUT")},new Date(L+(U??6e4))),e(R=>({...R,deadline:(z==null?void 0:z.deadline())??null}));break;case ue.FINISH:oe();break}}catch(L){console.error("Failed to parse message:",L)}}}function W(b){if(z&&(z.clear(),z=null,e(A=>({...A,deadline:null}))),o&&o.readyState===WebSocket.OPEN)try{o.send(b),e(A=>{const L=A.entries.slice();return L.push(b),{...A,entries:L}})}catch(A){console.error("Failed to send message:",A)}}return{subscribe:t,connect:ne,disconnect:oe,send:W}}const De=kt();class St{constructor(e,o){Ge(this,"timeout");Ge(this,"_deadline");this.timeout=setTimeout(e,o.getTime()-new Date().getTime()),this._deadline=o}deadline(){return this._deadline}clear(){clearTimeout(this.timeout)}}var rt;(function(t){t[t.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",t[t.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",t[t.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",t[t.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",t[t.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",t[t.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",t[t.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",t[t.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",t[t.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",t[t.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",t[t.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",t[t.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",t[t.TAGS_START=917504]="TAGS_START",t[t.TAGS_END=917631]="TAGS_END",t[t.ZWJ=8205]="ZWJ"})(rt||(rt={}));const Rt=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var nt;function it(t){if(typeof t!="string")throw new TypeError("string cannot be undefined or null");const e=[];let o=0,u=0;for(;o<t.length;)u+=Et(o+u,t),Ct(t[o+u])&&u++,jt(t[o+u])&&u++,Mt(t[o+u])&&u++,Ft(t[o+u])?u++:(e.push(t.substring(o,o+u)),o+=u,u=0);return e}function Et(t,e){const o=e[t];if(!Ot(o)||t===e.length-1)return 1;const u=o+e[t+1];let U=e.substring(t+2,t+5);return ot(u)&&ot(U)?4:Dt(u)&&Lt(U)?e.slice(t).indexOf(String.fromCodePoint(917631))+2:Nt(U)?4:2}function Ot(t){return t&&ke(t[0].charCodeAt(0),55296,56319)}function ot(t){return ke(Xe(t),127462,127487)}function Dt(t){return ke(Xe(t),127988,127988)}function Nt(t){return ke(Xe(t),127995,127999)}function jt(t){return typeof t=="string"&&ke(t.charCodeAt(0),65024,65039)}function Mt(t){return typeof t=="string"&&ke(t.charCodeAt(0),8400,8447)}function Lt(t){const e=t.codePointAt(0);return typeof t=="string"&&typeof e=="number"&&ke(e,917504,917631)}function Ct(t){return typeof t=="string"&&Rt.includes(t.charCodeAt(0))}function Ft(t){return typeof t=="string"&&t.charCodeAt(0)===8205}function Xe(t){return(t.charCodeAt(0)-55296<<10)+(t.charCodeAt(1)-56320)+65536}function ke(t,e,o){return t>=e&&t<=o}(function(t){t[t.unit_1=1]="unit_1",t[t.unit_2=2]="unit_2",t[t.unit_4=4]="unit_4"})(nt||(nt={}));function lt(t,e,o){t.key==="Enter"&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.onSendMessage(n(o)))}var Ht=_('<span aria-live="polite"> </span>m',1),Pt=(t,e,o)=>e(o()),Vt=_('<button class="btn btn-xl"> </button>'),Jt=(t,e)=>e("Skip"),Kt=_('<button class="btn btn-xl" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),Gt=(t,e)=>e("Over"),Ut=_('<!> <button class="btn btn-xl" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),Wt=_("<option></option>"),qt=_("<option></option>"),Zt=_("<!> <option></option>",1),Bt=_('<pre class="text-2xl"> </pre>'),Yt=_('<pre class="text-2xl bg-error text-error-content"> </pre>'),zt=(t,e,o)=>e.onSendMessage(n(o)),Qt=_('<div class="flex gap-2 items-center px-4 pt-4 pb-4 overflow-x-auto"><span class="countdown font-mono text-3xl"><!> <span aria-live="polite"> </span>s</span> <span class="bg-primary text-primary-content w-full py-2 text-3xl font-bold text-nowrap text-center"> </span></div> <div class="flex gap-2 items-center px-4 pt-2 pb-4 overflow-x-auto"><!> <input type="text" class="input input-xl min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn btn-xl" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),Xt=_('<span aria-live="polite"> </span>m',1),$t=(t,e,o)=>e(o()),ea=_('<button class="btn"> </button>'),ta=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!>',1),aa=(t,e)=>e("Skip"),ra=_('<button class="btn" aria-label="Skip"><iconify-icon></iconify-icon> SKIP</button>',2),na=(t,e)=>e("Over"),ia=_('<span class="bg-primary text-primary-content text-lg font-bold text-nowrap"> </span> <!> <button class="btn" aria-label="Over"><iconify-icon></iconify-icon> OVER</button>',3),oa=_("<option></option>"),la=_("<option></option>"),sa=_("<!> <option></option>",1),ca=_('<pre class="text-md"> </pre>'),va=_('<pre class="text-md bg-error text-error-content"> </pre>'),ua=(t,e,o)=>e.onSendMessage(n(o)),_a=_('<div class="flex gap-2 items-center p-4 overflow-x-auto"><span class="countdown font-mono text-2xl"><!> <span aria-live="polite"> </span>s</span> <!> <input type="text" class="input min-w-64 flex-1" list="suggests"> <datalist id="suggests"><!></datalist> <!> <button class="btn" aria-label="Send"><iconify-icon></iconify-icon> 送信</button></div> <div class="-mt-2 mx-4 mb-2"><progress class="progress" max="100"></progress></div>',3),fa=_('<form class="flex-none bg-base-200" data-sveltekit-keepfocus=""><!></form>');function da(t,e){Ne(e,!0);let o=ie(""),u=ie(0),U=ie(void 0),z=ie(null);const oe=Ie(()=>{var h;return e.remain!==null?e.remain/(((h=e.setting)==null?void 0:h.timeout.action)??6e4)*100:0}),ne=Ie(()=>e.remain!==null?Math.floor(e.remain/6e4):0),W=Ie(()=>e.remain!==null?Math.floor(e.remain%6e4/1e3):0),b=Ie(()=>[ue.VOTE,ue.DIVINE,ue.GUARD,ue.ATTACK].includes(e.request));function A(h){var O,X;if(!e.request||!e.setting)return 0;const T=e.request===ue.TALK?e.setting.talk.max_length:e.request===ue.WHISPER?e.setting.whisper.max_length:null;if(!T)return 0;let m=T.base_length??0;if(m+=((O=e.info)==null?void 0:O.remain_length)??0,T.mention_length){for(const te in((X=e.info)==null?void 0:X.status_map)??{})if(h.indexOf("@"+te)!==-1){m+=T.mention_length,m+=it("@"+te).length;break}}return T.per_talk&&(m=Math.min(m,T.per_talk)),m-=it(h).length,m}gt(()=>{B(u,A(n(o)),!0)}),Ke(()=>{const h=he.subscribe(T=>{B(U,T,!0)});return()=>{h()}});function L(h){var T;B(o,h,!0),(T=n(z))==null||T.focus()}function v(h){h.focus()}var R=fa(),F=r(R);{var I=h=>{var T=Qt(),m=Y(T),O=r(m),X=r(O);{var te=s=>{var d=Ht(),x=Y(d),D=r(x,!0);a(x),de(),V(P=>{Fe(x,`--value:${n(ne)??""};`),pe(x,"aria-label",P),f(D,n(ne))},[()=>n(ne).toString()]),l(s,d)};E(X,s=>{e.remain&&e.remain>6e4&&s(te)})}var J=i(X,2),Z=r(J,!0);a(J),de(),a(O);var K=i(O,2),$=r(K,!0);a(K),a(m);var ee=i(m,2),le=r(ee);{var ce=s=>{var d=xe(),x=Y(d);ge(x,17,()=>{var D;return Object.entries(((D=e.info)==null?void 0:D.status_map)??{})},me,(D,P)=>{let ae=()=>n(P)[0],G=()=>n(P)[1];var re=xe(),fe=Y(re);{var be=_e=>{var ve=Vt();ve.__click=[Pt,L,ae];var Ce=r(ve,!0);a(ve),V(()=>f(Ce,ae())),l(_e,ve)};E(fe,_e=>{var ve;G()===Re.ALIVE&&ae()!==((ve=e.info)==null?void 0:ve.agent)&&_e(be)})}l(D,re)}),l(s,d)},p=s=>{var d=Ut(),x=Y(d);{var D=G=>{var re=Kt();re.__click=[Jt,L];var fe=r(re);se(fe,"icon","mdi:arrow-u-down-right-bold"),de(),a(re),l(G,re)};E(x,G=>{var re;(((re=e.info)==null?void 0:re.remain_skip)??0)>0&&G(D)})}var P=i(x,2);P.__click=[Gt,L];var ae=r(P);se(ae,"icon","mdi:skip-forward"),de(),a(P),l(s,d)};E(le,s=>{n(b)?s(ce):s(p,!1)})}var k=i(le,2);we(k),k.__keydown=[lt,e,o],qe(()=>$e(k,()=>n(o),s=>B(o,s))),tt(k,s=>v==null?void 0:v(s)),Be(k,s=>B(z,s),()=>n(z));var S=i(k,2),H=r(S);{var q=s=>{var d=xe(),x=Y(d);ge(x,17,()=>{var D;return Object.entries(((D=e.info)==null?void 0:D.status_map)??{})},me,(D,P)=>{let ae=()=>n(P)[0],G=()=>n(P)[1];var re=xe(),fe=Y(re);{var be=_e=>{var ve=Wt(),Ce={};V(()=>{Ce!==(Ce=ae())&&(ve.value=(ve.__value=ae())??"")}),l(_e,ve)};E(fe,_e=>{var ve;G()===Re.ALIVE&&ae()!==((ve=e.info)==null?void 0:ve.agent)&&_e(be)})}l(D,re)}),l(s,d)},y=s=>{var d=Zt(),x=Y(d);{var D=ae=>{var G=qt();G.value=G.__value="Skip",l(ae,G)};E(x,ae=>{var G;(((G=e.info)==null?void 0:G.remain_skip)??0)>0&&ae(D)})}var P=i(x,2);P.value=P.__value="Over",l(s,d)};E(H,s=>{n(b)?s(q):s(y,!1)})}a(S);var Q=i(S,2);{var C=s=>{var d=Bt(),x=r(d);a(d),V(()=>f(x,`残り${n(u)??""}文字`)),l(s,d)},j=s=>{var d=Yt(),x=r(d);a(d),V(()=>f(x,`${n(u)*-1}文字超過`)),l(s,d)};E(Q,s=>{n(u)>=0?s(C):s(j,!1)})}var w=i(Q,2);w.__click=[zt,e,o];var c=r(w);se(c,"icon","mdi:send"),de(),a(w),a(ee);var g=i(ee,2),M=r(g);a(g),V(s=>{Fe(J,`--value:${n(W)??""};`),pe(J,"aria-label",s),f(Z,n(W)),f($,n(b)?`${Oe[e.request]}対象を選択してください`:`${Oe[e.request]}内容を入力してください`),Me(M,n(oe))},[()=>n(W).toString()]),l(h,T)},N=h=>{var T=_a(),m=Y(T),O=r(m),X=r(O);{var te=c=>{var g=Xt(),M=Y(g),s=r(M,!0);a(M),de(),V((d,x,D)=>{Fe(M,`--value:${d??""};`),pe(M,"aria-label",x),f(s,D)},[()=>Math.floor(e.remain/6e4),()=>Math.floor(e.remain/6e4).toString(),()=>Math.floor(e.remain/6e4)]),l(c,g)};E(X,c=>{e.remain&&e.remain>6e4&&c(te)})}var J=i(X,2),Z=r(J,!0);a(J),de(),a(O);var K=i(O,2);{var $=c=>{var g=ta(),M=Y(g),s=r(M);a(M);var d=i(M,2);ge(d,17,()=>{var x;return Object.entries(((x=e.info)==null?void 0:x.status_map)??{})},me,(x,D)=>{let P=()=>n(D)[0],ae=()=>n(D)[1];var G=xe(),re=Y(G);{var fe=be=>{var _e=ea();_e.__click=[$t,L,P];var ve=r(_e,!0);a(_e),V(()=>f(ve,P())),l(be,_e)};E(re,be=>{var _e;ae()===Re.ALIVE&&P()!==((_e=e.info)==null?void 0:_e.agent)&&be(fe)})}l(x,G)}),V(()=>f(s,`${Oe[e.request]??""}対象を選択してください`)),l(c,g)},ee=c=>{var g=ia(),M=Y(g),s=r(M);a(M);var d=i(M,2);{var x=ae=>{var G=ra();G.__click=[aa,L];var re=r(G);se(re,"icon","mdi:arrow-u-down-right-bold"),de(),a(G),l(ae,G)};E(d,ae=>{var G;(((G=e.info)==null?void 0:G.remain_skip)??0)>0&&ae(x)})}var D=i(d,2);D.__click=[na,L];var P=r(D);se(P,"icon","mdi:skip-forward"),de(),a(D),V(()=>f(s,`${Oe[e.request]??""}内容を入力してください`)),l(c,g)};E(K,c=>{n(b)?c($):c(ee,!1)})}var le=i(K,2);we(le),le.__keydown=[lt,e,o],qe(()=>$e(le,()=>n(o),c=>B(o,c))),tt(le,c=>v==null?void 0:v(c)),Be(le,c=>B(z,c),()=>n(z));var ce=i(le,2),p=r(ce);{var k=c=>{var g=xe(),M=Y(g);ge(M,17,()=>{var s;return Object.entries(((s=e.info)==null?void 0:s.status_map)??{})},me,(s,d)=>{let x=()=>n(d)[0],D=()=>n(d)[1];var P=xe(),ae=Y(P);{var G=re=>{var fe=oa(),be={};V(()=>{be!==(be=x())&&(fe.value=(fe.__value=x())??"")}),l(re,fe)};E(ae,re=>{var fe;D()===Re.ALIVE&&x()!==((fe=e.info)==null?void 0:fe.agent)&&re(G)})}l(s,P)}),l(c,g)},S=c=>{var g=sa(),M=Y(g);{var s=x=>{var D=la();D.value=D.__value="Skip",l(x,D)};E(M,x=>{var D;(((D=e.info)==null?void 0:D.remain_skip)??0)>0&&x(s)})}var d=i(M,2);d.value=d.__value="Over",l(c,g)};E(p,c=>{n(b)?c(k):c(S,!1)})}a(ce);var H=i(ce,2);{var q=c=>{var g=ca(),M=r(g);a(g),V(()=>f(M,`残り${n(u)??""}文字`)),l(c,g)},y=c=>{var g=va(),M=r(g);a(g),V(()=>f(M,`${n(u)*-1}文字超過`)),l(c,g)};E(H,c=>{n(u)>=0?c(q):c(y,!1)})}var Q=i(H,2);Q.__click=[ua,e,o];var C=r(Q);se(C,"icon","mdi:send"),de(),a(Q),a(m);var j=i(m,2),w=r(j);a(j),V((c,g,M)=>{Fe(J,`--value:${c??""};`),pe(J,"aria-label",g),f(Z,M),Me(w,n(oe))},[()=>Math.floor((e.remain?e.remain%6e4:0)/1e3),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3).toString(),()=>Math.floor((e.remain?e.remain%6e4:0)/1e3)]),l(h,T)};E(F,h=>{var T;(T=n(U))!=null&&T.display.largeScale?h(I):h(N,!1)})}a(R),l(t,R),je()}ut(["click","keydown"]);var ga=_('<pre class="bg-primary text-primary-content text-3xl font-bold text-center my-2"> </pre>'),ma=_('<pre class="text-md text-pretty break-all my-2"> </pre>'),xa=_('<div class="bg-info text-success-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),ba=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),pa=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),ha=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),ya=_('<h2 class="text-2xl font-bold text-center my-2">霊能結果</h2> <!>',1),Aa=_('<div class="bg-error text-error-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),Ia=_('<div class="bg-success text-info-content flex flex-row gap-2 px-2"><pre class="text-2xl font-bold"> </pre> <pre class="text-2xl"> </pre> <pre class="text-2xl font-bold ml-auto"> </pre></div>'),wa=_('<h2 class="text-2xl font-bold text-center my-2">占い結果</h2> <!>',1),Ta=_('<div class="grow overflow-y-auto pr-4"><pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl font-bold text-center"> </pre> <pre class="text-3xl text-center my-2"> </pre> <!> <!> <!> <!> <!></div>'),ka=_('<pre class="text-lg text-center"> </pre>'),Sa=_('<h2 class="text-lg font-bold text-center">プロフィール</h2> <pre class="text-md text-pretty break-all"> </pre>',1),Ra=_('<div class="bg-info text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ea=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Oa=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Da=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Na=_('<h2 class="text-lg font-bold pt-2">霊能結果</h2> <!>',1),ja=_('<div class="bg-error text-error-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),Ma=_('<div class="bg-success text-info-content flex flex-row gap-2"><pre class="text-lg"> </pre> <pre class="text-lg"> </pre> <pre class="text-lg ml-auto"> </pre></div>'),La=_('<h2 class="text-lg font-bold pt-2">占い結果</h2> <!>',1),Ca=_('<h2 class="text-xl font-bold pb-2">エージェント</h2> <div class="grow overflow-y-auto pr-4"><div class="flex justify-around"><div><h2 class="text-lg font-bold text-center">名前</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">役職</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">日数</h2> <pre class="text-lg text-center"> </pre></div> <div><h2 class="text-lg font-bold text-center">リクエスト</h2> <!></div></div> <!> <h2 class="text-lg font-bold pt-2">ステータス</h2> <!> <!> <!></div>',1),Fa=_('<div class="flex-[0_0_400px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function Ha(t,e){Ne(e,!0);let o=ie(void 0);Ke(()=>{const W=he.subscribe(b=>{B(o,b,!0)});Le(W)});var u=Fa(),U=r(u),z=r(U);{var oe=W=>{var b=Ta(),A=r(b),L=r(A,!0);a(A);var v=i(A,2),R=r(v,!0);a(v);var F=i(v,2),I=r(F,!0);a(F);var N=i(F,2);{var h=K=>{var $=ga(),ee=r($,!0);a($),V(()=>f(ee,Oe[e.request])),l(K,$)};E(N,K=>{e.request&&K(h)})}var T=i(N,2);{var m=K=>{var $=ma(),ee=r($,!0);a($),V(()=>f(ee,e.profile)),l(K,$)};E(T,K=>{e.profile&&K(m)})}var O=i(T,2);ge(O,17,()=>Object.entries(e.info.status_map??{}),me,(K,$)=>{let ee=()=>n($)[0],le=()=>n($)[1];var ce=xe(),p=Y(ce);{var k=H=>{var q=xa(),y=r(q),Q=r(y,!0);a(y);var C=i(y,2),j=r(C,!0);a(C);var w=i(C,2),c=r(w,!0);a(w),a(q),V(()=>{f(Q,ee()),f(j,Se[(e.info.role_map??{})[ee()]]??""),f(c,He[le()])}),l(H,q)},S=H=>{var q=ba(),y=r(q),Q=r(y,!0);a(y);var C=i(y,2),j=r(C,!0);a(C);var w=i(C,2),c=r(w);a(w),a(q),V(g=>{f(Q,ee()),f(j,Se[(e.info.role_map??{})[ee()]]??""),f(c,`${He[le()]??""}${g??""}`)},[()=>e.executedAgents.includes(ee())?" (追放)":e.attackedAgents.includes(ee())?" (襲撃)":""]),l(H,q)};E(p,H=>{le()===Re.ALIVE?H(k):H(S,!1)})}l(K,ce)});var X=i(O,2);{var te=K=>{var $=ya(),ee=i(Y($),2);ge(ee,17,()=>e.mediumResults,me,(le,ce)=>{let p=()=>n(ce).day,k=()=>n(ce).target,S=()=>n(ce).result;var H=xe(),q=Y(H);{var y=C=>{var j=pa(),w=r(j),c=r(w,!0);a(w);var g=i(w,2),M=r(g);a(g);var s=i(g,2),d=r(s,!0);a(s),a(j),V(()=>{f(c,k()),f(M,`(${p()??""}日目)`),f(d,Ae[S()])}),l(C,j)},Q=C=>{var j=ha(),w=r(j),c=r(w,!0);a(w);var g=i(w,2),M=r(g);a(g);var s=i(g,2),d=r(s,!0);a(s),a(j),V(()=>{f(c,k()),f(M,`(${p()??""}日目)`),f(d,Ae[S()])}),l(C,j)};E(q,C=>{S()!==Pe.HUMAN?C(y):C(Q,!1)})}l(le,H)}),l(K,$)};E(X,K=>{e.mediumResults.length>0&&K(te)})}var J=i(X,2);{var Z=K=>{var $=wa(),ee=i(Y($),2);ge(ee,17,()=>e.divineResults,me,(le,ce)=>{let p=()=>n(ce).day,k=()=>n(ce).target,S=()=>n(ce).result;var H=xe(),q=Y(H);{var y=C=>{var j=Aa(),w=r(j),c=r(w,!0);a(w);var g=i(w,2),M=r(g);a(g);var s=i(g,2),d=r(s,!0);a(s),a(j),V(()=>{f(c,k()),f(M,`(${p()??""}日目)`),f(d,Ae[S()])}),l(C,j)},Q=C=>{var j=Ia(),w=r(j),c=r(w,!0);a(w);var g=i(w,2),M=r(g);a(g);var s=i(g,2),d=r(s,!0);a(s),a(j),V(()=>{f(c,k()),f(M,`(${p()??""}日目)`),f(d,Ae[S()])}),l(C,j)};E(q,C=>{S()!==Pe.HUMAN?C(y):C(Q,!1)})}l(le,H)}),l(K,$)};E(J,K=>{e.divineResults.length>0&&K(Z)})}a(b),V(()=>{f(L,e.agent?e.agent:"ゲーム外"),f(R,e.role?Se[e.role]:"ゲーム外"),f(I,e.info?e.info.day+"日目":"ゲーム外")}),l(W,b)},ne=W=>{var b=Ca(),A=i(Y(b),2),L=r(A),v=r(L),R=i(r(v),2),F=r(R,!0);a(R),a(v);var I=i(v,2),N=i(r(I),2),h=r(N,!0);a(N),a(I);var T=i(I,2),m=i(r(T),2),O=r(m,!0);a(m),a(T);var X=i(T,2),te=i(r(X),2);{var J=k=>{var S=ka(),H=r(S,!0);a(S),V(()=>f(H,Oe[e.request])),l(k,S)};E(te,k=>{e.request&&k(J)})}a(X),a(L);var Z=i(L,2);{var K=k=>{var S=Sa(),H=i(Y(S),2),q=r(H,!0);a(H),V(()=>f(q,e.profile)),l(k,S)};E(Z,k=>{e.profile&&k(K)})}var $=i(Z,4);ge($,17,()=>Object.entries(e.info.status_map??{}),me,(k,S)=>{let H=()=>n(S)[0],q=()=>n(S)[1];var y=xe(),Q=Y(y);{var C=w=>{var c=Ra(),g=r(c),M=r(g,!0);a(g);var s=i(g,2),d=r(s,!0);a(s);var x=i(s,2),D=r(x,!0);a(x),a(c),V(()=>{f(M,H()),f(d,Se[(e.info.role_map??{})[H()]]??""),f(D,He[q()])}),l(w,c)},j=w=>{var c=Ea(),g=r(c),M=r(g,!0);a(g);var s=i(g,2),d=r(s,!0);a(s);var x=i(s,2),D=r(x);a(x),a(c),V(P=>{f(M,H()),f(d,Se[(e.info.role_map??{})[H()]]??""),f(D,`${He[q()]??""}${P??""}`)},[()=>e.executedAgents.includes(H())?" (追放)":e.attackedAgents.includes(H())?" (襲撃)":""]),l(w,c)};E(Q,w=>{q()===Re.ALIVE?w(C):w(j,!1)})}l(k,y)});var ee=i($,2);{var le=k=>{var S=Na(),H=i(Y(S),2);ge(H,17,()=>e.mediumResults,me,(q,y)=>{let Q=()=>n(y).day,C=()=>n(y).target,j=()=>n(y).result;var w=xe(),c=Y(w);{var g=s=>{var d=Oa(),x=r(d),D=r(x,!0);a(x);var P=i(x,2),ae=r(P);a(P);var G=i(P,2),re=r(G,!0);a(G),a(d),V(()=>{f(D,C()),f(ae,`(${Q()??""}日目)`),f(re,Ae[j()])}),l(s,d)},M=s=>{var d=Da(),x=r(d),D=r(x,!0);a(x);var P=i(x,2),ae=r(P);a(P);var G=i(P,2),re=r(G,!0);a(G),a(d),V(()=>{f(D,C()),f(ae,`(${Q()??""}日目)`),f(re,Ae[j()])}),l(s,d)};E(c,s=>{j()!==Pe.HUMAN?s(g):s(M,!1)})}l(q,w)}),l(k,S)};E(ee,k=>{e.mediumResults.length>0&&k(le)})}var ce=i(ee,2);{var p=k=>{var S=La(),H=i(Y(S),2);ge(H,17,()=>e.divineResults,me,(q,y)=>{let Q=()=>n(y).day,C=()=>n(y).target,j=()=>n(y).result;var w=xe(),c=Y(w);{var g=s=>{var d=ja(),x=r(d),D=r(x,!0);a(x);var P=i(x,2),ae=r(P);a(P);var G=i(P,2),re=r(G,!0);a(G),a(d),V(()=>{f(D,C()),f(ae,`(${Q()??""}日目)`),f(re,Ae[j()])}),l(s,d)},M=s=>{var d=Ma(),x=r(d),D=r(x,!0);a(x);var P=i(x,2),ae=r(P);a(P);var G=i(P,2),re=r(G,!0);a(G),a(d),V(()=>{f(D,C()),f(ae,`(${Q()??""}日目)`),f(re,Ae[j()])}),l(s,d)};E(c,s=>{j()!==Pe.HUMAN?s(g):s(M,!1)})}l(q,w)}),l(k,S)};E(ce,k=>{e.divineResults.length>0&&k(p)})}a(A),V(()=>{f(F,e.agent?e.agent:"ゲーム外"),f(h,e.role?Se[e.role]:"ゲーム外"),f(O,e.info?e.info.day+"日目":"ゲーム外")}),l(W,b)};E(z,W=>{var b;(b=n(o))!=null&&b.display.largeScale?W(oe):W(ne,!1)})}a(U),a(u),l(t,u),je()}function Pa(){De.connect()}function Va(){De.disconnect()}var Ja=_('<div class="status status-success animate-ping"></div> <div class="status status-success"></div>',1),Ka=_('<div class="status status-warning animate-ping"></div> <div class="status status-warning"></div>',1),Ga=_('<div class="status status-error"></div>'),Ua=(t,e)=>e("connection.url",t.currentTarget.value),Wa=(t,e)=>e("connection.token",t.currentTarget.value),qa=(t,e)=>e("team",t.currentTarget.value),Za=(t,e)=>e("display.largeScale",t.currentTarget.checked),Ba=_('<div class="navbar bg-base-100 flex justify-start gap-4 overflow-x-auto"><a class="text-3xl font-bold text-nowrap ml-2" href="./">aiwolf-nlp-viewer</a> <div class="ml-auto"><div class="inline-grid *:[grid-area:1/1]"><!></div></div> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="WebSocket URL"></label> <label class="input min-w-3xs w-3xs"><iconify-icon></iconify-icon> <input type="text" class="grow" placeholder="Authorization Key"> <span class="badge badge-neutral badge-xs">Optional</span></label> <button class="btn btn-info">接続</button> <button class="btn btn-error">切断</button> <button class="btn">設定</button> <dialog class="modal"><div class="modal-box"><div class="form-control my-2"><h3 class="text-lg font-bold">エージェント設定</h3> <h4 class="text-base font-bold mt-2">チーム名</h4> <label class="input min-w-3xs w-3xs my-2"><iconify-icon></iconify-icon> <input type="text" class="grow"></label> <h3 class="text-lg font-bold mt-4">表示設定</h3> <h4 class="text-base font-bold mt-2">大画面向け</h4> <label class="label cursor-pointer my-2"><span class="label-text">有効</span> <input type="checkbox" class="checkbox"></label></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog> <label class="flex items-center cursor-pointer gap-2"><iconify-icon></iconify-icon> <input type="checkbox" value="dark" class="toggle theme-controller"> <iconify-icon></iconify-icon></label></div>',2);function Ya(t,e){Ne(e,!0);let o=ie(void 0),u=ie(void 0);const U=he.subscribe(y=>{B(o,y,!0)}),z=De.subscribe(y=>{B(u,y.status,!0)});Le(()=>{U(),z()});function oe(y,Q){he.update(C=>{const j=y.split("."),w=j.pop();let c=C;for(const g of j)g&&(c=c[g]);return c[w]=Q,{...C}})}let ne;var W=Ba(),b=i(r(W),2),A=r(b),L=r(A);{var v=y=>{var Q=Ja();de(2),l(y,Q)},R=(y,Q)=>{{var C=w=>{var c=Ka();de(2),l(w,c)},j=w=>{var c=Ga();l(w,c)};E(y,w=>{n(u)==="connecting"?w(C):w(j,!1)},Q)}};E(L,y=>{n(u)==="connected"?y(v):y(R,!1)})}a(A),a(b);var F=i(b,2),I=r(F);Ue(I,1,"h-[1em] opacity-50"),se(I,"inline",!0),se(I,"icon","mdi:link");var N=i(I,2);we(N),N.__input=[Ua,oe],a(F);var h=i(F,2),T=r(h);Ue(T,1,"h-[1em] opacity-50"),se(T,"inline",!0),se(T,"icon","mdi:key");var m=i(T,2);we(m),m.__input=[Wa,oe],de(2),a(h);var O=i(h,2);O.__click=[Pa];var X=i(O,2);X.__click=[Va];var te=i(X,2);te.__click=()=>ne.showModal();var J=i(te,2),Z=r(J),K=r(Z),$=i(r(K),4),ee=r($);Ue(ee,1,"h-[1em] opacity-50"),se(ee,"inline",!0),se(ee,"icon","mdi:rename");var le=i(ee,2);we(le),le.__input=[qa,oe],a($);var ce=i($,6),p=i(r(ce),2);we(p),p.__change=[Za,oe],a(ce),a(K),a(Z),de(2),a(J),Be(J,y=>ne=y,()=>ne);var k=i(J,2),S=r(k);se(S,"inline",!0),se(S,"icon","mdi:white-balance-sunny");var H=i(S,2),q=i(H,2);se(q,"inline",!0),se(q,"icon","mdi:moon-and-stars"),a(k),a(W),V(()=>{var y,Q,C,j;Me(N,(y=n(o))==null?void 0:y.connection.url),Me(m,(Q=n(o))==null?void 0:Q.connection.token),O.disabled=n(u)!=="disconnected",X.disabled=n(u)==="disconnected",Me(le,(C=n(o))==null?void 0:C.team),Ze(p,(j=n(o))==null?void 0:j.display.largeScale)}),l(t,W),je()}ut(["input","click","change"]);var za=_("<iconify-icon></iconify-icon>",2),Qa=_("<iconify-icon></iconify-icon>",2),Xa=_('<div class="chat-bubble bg-base-100 text-xl text-pretty break-all"> </div>'),$a=_('<div class="chat-image avatar"><div class="w-20 rounded-full"><img></div></div> <pre class="chat-header text-lg"> </pre> <!> <pre class="chat-footer opacity-50 text-sm"> </pre>',1),er=_("<iconify-icon></iconify-icon>",2),tr=_("<iconify-icon></iconify-icon>",2),ar=_('<div class="chat-bubble bg-base-100 text-pretty break-all"> </div>'),rr=_('<div class="chat-image avatar"><div class="w-10 rounded-full"><img></div></div> <pre class="chat-header"> </pre> <!> <pre class="chat-footer opacity-50"> </pre>',1),nr=_('<div class="chat chat-start"><!></div>');function st(t,e){Ne(e,!0);let o=ie(void 0);Ke(()=>{const ne=he.subscribe(W=>{B(o,W,!0)});Le(ne)});var u=nr(),U=r(u);{var z=ne=>{var W=$a(),b=Y(W),A=r(b),L=r(A);a(A),a(b);var v=i(b,2),R=r(v,!0);a(v);var F=i(v,2);{var I=m=>{var O=za();se(O,"inline",!0),se(O,"icon","mdi:skip-forward"),l(m,O)},N=(m,O)=>{{var X=J=>{var Z=Qa();se(Z,"inline",!0),se(Z,"icon","mdi:arrow-u-down-right-bold"),l(J,Z)},te=J=>{var Z=Xa(),K=r(Z,!0);a(Z),V(()=>f(K,e.talk.text)),l(J,Z)};E(m,J=>{e.talk.skip?J(X):J(te,!1)},O)}};E(F,m=>{e.talk.over?m(I):m(N,!1)})}var h=i(F,2),T=r(h);a(h),V(()=>{pe(L,"src",e.isDefaultProfile?`${et}${Qe[e.talk.agent]}`:""),pe(L,"alt",e.talk.agent),f(R,e.talk.agent),f(T,`Idx: ${e.talk.idx??""}`)}),l(ne,W)},oe=ne=>{var W=rr(),b=Y(W),A=r(b),L=r(A);a(A),a(b);var v=i(b,2),R=r(v,!0);a(v);var F=i(v,2);{var I=m=>{var O=er();se(O,"inline",!0),se(O,"icon","mdi:skip-forward"),l(m,O)},N=(m,O)=>{{var X=J=>{var Z=tr();se(Z,"inline",!0),se(Z,"icon","mdi:arrow-u-down-right-bold"),l(J,Z)},te=J=>{var Z=ar(),K=r(Z,!0);a(Z),V(()=>f(K,e.talk.text)),l(J,Z)};E(m,J=>{e.talk.skip?J(X):J(te,!1)},O)}};E(F,m=>{e.talk.over?m(I):m(N,!1)})}var h=i(F,2),T=r(h);a(h),V(()=>{pe(L,"src",e.isDefaultProfile?`${et}${Qe[e.talk.agent]}`:""),pe(L,"alt",e.talk.agent),f(R,e.talk.agent),f(T,`Idx: ${e.talk.idx??""}`)}),l(ne,W)};E(U,ne=>{var W;(W=n(o))!=null&&W.display.largeScale?ne(z):ne(oe,!1)})}a(u),l(t,u),je()}var ir=_('<input type="radio" name="talk_days" class="tab text-lg font-bold"> <div class="tab-content my-4"></div>',1),or=_('<div class="tabs tabs-border"></div>'),lr=_('<h2 class="text-3xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),sr=_('<input type="radio" name="talk_days" class="tab"> <div class="tab-content my-4"></div>',1),cr=_('<div class="tabs tabs-border"></div>'),vr=_('<h2 class="text-xl font-bold pb-2"> </h2> <div class="grow overflow-y-auto pr-4"><!></div>',1),ur=_('<div class="flex-[0_0_600px] rounded-lg bg-base-200"><div class="flex flex-col h-full p-4"><!></div></div>');function ct(t,e){Ne(e,!0);let o=ie(void 0),u=e.agents.every(b=>Object.keys(Qe).includes(b));Ke(()=>{const b=he.subscribe(A=>{B(o,A,!0)});Le(b)});var U=ur(),z=r(U),oe=r(z);{var ne=b=>{var A=lr(),L=Y(A),v=r(L,!0);a(L);var R=i(L,2),F=r(R);{var I=N=>{var h=or();const T=Ie(()=>[...new Set(e.talks.map(m=>m.day))].sort((m,O)=>O-m));ge(h,21,()=>n(T),me,(m,O)=>{var X=ir(),te=Y(X);we(te);var J=i(te,2);ge(J,21,()=>e.talks.filter(Z=>Z.day===n(O)),me,(Z,K)=>{st(Z,{get talk(){return n(K)},get agents(){return e.agents},isDefaultProfile:u})}),a(J),V(()=>{Ze(te,n(O)===n(T)[0]),pe(te,"aria-label",`${n(O)}日目`)}),l(m,X)}),a(h),l(N,h)};E(F,N=>{e.talks.length>0&&N(I)})}a(R),V(()=>f(v,e.header)),l(b,A)},W=b=>{var A=vr(),L=Y(A),v=r(L,!0);a(L);var R=i(L,2),F=r(R);{var I=N=>{var h=cr();const T=Ie(()=>[...new Set(e.talks.map(m=>m.day))].sort((m,O)=>O-m));ge(h,21,()=>n(T),me,(m,O)=>{var X=sr(),te=Y(X);we(te);var J=i(te,2);ge(J,21,()=>e.talks.filter(Z=>Z.day===n(O)),me,(Z,K)=>{st(Z,{get talk(){return n(K)},get agents(){return e.agents},isDefaultProfile:u})}),a(J),V(()=>{Ze(te,n(O)===n(T)[0]),pe(te,"aria-label",`${n(O)}日目`)}),l(m,X)}),a(h),l(N,h)};E(F,N=>{e.talks.length>0&&N(I)})}a(R),V(()=>f(v,e.header)),l(b,A)};E(oe,b=>{var A;(A=n(o))!=null&&A.display.largeScale?b(ne):b(W,!1)})}a(z),a(U),l(t,U),je()}var _r=_('<div class="overflow-y-hidden flex grow overflox-x-auto gap-4 p-4"><!> <!> <!></div> <!>',1),fr=_('<div class="flex items-center justify-center h-full"><pre class="base-content text-9xl font-bold opacity-70 select-none">未接続</pre></div>'),dr=_('<div role="alert" class="alert m-4"><span class="text-lg font-bold">未接続</span></div>'),gr=_('<main class="h-screen flex flex-col bg-base-300"><!> <!></main>');function Dr(t,e){Ne(e,!0);let o=ie(void 0),u=ie(""),U=ie(null),z=ie(Te([])),oe=ie(null),ne=ie(null),W=ie(null),b=ie(null),A=ie(null),L=ie(Te([])),v=ie(Te([])),R=ie(null),F=ie(Te([])),I=ie(Te([])),N=ie(Te([])),h=ie(Te([])),T=ie(null),m=ie(null),O=he.subscribe(p=>{B(o,p,!0)}),X=De.subscribe(p=>{B(u,p.status,!0),p.deadline?(B(U,p.deadline.getTime(),!0),J()):(B(U,null),B(T,null),n(m)&&(cancelAnimationFrame(n(m)),B(m,null))),B(z,p.entries,!0),B(oe,p.agent,!0),B(ne,p.role,!0),B(W,p.profile,!0),B(b,p.request,!0),B(A,p.info,!0),B(L,p.mediumResults,!0),B(v,p.divineResults,!0),B(R,p.setting,!0),B(F,p.talkHistory,!0),B(I,p.whisperHistory,!0),B(N,p.executedAgents,!0),B(h,p.attackedAgents,!0)});function te(){const p=bt.url.searchParams,k=p.get("url"),S=p.get("token");k&&(he.update(H=>({...H,connection:{url:k??"",token:S??""}})),De.connect())}function J(){if(n(U)===null)return;const p=()=>{if(n(U)===null)return;const k=Date.now(),S=Math.max(0,n(U)-k);B(T,S,!0),S>0?B(m,requestAnimationFrame(p),!0):(B(T,0),B(m,null))};n(m)&&cancelAnimationFrame(n(m)),B(m,requestAnimationFrame(p),!0)}function Z(p){De.send(p)}{te();const p=S=>{n(u)==="connected"&&S.preventDefault()},k=S=>{n(u)==="connected"&&S.preventDefault()};window.addEventListener("beforeunload",p),window.addEventListener("popstate",k),Le(()=>{window.removeEventListener("beforeunload",p),window.removeEventListener("popstate",k),n(m)&&cancelAnimationFrame(n(m)),O(),X()})}var K=gr();xt(p=>{mt.title="aiwolf-nlp-viewer"});var $=r(K);Ya($,{});var ee=i($,2);{var le=p=>{var k=_r(),S=Y(k),H=r(S);Ha(H,{get agent(){return n(oe)},get role(){return n(ne)},get profile(){return n(W)},get request(){return n(b)},get info(){return n(A)},get mediumResults(){return n(L)},get divineResults(){return n(v)},get executedAgents(){return n(N)},get attackedAgents(){return n(h)}});var q=i(H,2);const y=Ie(()=>{var c;return Object.keys(((c=n(A))==null?void 0:c.status_map)??{})});ct(q,{header:"トーク履歴",get talks(){return n(F)},get agents(){return n(y)}});var Q=i(q,2);{var C=c=>{const g=Ie(()=>{var M;return Object.keys(((M=n(A))==null?void 0:M.status_map)??{})});ct(c,{header:"囁き履歴",get talks(){return n(I)},get agents(){return n(g)}})};E(Q,c=>{n(ne)===pt.WEREWOLF&&c(C)})}a(S);var j=i(S,2);{var w=c=>{da(c,{get remain(){return n(T)},get setting(){return n(R)},get request(){return n(b)},get info(){return n(A)},onSendMessage:Z})};E(j,c=>{n(T)!==null&&c(w)})}l(p,k)},ce=(p,k)=>{{var S=q=>{var y=fr();l(q,y)},H=q=>{var y=dr();l(q,y)};E(p,q=>{var y;(y=n(o))!=null&&y.display.largeScale?q(S):q(H,!1)},k)}};E(ee,p=>{n(A)!==null?p(le):p(ce,!1)})}a(K),l(t,K),je()}export{Dr as component};
